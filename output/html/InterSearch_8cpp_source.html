<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VVenC Ibrahim: /home/itaabane/Bureau/vvencp/vvenc-master/source/Lib/EncoderLib/InterSearch.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VVenC Ibrahim
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('InterSearch_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">InterSearch.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="InterSearch_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">The copyright in this software is being made available under the BSD</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">License, included below. No patent rights, trademark rights and/or </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">other Intellectual Property Rights other than the copyrights concerning </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">the Software are granted under this license.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">For any license concerning other Intellectual Property rights than the software,</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">especially patent licenses, a separate Agreement needs to be closed. </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">For more information please contact:</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">Fraunhofer Heinrich Hertz Institute</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">Einsteinufer 37</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">10587 Berlin, Germany</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">www.hhi.fraunhofer.de/vvc</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">vvc@hhi.fraunhofer.de</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">Copyright (c) 2019-2021, Fraunhofer-Gesellschaft zur FÃ¶rderung der angewandten Forschung e.V.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">All rights reserved.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * Redistributions of source code must retain the above copyright notice,</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">   this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * Redistributions in binary form must reproduce the above copyright notice,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">   this list of conditions and the following disclaimer in the documentation</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">   and/or other materials provided with the distribution.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * Neither the name of Fraunhofer nor the names of its contributors may</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">   be used to endorse or promote products derived from this software without</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   specific prior written permission.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InterSearch_8h.html">InterSearch.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="EncModeCtrl_8h.html">EncModeCtrl.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="EncLib_8h.html">EncLib.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommonDef_8h.html">CommonLib/CommonDef.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Rom_8h.html">CommonLib/Rom.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MotionInfo_8h.html">CommonLib/MotionInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Picture_8h.html">CommonLib/Picture.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="UnitTools_8h.html">CommonLib/UnitTools.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Reshape_8h.html">CommonLib/Reshape.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dtrace__next_8h.html">CommonLib/dtrace_next.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dtrace__buffer_8h.html">CommonLib/dtrace_buffer.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TimeProfiler_8h.html">CommonLib/TimeProfiler.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacevvenc.html">vvenc</a> {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespacevvenc.html#af2648f21b6c0719f45e956a186b081ac">   72</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> <a class="code" href="namespacevvenc.html#af2648f21b6c0719f45e956a186b081ac">s_acMvRefineH</a>[9] =</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  0,  0 ), <span class="comment">// 0</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  0, -1 ), <span class="comment">// 1</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  0,  1 ), <span class="comment">// 2</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1,  0 ), <span class="comment">// 3</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  1,  0 ), <span class="comment">// 4</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1, -1 ), <span class="comment">// 5</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  1, -1 ), <span class="comment">// 6</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1,  1 ), <span class="comment">// 7</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  1,  1 )  <span class="comment">// 8</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;};</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="namespacevvenc.html#ab83ea82b402e856995ef959d069a10cf">   85</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> <a class="code" href="namespacevvenc.html#ab83ea82b402e856995ef959d069a10cf">s_acMvRefineQ</a>[9] =</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  0,  0 ), <span class="comment">// 0</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  0, -1 ), <span class="comment">// 1</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  0,  1 ), <span class="comment">// 2</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1, -1 ), <span class="comment">// 5</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  1, -1 ), <span class="comment">// 6</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1,  0 ), <span class="comment">// 3</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  1,  0 ), <span class="comment">// 4</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1,  1 ), <span class="comment">// 7</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(  1,  1 )  <span class="comment">// 8</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;};</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="namespacevvenc.html#a96b5e1460105e65e10de81c48c2d7d1f">   98</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacevvenc.html#a96b5e1460105e65e10de81c48c2d7d1f">s_skipQpelPosition</a>[ 42 ][ 9 ] =</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;};</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//   1,0    3,0    0,1    1,1    2,1    3,1    1,2    3,2    0,3    1,3    2,3    3,3    H1,0   H3,0</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">  145</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ 42 ][ 14 ] =</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span> },</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  { <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="keyword">false</span> },</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  { <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>,  <span class="keyword">true</span>  },</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;};</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#abf2802c95763e945c9e6f472995471e6">BlkUniMvInfoBuffer::m_uniMvListMaxSize</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aec99234fd92e769ccc6d0e0f46cee0bb">  193</a></span>&#160;<a class="code" href="classvvenc_1_1InterSearch.html#aec99234fd92e769ccc6d0e0f46cee0bb">InterSearch::InterSearch</a>()</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  : m_modeCtrl                    (nullptr)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  , m_defaultCachedBvs            (nullptr)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  , m_pcEncCfg                    (nullptr)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  , m_pcTrQuant                   (nullptr)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  , m_iSearchRange                (0)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  , m_bipredSearchRange           (0)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  , m_motionEstimationSearchMethod(VVENC_MESEARCH_FULL)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  , m_motionEstimationSearchMethodSCC( 0 )</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  , m_CABACEstimator              (nullptr)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  , m_CtxCache                    (nullptr)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  , m_pTempPel                    (nullptr)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="namespacevvenc.html#a7cf3acc655efbe44b86894c075acb23c">MAX_NUM_REF_LIST_ADAPT_SR</a>; i++)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    memset (<a class="code" href="classvvenc_1_1InterSearch.html#acfac1ad8a7754b33c46766fe254b7b97">m_aaiAdaptSR</a>[i], 0, <a class="code" href="namespacevvenc.html#aa99f1bbf9afbf8a3b21bb9f306663b45">MAX_IDX_ADAPT_SR</a> * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>+1; i++)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    memset (<a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[i], 0, (<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>+1) * <span class="keyword">sizeof</span> (uint32_t) );</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a59194d848c38a0c6efdf4ea064905120">  217</a></span>&#160;<a class="code" href="classvvenc_1_1InterSearch.html#a59194d848c38a0c6efdf4ea064905120">InterSearch::~InterSearch</a>()</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a3a80b6032f86a56bec74609034b3246f">destroy</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a497d534668188d853ef03bbb9455c752">  222</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a02fd73d861ef2e4aabb38c0c9ff82947">InterSearch::init</a>( <span class="keyword">const</span> <a class="code" href="TypeDef_8h.html#ace15b38db4c343877cb8fc77e0155236">VVEncCfg</a>&amp; encCfg, <a class="code" href="classvvenc_1_1TrQuant.html">TrQuant</a>* pTrQuant, <a class="code" href="classvvenc_1_1RdCost.html">RdCost</a>* pRdCost, <a class="code" href="classvvenc_1_1EncModeCtrl.html">EncModeCtrl</a>* pModeCtrl, <a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> **pSaveCS )</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a02fd73d861ef2e4aabb38c0c9ff82947">InterPrediction::init</a>( pRdCost, encCfg.m_internChromaFormat, encCfg.m_CTUSize );</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a>                       = 0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>                     = &amp;encCfg;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>                    = pTrQuant;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>                     = pRdCost;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ad78b260566db7787b860f3d09a32b591">m_modeCtrl</a>                     = pModeCtrl;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ad5e48395a803d72de5136bce7a37933d">m_pSaveCS</a>                      = pSaveCS;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a>                    = encCfg.m_SearchRange;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a2c737d35b7158e64d1aaeafb34537fc6">m_bipredSearchRange</a>               = encCfg.m_bipredSearchRange;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ae98c2fa56ca7cf3b3c994d78d3d1418b">m_motionEstimationSearchMethod</a>    = vvencMESearchMethod( encCfg.m_motionEstimationSearchMethod );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a067e085429f9049d0c4b411fb8622147">m_motionEstimationSearchMethodSCC</a> = encCfg.m_motionEstimationSearchMethodSCC;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">for</span>( uint32_t iDir = 0; iDir &lt; <a class="code" href="namespacevvenc.html#a7cf3acc655efbe44b86894c075acb23c">MAX_NUM_REF_LIST_ADAPT_SR</a>; iDir++ )</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">for</span>( uint32_t iRefIdx = 0; iRefIdx &lt; <a class="code" href="namespacevvenc.html#aa99f1bbf9afbf8a3b21bb9f306663b45">MAX_IDX_ADAPT_SR</a>; iRefIdx++ )</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#acfac1ad8a7754b33c46766fe254b7b97">m_aaiAdaptSR</a>[iDir][iRefIdx] = <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// initialize motion cost</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iNum = 0; iNum &lt; <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a> + 1; iNum++ )</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iIdx = 0; iIdx &lt; <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>; iIdx++ )</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span>( iIdx &lt; iNum )</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[iIdx][iNum] = <a class="code" href="classvvenc_1_1InterSearch.html#ae1a5f5f359b0f586440af2d441a37544">xGetMvpIdxBits</a>( iIdx, iNum );</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[iIdx][iNum] = <a class="code" href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">MAX_UINT</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keyword">const</span> <a class="code" href="TypeDef_8h.html#a70dfa957a71cae40f75782ea972c130e">ChromaFormat</a> cform = encCfg.m_internChromaFormat;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">for</span>( uint32_t i = 0; i &lt; <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384a92f766c130fd9d4eee2981bb182d20cb">NUM_REF_PIC_LIST_01</a>; i++ )</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[i].<a class="code" href="structvvenc_1_1PelStorage.html#ae71ed6a359a035891f1e1b201ed99813">create</a>( <a class="code" href="structvvenc_1_1UnitArea.html">UnitArea</a>( cform, <a class="code" href="structvvenc_1_1Area.html">Area</a>( 0, 0, <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a>, <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a> ) ) );</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#ae71ed6a359a035891f1e1b201ed99813">create</a>( <a class="code" href="structvvenc_1_1UnitArea.html">UnitArea</a>( cform, <a class="code" href="structvvenc_1_1Area.html">Area</a>( 0, 0, <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a>, <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a> ) ) );</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a9e6b286fba70f2939620587a433bd651">m_pTempPel</a> = <span class="keyword">new</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>[ encCfg.m_CTUSize * encCfg.m_CTUSize ];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a88ad68fee052acec3e700138dcf00516">m_tmpAffiStorage</a>.<a class="code" href="structvvenc_1_1PelStorage.html#ae71ed6a359a035891f1e1b201ed99813">create</a>(<a class="code" href="structvvenc_1_1UnitArea.html">UnitArea</a>(cform, <a class="code" href="structvvenc_1_1Area.html">Area</a>(0, 0, <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a>, <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a>)));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a0345a1771d19eb6e5d358993984cebbc">m_tmpAffiError</a> = <span class="keyword">new</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>[<a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a> * <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a>];</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[0] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a> * <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a>];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[1] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a> * <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a>];</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a3a80b6032f86a56bec74609034b3246f">  274</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a3a80b6032f86a56bec74609034b3246f">InterSearch::destroy</a>()</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#a9e6b286fba70f2939620587a433bd651">m_pTempPel</a> )</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="classvvenc_1_1InterSearch.html#a9e6b286fba70f2939620587a433bd651">m_pTempPel</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a9e6b286fba70f2939620587a433bd651">m_pTempPel</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384a92f766c130fd9d4eee2981bb182d20cb">NUM_REF_PIC_LIST_01</a>; i++ )</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[i].<a class="code" href="structvvenc_1_1PelStorage.html#a3a80b6032f86a56bec74609034b3246f">destroy</a>();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a3a80b6032f86a56bec74609034b3246f">destroy</a>();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a88ad68fee052acec3e700138dcf00516">m_tmpAffiStorage</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a3a80b6032f86a56bec74609034b3246f">destroy</a>();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#a0345a1771d19eb6e5d358993984cebbc">m_tmpAffiError</a> != <a class="code" href="CommonDef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="classvvenc_1_1InterSearch.html#a0345a1771d19eb6e5d358993984cebbc">m_tmpAffiError</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a0345a1771d19eb6e5d358993984cebbc">m_tmpAffiError</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[0] != <a class="code" href="CommonDef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[0];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[0] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[1] != <a class="code" href="CommonDef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">delete</span>[] <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[1];</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[1] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ad5e48395a803d72de5136bce7a37933d">m_pSaveCS</a>  = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aaca07f8b20ac1f70e0ce73bc01c70c90">  307</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#aaca07f8b20ac1f70e0ce73bc01c70c90">InterSearch::setCtuEncRsrc</a>( <a class="code" href="classvvenc_1_1CABACWriter.html">CABACWriter</a>* cabacEstimator, <a class="code" href="classvvenc_1_1dynamic__cache.html">CtxCache</a>* ctxCache, <a class="code" href="structvvenc_1_1ReuseUniMv.html">ReuseUniMv</a>* pReuseUniMv, <a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html">BlkUniMvInfoBuffer</a>* pBlkUniMvInfoBuffer, <a class="code" href="structvvenc_1_1AffineProfList.html">AffineProfList</a>* pAffineProfList, <a class="code" href="structvvenc_1_1IbcBvCand.html">IbcBvCand</a>* pCachedBvs )</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>     = cabacEstimator;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#adc15ecb13505785bb69c278578c79980">m_CtxCache</a>           = ctxCache;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a181840c5939d6651c9613ebb61a10537">m_ReuseUniMv</a>         = pReuseUniMv;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a> = pBlkUniMvInfoBuffer;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>     = pAffineProfList;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>   = pCachedBvs;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="structvvenc_1_1ReuseUniMv.html#adf53437a57fb8cb9a43240ea0781797b">  317</a></span>&#160;<a class="code" href="structvvenc_1_1ReuseUniMv.html#adf53437a57fb8cb9a43240ea0781797b">ReuseUniMv::ReuseUniMv</a>()</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> numPos     = <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a> &gt;&gt; <a class="code" href="namespacevvenc.html#a7cc71bf11f858c29047e8e66e244d1bc">MIN_CU_LOG2</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> maxSizeIdx = <a class="code" href="namespacevvenc.html#ad4c6299a6038ffe0d853c33e1dae9ef0">MAX_CU_SIZE_IDX</a>-2;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> wIdx = 0; wIdx &lt; maxSizeIdx; wIdx++ )</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> hIdx = 0; hIdx &lt; maxSizeIdx; hIdx++ )</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = 0; y &lt; numPos; y++ )</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; numPos; x++ )</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[ wIdx ][ hIdx ][ x ][ y ] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="structvvenc_1_1ReuseUniMv.html#a1db6a10153263ac204e9a33874995064">  336</a></span>&#160;<a class="code" href="structvvenc_1_1ReuseUniMv.html#a1db6a10153263ac204e9a33874995064">ReuseUniMv::~ReuseUniMv</a>()</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="structvvenc_1_1ReuseUniMv.html#af41b91ef5d3fd1bd030c6d57ed223d9c">resetReusedUniMvs</a>();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="structvvenc_1_1ReuseUniMv.html#af41b91ef5d3fd1bd030c6d57ed223d9c">  341</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structvvenc_1_1ReuseUniMv.html#af41b91ef5d3fd1bd030c6d57ed223d9c">ReuseUniMv::resetReusedUniMvs</a>()</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> numPos     = <a class="code" href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">MAX_CU_SIZE</a> &gt;&gt; <a class="code" href="namespacevvenc.html#a7cc71bf11f858c29047e8e66e244d1bc">MIN_CU_LOG2</a>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> maxSizeIdx = <a class="code" href="namespacevvenc.html#ad4c6299a6038ffe0d853c33e1dae9ef0">MAX_CU_SIZE_IDX</a>-2;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> wIdx = 0; wIdx &lt; maxSizeIdx; wIdx++ )</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> hIdx = 0; hIdx &lt; maxSizeIdx; hIdx++ )</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> y = 0; y &lt; numPos; y++ )</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> x = 0; x &lt; numPos; x++ )</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[ wIdx ][ hIdx ][ x ][ y ] )</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keyword">delete</span> [] <a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[ wIdx ][ hIdx ][ x ][ y ];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[ wIdx ][ hIdx ][ x ][ y ] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a855fa44b8d0233bd0eee95e99883e667">  364</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a855fa44b8d0233bd0eee95e99883e667">InterSearch::loadGlobalUniMvs</a>( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Area.html">Area</a>&amp; lumaArea, <span class="keyword">const</span> <a class="code" href="classvvenc_1_1PreCalcValues.html">PreCalcValues</a>&amp; pcv)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">unsigned</span> idx1, idx2, idx3, idx4;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="namespacevvenc.html#af6fcdb72acb1320cf627e46450710f19">getAreaIdxNew</a>(lumaArea, pcv, idx1, idx2, idx3, idx4);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#a181840c5939d6651c9613ebb61a10537">m_ReuseUniMv</a>-&gt;<a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[idx1][idx2][idx3][idx4])</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">//    DTRACE( g_trace_ctx, D_TMP, &quot;%d unimv load %d %d %d %d \n&quot;, g_trace_ctx-&gt;getChannelCounter(D_TMP), idx3,idx4,idx1,idx2 );</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#aea97ceaa3309a46ee618f9028dd52ade">insertUniMvCands</a>(lumaArea, <a class="code" href="classvvenc_1_1InterSearch.html#a181840c5939d6651c9613ebb61a10537">m_ReuseUniMv</a>-&gt;<a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[idx1][idx2][idx3][idx4]);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#af1328a689e0e09c6c3b8fe514bfa2e07">  375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#af1328a689e0e09c6c3b8fe514bfa2e07">InterSearch::getBestSbt</a>( <a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a>* tempCS, <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>* cu, uint8_t&amp; histBestSbt, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; curPuSse, uint8_t sbtAllowed, <span class="keywordtype">bool</span> doPreAnalyzeResi, <span class="keywordtype">bool</span> mtsAllowed )</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ab129abe12f06cef41d20e46b18c69d70">m_skipSbtAll</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span>( doPreAnalyzeResi )</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ae10e385d23d8c4126831cd7bd566bcbc">xCalcMinDistSbt</a>( *tempCS, *cu, sbtAllowed );</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  curPuSse = <a class="code" href="classvvenc_1_1InterSearch.html#a02fccf54ebd41fd6bc9712be1d326cba">getEstDistSbt</a>( <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a> );</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span>( doPreAnalyzeResi )</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#ab129abe12f06cef41d20e46b18c69d70">m_skipSbtAll</a> &amp;&amp; !mtsAllowed )</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      histBestSbt = 0; <span class="comment">//try DCT2</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordtype">int</span>  slShift = 4 + std::min( <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>( cu-&gt;<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>() * cu-&gt;<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>() ), 9 );</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      assert( curPuSse != <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a> );</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      histBestSbt = <a class="code" href="classvvenc_1_1InterSearch.html#ad78b260566db7787b860f3d09a32b591">m_modeCtrl</a>-&gt;<a class="code" href="classvvenc_1_1CacheBlkInfoCtrl.html#a9e6b9048415132cad893bff62bb8f315">findBestSbt</a>( cu-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#abce2e87aaf7e3dd8fb0a930b2f1fb82f">area</a>, (uint32_t)( curPuSse &gt;&gt; slShift ) );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#ab129abe12f06cef41d20e46b18c69d70">m_skipSbtAll</a> &amp;&amp; <a class="code" href="namespacevvenc_1_1CU.html#ad9826a082e7a4783645ea9c84357754e">CU::isSbtMode</a>( histBestSbt ) ) <span class="comment">//special case, skip SBT when loading SBT</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        histBestSbt = 0; <span class="comment">//try DCT2</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">  407</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">InterSearch::xTZSearchHelp</a>( <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp; rcStruct, <span class="keyword">const</span> <span class="keywordtype">int</span> iSearchX, <span class="keyword">const</span> <span class="keywordtype">int</span> iSearchY, <span class="keyword">const</span> uint8_t ucPointNr, <span class="keyword">const</span> uint32_t uiDistance )</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  uiSad = 0;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* <span class="keyword">const</span>  piRefSrch = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + iSearchY * rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> + iSearchX;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = piRefSrch;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">if</span>( 1 == rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> )</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// motion cost</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiBitCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( iSearchX, iSearchY, rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// Skip search if bit cost is already larger than best SAD</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (uiBitCost &lt; rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiTempSad = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a> );</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">if</span>((uiTempSad + uiBitCost) &lt; rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="comment">// it&#39;s not supposed that any member of DistParams is manipulated beside cur.buf</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordtype">int</span> subShift = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* pOrgCpy = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#ae716301fedc5457b5fd5e1c937423cc6">org</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        uiSad += uiTempSad &gt;&gt; <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">while</span>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a> &gt; 0 )</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          <span class="keywordtype">int</span> isubShift           = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a> -1;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#ae716301fedc5457b5fd5e1c937423cc6">org</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> + (rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a> &lt;&lt; isubShift);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = piRefSrch + (rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> &lt;&lt; isubShift);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;          uiTempSad            = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a> );</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;          uiSad               += uiTempSad &gt;&gt; <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          <span class="keywordflow">if</span>(((uiSad &lt;&lt; isubShift) + uiBitCost) &gt; rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a>--;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a> == 0)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          uiSad += uiBitCost;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <span class="keywordflow">if</span>( uiSad &lt; rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> )</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>      = uiSad;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>         = iSearchX;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>         = iSearchY;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = uiDistance;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a>    = 0;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a>      = ucPointNr;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = uiSad;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// restore org ptr</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#ae716301fedc5457b5fd5e1c937423cc6">org</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>  = pOrgCpy;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a> = subShift;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    uiSad = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a> );</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">// only add motion cost if uiSad is smaller than best. Otherwise pointless</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// to add motion cost.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span>( uiSad &lt; rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> )</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="comment">// motion cost</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      uiSad += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( iSearchX, iSearchY, rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">if</span>( uiSad &lt; rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> )</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>      = uiSad;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>         = iSearchX;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>         = iSearchY;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = uiDistance;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a>    = 0;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a>      = ucPointNr;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = uiSad;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a7ef728d3e31f6b319e88d2f023ef92cf">  497</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a7ef728d3e31f6b319e88d2f023ef92cf">InterSearch::xTZ2PointSearch</a>( <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp; rcStruct )</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;{</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> xOffset[2][9] = { {  0, -1, -1,  0, -1, +1, -1, -1, +1 }, {  0,  0, +1, +1, -1, +1,  0, +1,  0 } };</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> yOffset[2][9] = { {  0,  0, -1, -1, +1, -1,  0, +1,  0 }, {  0, -1, -1,  0, -1, +1, +1, +1, +1 } };</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// 2 point search,                   //   1 2 3</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// check only the 2 untested points  //   4 0 5</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// around the start point            //   6 7 8</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iX1 = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> + xOffset[0][rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a>];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iX2 = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> + xOffset[1][rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a>];</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iY1 = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> + yOffset[0][rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a>];</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iY2 = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> + yOffset[1][rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a>];</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">if</span>( iX1 &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> &amp;&amp; iX1 &lt;= sr.right &amp;&amp; iY1 &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> &amp;&amp; iY1 &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> )</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iX1, iY1, 0, 2 );</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">if</span>( iX2 &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> &amp;&amp; iX2 &lt;= sr.right &amp;&amp; iY2 &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> &amp;&amp; iY2 &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> )</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iX2, iY2, 0, 2 );</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ae6221582f4c06ae8910bf62fcc456069">  524</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#ae6221582f4c06ae8910bf62fcc456069">InterSearch::xTZ4PointSquareSearch</a>( <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a> &amp; rcStruct, <span class="keyword">const</span> <span class="keywordtype">int</span> iStartX, <span class="keyword">const</span> <span class="keywordtype">int</span> iStartY, <span class="keyword">const</span> <span class="keywordtype">int</span> iDist )</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( iDist == 0 || iDist &gt; 2, <span class="stringliteral">&quot;Invalid distance&quot;</span> );</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="comment">// 4 point search,                   //     1 2 3</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="comment">// search around the start point     //     4 0 5</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// with the required  distance       //     6 7 8</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iTop = iStartY - iDist;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iBottom = iStartY + iDist;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iLeft = iStartX - iDist;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iRight = iStartX + iDist;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> += 1;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keywordflow">if</span> ( iTop &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> )</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check top left</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iTop, 1, iDist );</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check top right</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iTop, 3, iDist );</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">if</span> ( iBottom &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> )</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check bottom left</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iBottom, 6, iDist );</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check bottom right</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iBottom, 8, iDist );</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a68106a08253d342623282a38b62c0fae">  561</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a68106a08253d342623282a38b62c0fae">InterSearch::xTZ8PointSquareSearch</a>( <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp; rcStruct, <span class="keyword">const</span> <span class="keywordtype">int</span> iStartX, <span class="keyword">const</span> <span class="keywordtype">int</span> iStartY, <span class="keyword">const</span> <span class="keywordtype">int</span> iDist )</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;{</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// 8 point search,                   //   1 2 3</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// search around the start point     //   4 0 5</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// with the required  distance       //   6 7 8</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( iDist == 0 , <span class="stringliteral">&quot;Invalid distance&quot;</span>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iTop        = iStartY - iDist;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iBottom     = iStartY + iDist;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iLeft       = iStartX - iDist;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iRight      = iStartX + iDist;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> += 1;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">if</span> ( iTop &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> ) <span class="comment">// check top</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check top left</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iTop, 1, iDist );</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// top middle</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iTop, 2, iDist );</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check top right</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iTop, 3, iDist );</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  } <span class="comment">// check top</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check middle left</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iStartY, 4, iDist );</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check middle right</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iStartY, 5, iDist );</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">if</span> ( iBottom &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check bottom</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check bottom left</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iBottom, 6, iDist );</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// check bottom middle</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iBottom, 7, iDist );</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check bottom right</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iBottom, 8, iDist );</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  } <span class="comment">// check bottom</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;}</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">  612</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">InterSearch::xTZ8PointDiamondSearch</a>( <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp; rcStruct,</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">int</span> iStartX,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">int</span> iStartY,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">int</span> iDist,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">bool</span> bCheckCornersAtDist1 )</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr = rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="comment">// 8 point search,                   //   1 2 3</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// search around the start point     //   4 0 5</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="comment">// with the required  distance       //   6 7 8</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( iDist == 0, <span class="stringliteral">&quot;Invalid distance&quot;</span> );</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iTop        = iStartY - iDist;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iBottom     = iStartY + iDist;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iLeft       = iStartX - iDist;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iRight      = iStartX + iDist;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  rcStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> += 1;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span> ( iDist == 1 )</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> ( iTop &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> ) <span class="comment">// check top</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">if</span> (bCheckCornersAtDist1)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>) <span class="comment">// check top-left</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iTop, 1, iDist );</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iTop, 2, iDist );</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check middle right</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iTop, 3, iDist );</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iTop, 2, iDist );</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check middle left</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iStartY, 4, iDist );</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check middle right</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iStartY, 5, iDist );</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> ( iBottom &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check bottom</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keywordflow">if</span> (bCheckCornersAtDist1)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>) <span class="comment">// check top-left</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iBottom, 6, iDist );</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iBottom, 7, iDist );</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check middle right</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iBottom, 8, iDist );</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iBottom, 7, iDist );</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> ( iDist &lt;= 8 )</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> iTop_2      = iStartY - (iDist&gt;&gt;1);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> iBottom_2   = iStartY + (iDist&gt;&gt;1);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> iLeft_2     = iStartX - (iDist&gt;&gt;1);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> iRight_2    = iStartX + (iDist&gt;&gt;1);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordflow">if</span> (  iTop &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> &amp;&amp; iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> &amp;&amp;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;           iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> &amp;&amp; iBottom &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check border</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX,  iTop,      2, iDist    );</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft_2,  iTop_2,    1, iDist&gt;&gt;1 );</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight_2, iTop_2,    3, iDist&gt;&gt;1 );</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft,    iStartY,   4, iDist    );</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight,   iStartY,   5, iDist    );</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft_2,  iBottom_2, 6, iDist&gt;&gt;1 );</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight_2, iBottom_2, 8, iDist&gt;&gt;1 );</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX,  iBottom,   7, iDist    );</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// check border</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">if</span> ( iTop &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> ) <span class="comment">// check top</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iTop, 2, iDist );</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">if</span> ( iTop_2 &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> ) <span class="comment">// check half top</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          <span class="keywordflow">if</span> ( iLeft_2 &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check half left</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft_2, iTop_2, 1, (iDist&gt;&gt;1) );</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          <span class="keywordflow">if</span> ( iRight_2 &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check half right</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight_2, iTop_2, 3, (iDist&gt;&gt;1) );</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        } <span class="comment">// check half top</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check left</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iStartY, 4, iDist );</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check right</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iStartY, 5, iDist );</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span> ( iBottom_2 &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check half bottom</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          <span class="keywordflow">if</span> ( iLeft_2 &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check half left</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft_2, iBottom_2, 6, (iDist&gt;&gt;1) );</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          <span class="keywordflow">if</span> ( iRight_2 &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check half right</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight_2, iBottom_2, 8, (iDist&gt;&gt;1) );</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        } <span class="comment">// check half bottom</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">if</span> ( iBottom &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check bottom</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iBottom, 7, iDist );</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      } <span class="comment">// check border</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">else</span> <span class="comment">// iDist &gt; 8</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">if</span> ( iTop &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> &amp;&amp; iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> &amp;&amp;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;           iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> &amp;&amp; iBottom &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check border</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iTop,    0, iDist );</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft,   iStartY, 0, iDist );</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight,  iStartY, 0, iDist );</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iBottom, 0, iDist );</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> index = 1; index &lt; 4; index++ )</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosYT = iTop    + ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosYB = iBottom - ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosXL = iStartX - ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosXR = iStartX + ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXL, iPosYT, 0, iDist );</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXR, iPosYT, 0, iDist );</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXL, iPosYB, 0, iDist );</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXR, iPosYB, 0, iDist );</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// check border</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">if</span> ( iTop &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> ) <span class="comment">// check top</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iTop, 0, iDist );</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">if</span> ( iLeft &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check left</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iLeft, iStartY, 0, iDist );</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">if</span> ( iRight &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check right</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iRight, iStartY, 0, iDist );</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">if</span> ( iBottom &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check bottom</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iStartX, iBottom, 0, iDist );</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> index = 1; index &lt; 4; index++ )</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosYT = iTop    + ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosYB = iBottom - ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosXL = iStartX - ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> iPosXR = iStartX + ((iDist&gt;&gt;2) * index);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          <span class="keywordflow">if</span> ( iPosYT &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> ) <span class="comment">// check top</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <span class="keywordflow">if</span> ( iPosXL &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check left</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXL, iPosYT, 0, iDist );</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="keywordflow">if</span> ( iPosXR &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check right</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXR, iPosYT, 0, iDist );</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          } <span class="comment">// check top</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;          <span class="keywordflow">if</span> ( iPosYB &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> ) <span class="comment">// check bottom</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">if</span> ( iPosXL &gt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a> ) <span class="comment">// check left</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXL, iPosYB, 0, iDist );</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="keywordflow">if</span> ( iPosXR &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a> ) <span class="comment">// check right</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( rcStruct, iPosXR, iPosYB, 0, iDist );</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;          } <span class="comment">// check bottom</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        } <span class="comment">// for ...</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      } <span class="comment">// check border</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    } <span class="comment">// iDist &lt;= 8</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  } <span class="comment">// iDist == 1</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;}</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a44ef45706c20f722aef32216629c45a3">  815</a></span>&#160;<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> <a class="code" href="classvvenc_1_1InterSearch.html#a44ef45706c20f722aef32216629c45a3">InterSearch::xPatternRefinement</a>( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>* pcPatternKey,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                            <a class="code" href="classvvenc_1_1Mv.html">Mv</a> baseRefMv,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                            <span class="keywordtype">int</span> iFrac, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvFrac,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                            <span class="keywordtype">bool</span> bAllowUseOfHadamard,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                            <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; uiDistBest,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                            <span class="keywordtype">int</span>&amp; patternId,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                            <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>* pattern,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                            <span class="keywordtype">bool</span> useAltHpelIf )</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;{</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  uiDist;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  uiDistBest = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastSubPel == 1 ? uiDistBest : <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  uint32_t        uiDirecBest = 0;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>*  piRefPos;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordtype">int</span> iRefStride = pcPatternKey-&gt;<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a> + 1;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *pcPatternKey, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[0][0][0], iRefStride, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, 0, <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bUseHADME &amp;&amp; bAllowUseOfHadamard );</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1ClpRng.html">ClpRng</a>&amp; clpRng = <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordtype">int</span> width = pattern-&gt;<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordtype">int</span> height = pattern-&gt;<a class="code" href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">height</a>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordtype">int</span> srcStride = pattern-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordtype">int</span> intStride = width + 1;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">int</span> dstStride = width + 1;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* intPtr;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* dstPtr;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordtype">int</span> filterSize = <a class="code" href="namespacevvenc.html#af34252cbb46dcf09730e3ab02321ee15">NTAPS_LUMA</a>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordtype">int</span> halfFilterSize = ( filterSize &gt;&gt; 1 );</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* srcPtr = pattern-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> - halfFilterSize*srcStride - 1;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="keyword">const</span> <a class="code" href="TypeDef_8h.html#a70dfa957a71cae40f75782ea972c130e">ChromaFormat</a> chFmt = <a class="code" href="classvvenc_1_1InterPrediction.html#a9ddbb02a220623fa10f87e6f751e77e6">m_currChromaFormat</a>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> distH[ 9 ] = { uiDistBest, uiDistBest, uiDistBest, uiDistBest, uiDistBest, uiDistBest, uiDistBest, uiDistBest, uiDistBest };</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> TH = 17, TL = 15, shift = 4;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* pcMvRefine = (iFrac == 2 ? <a class="code" href="namespacevvenc.html#af2648f21b6c0719f45e956a186b081ac">s_acMvRefineH</a> : <a class="code" href="namespacevvenc.html#ab83ea82b402e856995ef959d069a10cf">s_acMvRefineQ</a>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; 9; i++)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastSubPel == 1 )</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a96b5e1460105e65e10de81c48c2d7d1f">s_skipQpelPosition</a>[ patternId ][ i ] )</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">if</span>( 2 == iFrac )</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">if</span> ( ( 5 == i &amp;&amp; 0 == uiDirecBest ) || ( 7 == i &amp;&amp; 1 == uiDirecBest ) || ( 8 == i &amp;&amp; ( 1 == uiDirecBest || 3 == uiDirecBest || 5 == uiDirecBest ) ) )</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">if</span>( 0 == i )</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;          <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr, srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 0 ][ 0 ], intStride, width, height + filterSize, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr + width, srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 0 ][ 0 ] + width, intStride, 1, height + filterSize, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr, srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 2 ][ 0 ], intStride, width, height + filterSize, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr + width, srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 2 ][ 0 ] + width, intStride, 1, height + filterSize, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 0 ][ 0 ] + halfFilterSize * intStride + 1;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;          dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 0 ][ 0 ][ 0 ];</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width + 0, height + 0, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( 1 == i )</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;          intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 0 ][ 0 ] + ( halfFilterSize - 1 ) * intStride + 1;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 2 ][ 0 ][ 0 ];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width + 0, height + 1, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( 3 == i )</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 2 ][ 0 ] + halfFilterSize * intStride;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;          dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 0 ][ 2 ][ 0 ];</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;          <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height + 0, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr + width, intStride, dstPtr + width, dstStride, 1, height + 0, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( 5 == i )</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 2 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 2 ][ 2 ][ 0 ];</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height + 1, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr + width, intStride, dstPtr + width, dstStride, 1, height + 1, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cMvTest = pcMvRefine[ i ];</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    cMvTest += baseRefMv;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordtype">int</span> horVal = cMvTest.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> * iFrac;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordtype">int</span> verVal = cMvTest.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> * iFrac;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    piRefPos = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[verVal &amp; 3][horVal &amp; 3][0];</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">if</span> ( horVal == 2 &amp;&amp; ( verVal &amp; 1 ) == 0 )</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      piRefPos += 1;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> ( ( horVal &amp; 1 ) == 0 &amp;&amp; verVal == 2 )</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      piRefPos += iRefStride;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    cMvTest = pcMvRefine[i];</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    cMvTest += rcMvFrac;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>   = piRefPos;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    uiDist = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a> );</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    uiDist += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( cMvTest.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, cMvTest.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0 );</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    distH[ i ] = uiDist;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordflow">if</span> ( uiDist &lt; uiDistBest )</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      uiDistBest  = uiDist;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      uiDirecBest = i;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = uiDist;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  rcMvFrac = pcMvRefine[uiDirecBest];</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastSubPel == 1 &amp;&amp; iFrac == 2 )</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">switch</span> ( uiDirecBest )</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      distH[ 3 ] &lt;&lt;= shift;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      patternId += ( distH[ 3 ] &gt; TH * distH[ 4 ] ? 2 : ( distH[ 3 ] &lt; TL * distH[ 4 ] ? 1 : 0 ) );</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      distH[ 1 ] &lt;&lt;= shift;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      patternId += ( distH[ 1 ] &gt; TH * distH[ 2 ] ? 6 : ( distH[ 1 ] &lt; TL * distH[ 2 ] ? 3 : 0 ) );</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      distH[ 5 ] &lt;&lt;= shift;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      patternId += ( distH[ 5 ] &gt; TH * distH[ 6 ] ? 4 : ( distH[ 5 ] &lt; TL * distH[ 6 ] ? 2 : 0 ) );</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      patternId += ( distH[ 2 ] - distH[ 0 ] &gt; distH[ 0 ] - distH[ 1 ] ? 1 : 0 );</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      patternId += ( 41 == patternId ? 0 : 8 );</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      distH[ 7 ] &lt;&lt;= shift;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      patternId += ( distH[ 7 ] &gt; TH * distH[ 8 ] ? 4 : ( distH[ 7 ] &lt; TL * distH[ 8 ] ? 2 : 0 ) );</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      patternId += ( distH[ 1 ] - distH[ 0 ] &gt; distH[ 0 ] - distH[ 2 ] ? 1 : 0 );</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      patternId += ( 41 == patternId ? 0 : 13 );</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      patternId += ( distH[ 4 ] - distH[ 0 ] &gt; distH[ 0 ] - distH[ 3 ] ? 1 : 0 );</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      distH[ 5 ] &lt;&lt;= shift;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      patternId += ( distH[ 5 ] &gt; TH * distH[ 7 ] ? 4 : ( distH[ 5 ] &lt; TL * distH[ 7 ] ? 2 : 0 ) );</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      patternId += ( 41 == patternId ? 0 : 18 );</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      patternId += ( distH[ 3 ] - distH[ 0 ] &gt; distH[ 0 ] - distH[ 4 ] ? 1 : 0 );</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      distH[ 6 ] &lt;&lt;= shift;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      patternId += ( distH[ 6 ] &gt; TH * distH[ 8 ] ? 4 : ( distH[ 6 ] &lt; TL * distH[ 8 ] ? 2 : 0 ) );</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      patternId += ( 41 == patternId ? 0 : 23 );</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      patternId += ( distH[ 6 ] - distH[ 1 ] &gt; distH[ 1 ] - distH[ 5 ] ? 1 : 0 );</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      patternId += ( distH[ 7 ] - distH[ 3 ] &gt; distH[ 3 ] - distH[ 5 ] ? 2 : 0 );</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      patternId += ( 41 == patternId ? 0 : 28 );</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      patternId += ( distH[ 5 ] - distH[ 1 ] &gt; distH[ 1 ] - distH[ 6 ] ? 1 : 0 );</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      patternId += ( distH[ 8 ] - distH[ 4 ] &gt; distH[ 4 ] - distH[ 6 ] ? 2 : 0 );</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      patternId += ( 41 == patternId ? 0 : 31 );</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      patternId += ( distH[ 8 ] - distH[ 2 ] &gt; distH[ 2 ] - distH[ 7 ] ? 1 : 0 );</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      patternId += ( distH[ 5 ] - distH[ 3 ] &gt; distH[ 3 ] - distH[ 7 ] ? 2 : 0 );</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      patternId += ( 41 == patternId ? 0 : 34 );</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="comment">// hor</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      patternId += ( distH[ 7 ] - distH[ 2 ] &gt; distH[ 2 ] - distH[ 8 ] ? 1 : 0 );</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="comment">// ver</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      patternId += ( distH[ 6 ] - distH[ 4 ] &gt; distH[ 4 ] - distH[ 8 ] ? 2 : 0 );</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      patternId += ( 41 == patternId ? 0 : 37 );</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keywordflow">return</span> uiDistBest;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;}</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a20ad2ab1a41da1b47cf2a94655f06ee5"> 1028</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classvvenc_1_1InterSearch.html#a20ad2ab1a41da1b47cf2a94655f06ee5">InterSearch::predInterSearch</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="classvvenc_1_1Partitioner.html">Partitioner</a>&amp; partitioner, <span class="keywordtype">double</span>&amp; bestCostInter)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;{</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a>&amp; cs = *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>     amvp[2];</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvSrchRngLT;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvSrchRngRB;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvZero;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMv[2];</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvBi[2];</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvTemp[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvHevcTemp[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordtype">int</span>          iNumPredDir = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a530d6092c6fac441ddd03762efdf5c2f">isInterP</a>() ? 1 : 2;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvPred[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvPredBi[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordtype">int</span>          aaiMvpIdxBi[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="keywordtype">int</span>          aaiMvpIdx[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordtype">int</span>          aaiMvpNum[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>     aacAMVPInfo[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordtype">int</span>          iRefIdx[2]={0,0}; <span class="comment">//If un-initialized, may cause SEGV in bi-directional prediction iterative stage.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keywordtype">int</span>          iRefIdxBi[2] = { -1, -1 };</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  uint32_t     uiMbBits[3] = {1, 1, 0};</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  uint32_t     uiLastMode = 0;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="keywordtype">int</span>          iRefStart, iRefEnd;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="keywordtype">int</span>          symMode = 0;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="keywordtype">int</span>          bestBiPRefIdxL1 = 0;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="keywordtype">int</span>          bestBiPMvpL1    = 0;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   biPDistTemp     = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  uint8_t      BcwIdx          = (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2df1dd5ac8070482b6042070f73cffa4">isInterB</a>() ? cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> : <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordtype">bool</span>         enforceBcwPred = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <a class="code" href="structvvenc_1_1MergeCtx.html">MergeCtx</a>     mergeCtx;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="comment">// Loop over Prediction Units</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  uint32_t     puIdx = 0;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  uint32_t     uiLastModeTemp = 0;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   uiAffineCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   uiHevcCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordtype">bool</span> checkAffine = (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 0);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1ed6bffd8a78efbd91dab2d307c6d321">bestParent</a> != <span class="keyword">nullptr</span> &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1ed6bffd8a78efbd91dab2d307c6d321">bestParent</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ac1fb6d2f0f24ad434b770a78ba00d30a">getCU</a>(<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a>,<a class="code" href="namespacevvenc.html#ad31da9b5f4979160b0e600cd47e42b91a6e6e24d1d7c3c9c0e6ae48644aafbd36">TREE_D</a>) != <span class="keyword">nullptr</span> &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1ed6bffd8a78efbd91dab2d307c6d321">bestParent</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ac1fb6d2f0f24ad434b770a78ba00d30a">getCU</a>(<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a>,<a class="code" href="namespacevvenc.html#ad31da9b5f4979160b0e600cd47e42b91a6e6e24d1d7c3c9c0e6ae48644aafbd36">TREE_D</a>)-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#ad036b5eb236ab3725436ece9cbf93e57">affine</a> == <span class="keyword">false</span>)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a36810f08eb1336527c11e152ea1642c8">m_skipPROF</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a97b7311221af453c6fa6d051c6f45da0">m_encOnly</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a4460952d9337315fdfe063103cc7a794">SbtMvp</a>)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <a class="code" href="structvvenc_1_1Size.html">Size</a> bufSize = <a class="code" href="namespacevvenc.html#a320790f51783f66cf9f95a6a6ecd5b54">g_miScaling</a>.<a class="code" href="structvvenc_1_1UnitScale.html#af11a79fd0eb80cbdc41f3448eeb815cf">scale</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>());</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      mergeCtx.<a class="code" href="structvvenc_1_1MergeCtx.html#ac8a6d94af3d696e1bf24f6dcf84d5006">subPuMvpMiBuf</a> = <a class="code" href="namespacevvenc.html#a2277abb2f66824237e308581168c16b6">MotionBuf</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a25a0bd912f0348713119cf2ff215ef07">m_subPuMiBuf</a>, bufSize);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <a class="code" href="namespacevvenc_1_1CU.html#a88cd6fcff13e86d529ac63c3d2eca6c0">CU::spanMotionInfo</a>( cu );</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   uiCost[2] = { <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>, <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a> };</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   uiCostBi  =   <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   uiCostTemp;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    uint32_t         uiBits[3];</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    uint32_t         uiBitsTemp;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   bestBiPDist = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   uiCostTempL0[<a class="code" href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">MAX_NUM_REF</a>];</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iNumRef=0; iNumRef &lt; <a class="code" href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">MAX_NUM_REF</a>; iNumRef++)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      uiCostTempL0[iNumRef] = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    uint32_t         uiBitsTempL0[<a class="code" href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">MAX_NUM_REF</a>];</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           mvValidList1;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordtype">int</span>          refIdxValidList1 = 0;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    uint32_t         bitsValidList1   = <a class="code" href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">MAX_UINT</a>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>   costValidList1   = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a> origBuf = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>( cu );</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af67498245b43d85d1afe6c053a4eb1b6">xGetBlkBits</a>( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a530d6092c6fac441ddd03762efdf5c2f">isInterP</a>(), puIdx, uiLastMode, uiMbBits );</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ade7e91ebda6f8dce573eac07a1278a6c">selectMotionLambda</a>();</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordtype">unsigned</span> imvShift = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">IMV_HPEL</a> ? 1 : (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> &lt;&lt; 1);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="comment">//  Uni-directional prediction</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> iRefList = 0; iRefList &lt; iNumPredDir; iRefList++ )</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>  refPicList = ( iRefList ? <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> : <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a> );</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iRefIdxTemp = 0; iRefIdxTemp &lt; cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ refPicList ]; iRefIdxTemp++)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;          uiBitsTemp = uiMbBits[iRefList];</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          <span class="keywordflow">if</span> ( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ refPicList ] &gt; 1 )</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;          {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            uiBitsTemp += iRefIdxTemp+1;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <span class="keywordflow">if</span> ( iRefIdxTemp == cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ refPicList ]-1 )</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;              uiBitsTemp--;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a4ff177faa51dea313e7bd4049db215e6">xEstimateMvPredAMVP</a>( cu, origBuf, refPicList, iRefIdxTemp, cMvPred[iRefList][iRefIdxTemp], amvp[refPicList], biPDistTemp);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;          aaiMvpIdx[iRefList][iRefIdxTemp] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[refPicList];</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          aaiMvpNum[iRefList][iRefIdxTemp] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[refPicList];</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          <span class="keywordflow">if</span>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a> &amp;&amp; iRefList==1 &amp;&amp; biPDistTemp &lt; bestBiPDist)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;          {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            bestBiPDist = biPDistTemp;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            bestBiPMvpL1 = aaiMvpIdx[iRefList][iRefIdxTemp];</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            bestBiPRefIdxL1 = iRefIdxTemp;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;          }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          uiBitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[aaiMvpIdx[iRefList][iRefIdxTemp]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bFastMEForGenBLowDelayEnabled &amp;&amp; iRefList == 1 )    <span class="comment">// list 1</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;          {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keywordflow">if</span> ( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[ iRefIdxTemp ] &gt;= 0 )</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;              cMvTemp[1][iRefIdxTemp] = cMvTemp[0][cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[iRefIdxTemp ]];</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;              uiCostTemp = uiCostTempL0[cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[ iRefIdxTemp ]];</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;              <span class="comment">/*first subtract the bit-rate part of the cost of the other list*/</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;              uiCostTemp -= <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( uiBitsTempL0[cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[ iRefIdxTemp ]] );</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;              <span class="comment">/*correct the bit-rate part of the current ref*/</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>  ( cMvPred[iRefList][iRefIdxTemp] );</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;              uiBitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>( cMvTemp[1][iRefIdxTemp].hor, cMvTemp[1][iRefIdxTemp].ver, imvShift + <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a> );</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;              <span class="comment">/*calculate the correct cost*/</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;              uiCostTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( uiBitsTemp );</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#aa17b8a45afa5a9835b69acd2a4372fc0">xMotionEstimation</a>( cu, origBuf, refPicList, cMvPred[iRefList][iRefIdxTemp], iRefIdxTemp, cMvTemp[iRefList][iRefIdxTemp], aaiMvpIdx[iRefList][iRefIdxTemp], uiBitsTemp, uiCostTemp, amvp[refPicList] );</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;          }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;          {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#aa17b8a45afa5a9835b69acd2a4372fc0">xMotionEstimation</a>( cu, origBuf, refPicList, cMvPred[iRefList][iRefIdxTemp], iRefIdxTemp, cMvTemp[iRefList][iRefIdxTemp], aaiMvpIdx[iRefList][iRefIdxTemp], uiBitsTemp, uiCostTemp, amvp[refPicList] );</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;          }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;          </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          <span class="keywordflow">if</span>( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> == <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> &amp;&amp; cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2df1dd5ac8070482b6042070f73cffa4">isInterB</a>() )</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a1fd8169f27a1727cf364b813be1c3f0f">setReadMode</a>( <span class="keyword">true</span>, (uint32_t)iRefList, (uint32_t)iRefIdxTemp) ;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a9444471ff32527e67a99de1c94f8d2e3">copyFrom</a>( cMvTemp[iRefList][iRefIdxTemp], uiCostTemp - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(uiBitsTemp), (uint32_t)iRefList, (uint32_t)iRefIdxTemp );</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981">xCopyAMVPInfo</a>( &amp;amvp[refPicList], &amp;aacAMVPInfo[iRefList][iRefIdxTemp]); <span class="comment">// must always be done ( also when AMVP_MODE = AM_NONE )</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a554f238ef569ea05b99bbef4a0972ae1">xCheckBestMVP</a>( refPicList, cMvTemp[iRefList][iRefIdxTemp], cMvPred[iRefList][iRefIdxTemp], aaiMvpIdx[iRefList][iRefIdxTemp], amvp[refPicList], uiBitsTemp, uiCostTemp, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> );</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;          <span class="keywordflow">if</span> ( iRefList == 0 )</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;          {</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            uiCostTempL0[iRefIdxTemp] = uiCostTemp;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            uiBitsTempL0[iRefIdxTemp] = uiBitsTemp;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          <span class="keywordflow">if</span> ( uiCostTemp &lt; uiCost[iRefList] )</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            uiCost[iRefList] = uiCostTemp;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            uiBits[iRefList] = uiBitsTemp; <span class="comment">// storing for bi-prediction</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="comment">// set motion</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            cMv    [iRefList] = cMvTemp[iRefList][iRefIdxTemp];</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            iRefIdx[iRefList] = iRefIdxTemp;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;          }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;          <span class="keywordflow">if</span> ( iRefList == 1 &amp;&amp; uiCostTemp &lt; costValidList1 &amp;&amp; cs.slice-&gt;list1IdxToList0Idx[ iRefIdxTemp ] &lt; 0 )</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;          {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            costValidList1 = uiCostTemp;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            bitsValidList1 = uiBitsTemp;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            <span class="comment">// set motion</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            mvValidList1     = cMvTemp[iRefList][iRefIdxTemp];</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            refIdxValidList1 = iRefIdxTemp;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      ::memcpy(cMvHevcTemp, cMvTemp, <span class="keyword">sizeof</span>(cMvTemp));</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 0 &amp;&amp; (!cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> || BcwIdx == <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>))</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#aea97ceaa3309a46ee618f9028dd52ade">insertUniMvCands</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>(), &amp;cMvTemp[0][0]);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="keywordtype">unsigned</span> idx1, idx2, idx3, idx4;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="namespacevvenc.html#af6fcdb72acb1320cf627e46450710f19">getAreaIdxNew</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>(), *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>, idx1, idx2, idx3, idx4);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="keywordflow">if</span>( ! <a class="code" href="classvvenc_1_1InterSearch.html#a181840c5939d6651c9613ebb61a10537">m_ReuseUniMv</a>-&gt;<a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[idx1][idx2][idx3][idx4] )</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a181840c5939d6651c9613ebb61a10537">m_ReuseUniMv</a>-&gt;<a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[idx1][idx2][idx3][idx4] = <span class="keyword">new</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>[ 2 * <a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a> ];</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">//          DTRACE( g_trace_ctx, D_TMP, &quot;%d unimv first reuse %d %d %d %d \n&quot;, g_trace_ctx-&gt;getChannelCounter(D_TMP), idx3,idx4,idx1,idx2 );</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        ::memcpy(<a class="code" href="classvvenc_1_1InterSearch.html#a181840c5939d6651c9613ebb61a10537">m_ReuseUniMv</a>-&gt;<a class="code" href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">m_reusedUniMVs</a>[idx1][idx2][idx3][idx4], cMvTemp, 2 * <a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a> * <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>));</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">if</span> (bestCostInter != <a class="code" href="namespacevvenc.html#af3b8fe3c3850ac884f854414f26c76b2">MAX_DOUBLE</a>)</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordtype">int</span> L = (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2828614629c4cd261f778db8c85fcf58">TLayer</a> &lt;= 2) ? 0 : (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2828614629c4cd261f778db8c85fcf58">TLayer</a> - 2);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordtype">double</span> besCostMerge = bestCostInter;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        bestCostInter = (uiCost[0] &lt; uiCost[1]) ? uiCost[0] : uiCost[1];</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">if</span> ((cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2828614629c4cd261f778db8c85fcf58">TLayer</a> &gt; (log2(<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_GOPSize) - (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_FastInferMerge &amp; 7))) &amp;&amp; bestCostInter &gt; <a class="code" href="namespacevvenc.html#a5c92713bb9d8d98f8a99d6a4b1ee56a1">MRG_FAST_RATIOMYV</a>[L] * besCostMerge)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a36810f08eb1336527c11e152ea1642c8">m_skipPROF</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;          <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a97b7311221af453c6fa6d051c6f45da0">m_encOnly</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="comment">//  Bi-predictive Motion estimation</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">if</span>( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2df1dd5ac8070482b6042070f73cffa4">isInterB</a>() &amp;&amp; !<a class="code" href="namespacevvenc_1_1CU.html#a7c89d15e3cd1f22016e3c0c3f506b9ca">CU::isBipredRestriction</a>( cu ) &amp;&amp; (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3b6992dd0d30d043f87cb65a22bceb38">checkLDC</a> || BcwIdx == <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>  || !<a class="code" href="classvvenc_1_1InterSearch.html#ac25bc8fcbfd5def1fec553cf38c1af4f">m_affineModeSelected</a> || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_BCW != 2 ) )</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="keywordtype">bool</span> doBiPred = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        cMvBi[0] = cMv[0];</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        cMvBi[1] = cMv[1];</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        iRefIdxBi[0] = iRefIdx[0];</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        iRefIdxBi[1] = iRefIdx[1];</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        ::memcpy( cMvPredBi,   cMvPred,   <span class="keyword">sizeof</span>( cMvPred   ) );</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        ::memcpy( aaiMvpIdxBi, aaiMvpIdx, <span class="keyword">sizeof</span>( aaiMvpIdx ) );</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        uint32_t uiMotBits[2];</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">if</span>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981">xCopyAMVPInfo</a>(&amp;aacAMVPInfo[1][bestBiPRefIdxL1], &amp;amvp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>]);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;          aaiMvpIdxBi[1][bestBiPRefIdxL1] = bestBiPMvpL1;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          cMvPredBi  [1][bestBiPRefIdxL1] = amvp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>].<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[bestBiPMvpL1];</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          cMvBi    [1] = cMvPredBi[1][bestBiPRefIdxL1];</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;          iRefIdxBi[1] = bestBiPRefIdxL1;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>    [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMvBi[1];</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>]    = iRefIdxBi[1];</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;          cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>]    = bestBiPMvpL1;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;          <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>( cu, predBufTmp, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> );</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;          uiMotBits[0] = uiBits[0] - uiMbBits[0];</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          uiMotBits[1] = uiMbBits[1];</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;          <span class="keywordflow">if</span> ( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> ] &gt; 1 )</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;          {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            uiMotBits[1] += bestBiPRefIdxL1 + 1;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            <span class="keywordflow">if</span> ( bestBiPRefIdxL1 == cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> ]-1 )</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;              uiMotBits[1]--;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;          }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          uiMotBits[1] += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[aaiMvpIdxBi[1][bestBiPRefIdxL1]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;          uiBits[2] = uiMbBits[2] + uiMotBits[0] + uiMotBits[1];</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;          cMvTemp[1][bestBiPRefIdxL1] = cMvBi[1];</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;          uiMotBits[0] = uiBits[0] - uiMbBits[0];</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          uiMotBits[1] = uiBits[1] - uiMbBits[1];</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          uiBits[2] = uiMbBits[2] + uiMotBits[0] + uiMotBits[1];</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordflow">if</span>( doBiPred )</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          <span class="comment">// 4-times iteration (default)</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;          <span class="keywordtype">int</span> iNumIter = 4;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          <span class="comment">// fast encoder setting: only one iteration</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode==VVENC_FASTINTERSEARCH_MODE1 || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode==VVENC_FASTINTERSEARCH_MODE2 || cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a> )</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            iNumIter = 1;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;          }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;          enforceBcwPred = (BcwIdx != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;          <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> iIter = 0; iIter &lt; iNumIter; iIter++ )</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;          {</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            <span class="keywordtype">int</span>         iRefList    = iIter % 2;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode==VVENC_FASTINTERSEARCH_MODE1 || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode==VVENC_FASTINTERSEARCH_MODE2 )</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;              <span class="keywordflow">if</span>( uiCost[0] &lt;= uiCost[1] )</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;              {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                iRefList = 1;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;              }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;              {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                iRefList = 0;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;              }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( iIter == 0 )</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;              iRefList = 0;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="keywordflow">if</span> ( iIter == 0 &amp;&amp; !cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;              cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>    [1 - iRefList][0] = cMv    [1 - iRefList];</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;              cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[1 - iRefList]    = iRefIdx[1 - iRefList];</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;              <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[1 - iRefList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;              <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>( cu, predBufTmp, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>(1 - iRefList) );</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>  refPicList = ( iRefList ? <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> : <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a> );</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <span class="keywordflow">if</span>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            {</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;              iRefList = 0;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;              refPicList = <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            }</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <span class="keywordtype">bool</span> bChanged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            iRefStart = 0;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            iRefEnd   = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ refPicList ]-1;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iRefIdxTemp = iRefStart; iRefIdxTemp &lt;= iRefEnd; iRefIdxTemp++)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;              uiBitsTemp = uiMbBits[2] + uiMotBits[1-iRefList];</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;              uiBitsTemp += ( (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> == <span class="keyword">true</span>) ? <a class="code" href="classvvenc_1_1InterSearch.html#abd69038caf0e20410a0e13758ace1e67">getWeightIdxBits</a>(BcwIdx) : 0 );</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;              <span class="keywordflow">if</span> ( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ refPicList ] &gt; 1 )</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;              {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                uiBitsTemp += iRefIdxTemp+1;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                <span class="keywordflow">if</span> ( iRefIdxTemp == cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[ refPicList ]-1 )</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                  uiBitsTemp--;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;              }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;              uiBitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[aaiMvpIdxBi[iRefList][iRefIdxTemp]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;              <span class="keywordflow">if</span> ( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2691ed25bc1d2b21926bfe74a8dff013">biDirPred</a> )</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;              {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                uiBitsTemp += 1; <span class="comment">// add one bit for symmetrical MVD mode</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;              }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;              <span class="comment">// call ME</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981">xCopyAMVPInfo</a>(&amp;aacAMVPInfo[iRefList][iRefIdxTemp], &amp;amvp[refPicList] );</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#aa17b8a45afa5a9835b69acd2a4372fc0">xMotionEstimation</a> ( cu, origBuf, refPicList, cMvPredBi[iRefList][iRefIdxTemp], iRefIdxTemp, cMvTemp[iRefList][iRefIdxTemp], aaiMvpIdxBi[iRefList][iRefIdxTemp], uiBitsTemp, uiCostTemp, amvp[refPicList], <span class="keyword">true</span> );</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a554f238ef569ea05b99bbef4a0972ae1">xCheckBestMVP</a>( refPicList, cMvTemp[iRefList][iRefIdxTemp], cMvPredBi[iRefList][iRefIdxTemp], aaiMvpIdxBi[iRefList][iRefIdxTemp], amvp[refPicList], uiBitsTemp, uiCostTemp, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;              <span class="keywordflow">if</span> ( uiCostTemp &lt; uiCostBi )</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;              {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                bChanged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                cMvBi[iRefList]     = cMvTemp[iRefList][iRefIdxTemp];</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                iRefIdxBi[iRefList] = iRefIdxTemp;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                uiCostBi            = uiCostTemp;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                uiMotBits[iRefList] = uiBitsTemp - uiMbBits[2] - uiMotBits[1-iRefList];</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                uiMotBits[iRefList] -= ( (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> == <span class="keyword">true</span>) ? <a class="code" href="classvvenc_1_1InterSearch.html#abd69038caf0e20410a0e13758ace1e67">getWeightIdxBits</a>(BcwIdx) : 0 );</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                uiBits[2]           = uiBitsTemp;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                <span class="keywordflow">if</span>(iNumIter!=1)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                  <span class="comment">//  Set motion</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>    [refPicList][0] = cMvBi    [iRefList];</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[refPicList]    = iRefIdxBi[iRefList];</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[iRefList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                  <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>( cu, predBufTmp, refPicList );</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;              }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            } <span class="comment">// for loop-iRefIdxTemp</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160; </div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            <span class="keywordflow">if</span>( !bChanged )</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;              <span class="keywordflow">if</span> ((uiCostBi &lt;= uiCost[0] &amp;&amp; uiCostBi &lt;= uiCost[1]) || enforceBcwPred)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;              {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                <a class="code" href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981">xCopyAMVPInfo</a>(&amp;aacAMVPInfo[0][iRefIdxBi[0]], &amp;amvp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>]);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                <a class="code" href="classvvenc_1_1InterSearch.html#a554f238ef569ea05b99bbef4a0972ae1">xCheckBestMVP</a>( <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>, cMvBi[0], cMvPredBi[0][iRefIdxBi[0]], aaiMvpIdxBi[0][iRefIdxBi[0]], amvp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>], uiBits[2], uiCostBi, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                <span class="keywordflow">if</span>(!cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>)</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                  <a class="code" href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981">xCopyAMVPInfo</a>(&amp;aacAMVPInfo[1][iRefIdxBi[1]], &amp;amvp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>]);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                  <a class="code" href="classvvenc_1_1InterSearch.html#a554f238ef569ea05b99bbef4a0972ae1">xCheckBestMVP</a>( <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>, cMvBi[1], cMvPredBi[1][iRefIdxBi[1]], aaiMvpIdxBi[1][iRefIdxBi[1]], amvp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>], uiBits[2], uiCostBi, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;              }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          } <span class="comment">// for loop-iter</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="comment">// SMVD</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        <span class="keywordflow">if</span>( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2691ed25bc1d2b21926bfe74a8dff013">biDirPred</a> )</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;          <span class="keywordtype">double</span> th1 = 1.02;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          <span class="keywordtype">bool</span> testSME = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;          <span class="keywordtype">int</span> numStartCand = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_SMVD &gt; 1 ? 1 : 5;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> symCost;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cMvPredSym[2];</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;          <span class="keywordtype">int</span> mvpIdxSym[2];</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;          <span class="keywordtype">int</span> curRefList = <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="keywordtype">int</span> tarRefList = 1 - curRefList;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> eCurRefList = (curRefList ? <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> : <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          <span class="keywordtype">int</span> refIdxCur = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a8c0a668a25b6180c50283588b195fec8">symRefIdx</a>[ curRefList ];</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          <span class="keywordtype">int</span> refIdxTar = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a8c0a668a25b6180c50283588b195fec8">symRefIdx</a>[ tarRefList ];</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          <span class="keywordflow">if</span>( aacAMVPInfo[ curRefList ][ refIdxCur ].mvCand[ 0 ] == aacAMVPInfo[ curRefList ][ refIdxCur ].mvCand[ 1 ] )</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            aacAMVPInfo[ curRefList ][ refIdxCur ].<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> = 1;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          <span class="keywordflow">if</span>( aacAMVPInfo[ tarRefList ][ refIdxTar ].mvCand[ 0 ] == aacAMVPInfo[ tarRefList ][ refIdxTar ].mvCand[ 1 ] )</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            aacAMVPInfo[ tarRefList ][ refIdxTar ].<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> = 1;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          <a class="code" href="structvvenc_1_1MvField.html">MvField</a> cCurMvField, cTarMvField;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> costStart = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; aacAMVPInfo[curRefList][refIdxCur].<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; i++ )</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;          {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j = 0; j &lt; aacAMVPInfo[tarRefList][refIdxTar].<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; j++ )</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;              <a class="code" href="CommonDef_8h.html#a024715c04558a9981e960134bdf7fc05">GCC_WARNING_DISABLE_array_bounds</a> <span class="comment">// probably a bug in gcc-10 static analyzer: It thinks the indices are -1 and therefore triggers -Werror=array-bounds</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;              cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>( aacAMVPInfo[curRefList][refIdxCur].mvCand[i], refIdxCur );</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;              cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>( aacAMVPInfo[tarRefList][refIdxTar].mvCand[j], refIdxTar );</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;              <a class="code" href="CommonDef_8h.html#aa79686061aabdeab06e3a87c5059b97b">GCC_WARNING_RESET</a></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;              <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> cost = <a class="code" href="classvvenc_1_1InterSearch.html#af53c99ea0459bcfb52dcf7795770cedb">xGetSymCost</a>( cu, origBuf, eCurRefList, cCurMvField, cTarMvField, BcwIdx );</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;              <span class="keywordflow">if</span> ( cost &lt; costStart )</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;              {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                costStart = cost;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                cMvPredSym[curRefList] = aacAMVPInfo[curRefList][refIdxCur].<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i];</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                cMvPredSym[tarRefList] = aacAMVPInfo[tarRefList][refIdxTar].<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[j];</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                mvpIdxSym[curRefList] = i;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                mvpIdxSym[tarRefList] = j;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;              }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;          }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;          cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a> = cMvPredSym[curRefList];</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;          cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a> = cMvPredSym[tarRefList];</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = cMvPredSym[curRefList];</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;          pred.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>(pred);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          mv.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          uint32_t bits = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>(mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;          bits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[mvpIdxSym[curRefList]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          bits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[mvpIdxSym[tarRefList]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          costStart += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(bits);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;          std::vector&lt;Mv&gt; symmvdCands;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;          <span class="keyword">auto</span> smmvdCandsGen = [&amp;](<a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvCand, <span class="keywordtype">bool</span> mvPrecAdj)</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <span class="keywordflow">if</span> (mvPrecAdj &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>)</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;              mvCand.<a class="code" href="classvvenc_1_1Mv.html#ab1d8dda7a67461e9a09ec2c7a414a129">roundTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            <span class="keywordtype">bool</span> toAddMvCand = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            <span class="keywordflow">for</span> (std::vector&lt;Mv&gt;::iterator pos = symmvdCands.begin(); pos != symmvdCands.end(); pos++)</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;              <span class="keywordflow">if</span> (*pos == mvCand)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;              {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                toAddMvCand = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;              }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="keywordflow">if</span> (toAddMvCand)</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;              symmvdCands.push_back(mvCand);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          };</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          smmvdCandsGen(cMvHevcTemp[curRefList][refIdxCur], <span class="keyword">false</span>);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          smmvdCandsGen(cMvTemp[curRefList][refIdxCur], <span class="keyword">false</span>);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          <span class="keywordflow">if</span> (iRefIdxBi[curRefList] == refIdxCur)</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            smmvdCandsGen(cMvBi[curRefList], <span class="keyword">false</span>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#af3247e7f9b36535efa5752aa104ecc34">m_uniMvListSize</a>; i++)</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;          {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            <span class="keywordflow">if</span>( symmvdCands.size() &gt;= numStartCand )</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <a class="code" href="structvvenc_1_1BlkUniMvInfo.html">BlkUniMvInfo</a>* curMvInfo = <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#a1d103df528daad4fadc350178509dbd2">getBlkUniMvInfo</a>(i);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            smmvdCandsGen(curMvInfo-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfo.html#a25405e0363e78f4d7b1670ff1710a892">uniMvs</a>[curRefList][refIdxCur], <span class="keyword">true</span>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> mvStart : symmvdCands)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;          {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            <span class="keywordtype">bool</span> checked = <span class="keyword">false</span>; <span class="comment">//if it has been checkin in the mvPred.</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; aacAMVPInfo[curRefList][refIdxCur].<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> &amp;&amp; !checked; i++)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;              checked |= (mvStart == aacAMVPInfo[curRefList][refIdxCur].<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i]);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            <span class="keywordflow">if</span> (checked)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> bestCost = costStart;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a1014955f8421b10b97bd219860e426d1">xSymMvdCheckBestMvp</a>(cu, origBuf, mvStart, (<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>)curRefList, aacAMVPInfo, BcwIdx, cMvPredSym, mvpIdxSym, costStart, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="keywordflow">if</span> (costStart &lt; bestCost)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;              cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>(mvStart, refIdxCur);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;              cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>(mvStart.getSymmvdMv(cMvPredSym[curRefList], cMvPredSym[tarRefList]), refIdxTar);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;          }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> startPtMv = cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> mvpCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[mvpIdxSym[curRefList]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>] + <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[mvpIdxSym[tarRefList]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>]);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;          symCost = costStart - mvpCost;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;          <span class="comment">// ME</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;          testSME = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_SMVD &lt;= 2 || ( symCost &lt; uiCostBi * th1 &amp;&amp; uiCostBi &lt; uiCost[ 0 ] &amp;&amp; uiCostBi &lt; uiCost[ 1 ] );</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          <span class="keywordflow">if</span>( testSME )</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;          {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#aaf529386910fa2161fa63a3f71657e07">xSymMotionEstimation</a>( cu, origBuf, cMvPredSym[ curRefList ], cMvPredSym[ tarRefList ], eCurRefList, cCurMvField, cTarMvField, symCost, BcwIdx );</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;          }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          symCost += mvpCost;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;          <span class="keywordflow">if</span> (startPtMv != cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          { <span class="comment">// if ME change MV, run a final check for best MVP.</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a1014955f8421b10b97bd219860e426d1">xSymMvdCheckBestMvp</a>(cu, origBuf, cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>, (<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>)curRefList, aacAMVPInfo, BcwIdx, cMvPredSym, mvpIdxSym, symCost, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;          }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;          bits = uiMbBits[2];</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;          bits += 1; <span class="comment">// add one bit for #symmetrical MVD mode</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          bits += ( (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> == <span class="keyword">true</span>) ? <a class="code" href="classvvenc_1_1InterSearch.html#abd69038caf0e20410a0e13758ace1e67">getWeightIdxBits</a>(BcwIdx) : 0 );</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;          symCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(bits);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;          cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>(cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>.<a class="code" href="classvvenc_1_1Mv.html#a13b80290d7963cd27cc751f73020a798">getSymmvdMv</a>(cMvPredSym[curRefList], cMvPredSym[tarRefList]), refIdxTar);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="comment">// save results</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;          <span class="keywordflow">if</span> ( symCost &lt; uiCostBi )</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            uiCostBi = symCost;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            symMode = 1 + curRefList;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            cMvBi[curRefList] = cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            iRefIdxBi[curRefList] = cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            aaiMvpIdxBi[curRefList][cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>] = mvpIdxSym[curRefList];</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            cMvPredBi[curRefList][iRefIdxBi[curRefList]] = cMvPredSym[curRefList];</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            cMvBi[tarRefList] = cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            iRefIdxBi[tarRefList] = cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            aaiMvpIdxBi[tarRefList][cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>] = mvpIdxSym[tarRefList];</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            cMvPredBi[tarRefList][iRefIdxBi[tarRefList]] = cMvPredSym[tarRefList];</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;          }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      } <span class="comment">// if (B_SLICE)</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <span class="comment">//  Clear Motion Field</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>();</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>();</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMvZero;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMvZero;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="comment">// Set Motion Field</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      cMv    [1] = mvValidList1;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      iRefIdx[1] = refIdxValidList1;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      uiBits [1] = bitsValidList1;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      uiCost [1] = costValidList1;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keywordflow">if</span>( enforceBcwPred )</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        uiCost[0] = uiCost[1] = <a class="code" href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">MAX_UINT</a>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      uiLastModeTemp = uiLastMode;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="keywordflow">if</span> ( uiCostBi &lt;= uiCost[0] &amp;&amp; uiCostBi &lt;= uiCost[1])</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        bestCostInter = uiCostBi;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        uiLastMode = 2;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMvBi[0];</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMvBi[1];</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMvBi[0] - cMvPredBi[0][iRefIdxBi[0]];</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMvBi[1] - cMvPredBi[1][iRefIdxBi[1]];</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = iRefIdxBi[0];</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = iRefIdxBi[1];</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpIdxBi[0][iRefIdxBi[0]];</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpIdxBi[1][iRefIdxBi[1]];</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpNum[0][iRefIdxBi[0]];</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpNum[1][iRefIdxBi[1]];</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 3;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aced3784fdb696103af780e51233b938d">smvdMode</a> = symMode;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( uiCost[0] &lt;= uiCost[1] )</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        bestCostInter = uiCost[0];</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        uiLastMode = 0;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMv[0];</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMv[0] - cMvPred[0][iRefIdx[0]];</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = iRefIdx[0];</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpIdx[0][iRefIdx[0]];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpNum[0][iRefIdx[0]];</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 1;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        bestCostInter = uiCost[1];</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        uiLastMode = 1;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMv[1];</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMv[1] - cMvPred[1][iRefIdx[1]];</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = iRefIdx[1];</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpIdx[1][iRefIdx[1]];</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpNum[1][iRefIdx[1]];</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 2;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keywordflow">if</span>( BcwIdx != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> )</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> = <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>; <span class="comment">// Reset to default for the Non-NormalMC modes.</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      uiHevcCost = (uiCostBi &lt;= uiCost[0] &amp;&amp; uiCostBi &lt;= uiCost[1]) ? uiCostBi : ((uiCost[0] &lt;= uiCost[1]) ? uiCost[0] : uiCost[1]);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_Affine &gt; 1)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      checkAffine = <a class="code" href="classvvenc_1_1InterSearch.html#ad78b260566db7787b860f3d09a32b591">m_modeCtrl</a>-&gt;<a class="code" href="classvvenc_1_1EncModeCtrl.html#a7a0af35d0a3150acc360a452afa853f7">comprCUCtx</a>-&gt;<a class="code" href="structvvenc_1_1ComprCUCtx.html#a30e123e780f79dac12bb4780e98c02ff">bestCU</a> ? (checkAffine &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#ad78b260566db7787b860f3d09a32b591">m_modeCtrl</a>-&gt;<a class="code" href="classvvenc_1_1EncModeCtrl.html#a7a0af35d0a3150acc360a452afa853f7">comprCUCtx</a>-&gt;<a class="code" href="structvvenc_1_1ComprCUCtx.html#a30e123e780f79dac12bb4780e98c02ff">bestCU</a>-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#ad036b5eb236ab3725436ece9cbf93e57">affine</a>) : checkAffine;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2828614629c4cd261f778db8c85fcf58">TLayer</a> &gt; 3)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        checkAffine = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a> &gt; 8 &amp;&amp; cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">height</a> &gt; 8 &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#aef5e5824f1ca0fb9a6190ae4e24f28cd">Affine</a> &amp;&amp; checkAffine)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <a class="code" href="TimeProfiler_8h.html#a1f8b82dec98edb8bd913a4e0b9e32512">PROFILER_SCOPE_AND_STAGE_EXT</a>( 1, g_timeProfiler, P_INTER_MVD_SEARCH_AFFINE, &amp;cs, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a> );</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a74a51773f987d540dd4d4dd02399c06a">m_hevcCost</a> = uiHevcCost;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="comment">// save normal hevc result</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      uint32_t uiMRGIndex = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a4acf9d693cf1d941b426509c7b0ee4ae">mergeIdx</a>;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <span class="keywordtype">bool</span> bMergeFlag = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#ab2f1d06341e47118fffe7a0b2a9e0464">mergeFlag</a>;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      uint32_t uiInterDir = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordtype">int</span>  iSymMode = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aced3784fdb696103af780e51233b938d">smvdMode</a>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cMvd[2];</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      uint32_t uiMvpIdx[2], uiMvpNum[2];</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      uiMvpIdx[0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>];</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      uiMvpIdx[1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>];</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      uiMvpNum[0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>];</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      uiMvpNum[1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>];</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      cMvd[0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0];</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      cMvd[1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0];</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <a class="code" href="structvvenc_1_1MvField.html">MvField</a> cHevcMvField[2];</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      cHevcMvField[0].<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>(cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0], cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>]);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      cHevcMvField[1].<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>(cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0], cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>]);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <span class="comment">// do affine ME &amp; Merge</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> = <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">AFFINEMODEL_4PARAM</a>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvAffine4Para[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>][3];</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="keywordtype">int</span> refIdx4Para[2] = { -1, -1 };</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a74b43514d85787c262e18084a20d61e1">xPredAffineInterSearch</a>(cu, origBuf, puIdx, uiLastModeTemp, uiAffineCost, cMvHevcTemp, acMvAffine4Para, refIdx4Para, BcwIdx, enforceBcwPred, (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> == <span class="keyword">true</span>) ? <a class="code" href="classvvenc_1_1InterSearch.html#abd69038caf0e20410a0e13758ace1e67">getWeightIdxBits</a>(BcwIdx) : 0 );</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 0)</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a91007e4c7d30c0ad661ca2222874443b">storeAffineMotion</a>(cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>, cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>, <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">AFFINEMODEL_4PARAM</a>, BcwIdx);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a05daae41965e8cfa9df1a18006da2ec7">AffineType</a>)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <span class="keywordflow">if</span> (uiAffineCost &lt; uiHevcCost * 1.05) </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;          <span class="comment">// save 4 parameter results</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> bestMv[2][3], bestMvd[2][3];</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;          <span class="keywordtype">int</span> bestMvpIdx[2], bestMvpNum[2], bestRefIdx[2];</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          uint8_t bestInterDir;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;          bestInterDir = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          bestRefIdx[0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[0];</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;          bestRefIdx[1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[1];</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;          bestMvpIdx[0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[0];</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;          bestMvpIdx[1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[1];</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;          bestMvpNum[0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[0];</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;          bestMvpNum[1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[1];</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> refList = 0; refList &lt; 2; refList++)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;          {</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            bestMv[refList][0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[refList][0];</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            bestMv[refList][1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[refList][1];</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            bestMv[refList][2] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[refList][2];</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;            bestMvd[refList][0] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[refList][0];</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            bestMvd[refList][1] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[refList][1];</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            bestMvd[refList][2] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[refList][2];</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;          }</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;          refIdx4Para[0] = bestRefIdx[0];</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;          refIdx4Para[1] = bestRefIdx[1];</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiAffine6Cost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;          cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> = <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a74b43514d85787c262e18084a20d61e1">xPredAffineInterSearch</a>(cu, origBuf, puIdx, uiLastModeTemp, uiAffine6Cost, cMvHevcTemp, acMvAffine4Para, refIdx4Para, BcwIdx, enforceBcwPred, (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> == <span class="keyword">true</span>) ? <a class="code" href="classvvenc_1_1InterSearch.html#abd69038caf0e20410a0e13758ace1e67">getWeightIdxBits</a>(BcwIdx) : 0 );</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;          <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 0)</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;          {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a91007e4c7d30c0ad661ca2222874443b">storeAffineMotion</a>(cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>, cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>, <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>, BcwIdx);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          <span class="comment">// reset to 4 parameter affine inter mode</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          <span class="keywordflow">if</span> (uiAffineCost &lt;= uiAffine6Cost)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;          {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> = <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">AFFINEMODEL_4PARAM</a>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = bestInterDir;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[0] = bestRefIdx[0];</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[1] = bestRefIdx[1];</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[0] = bestMvpIdx[0];</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[1] = bestMvpIdx[1];</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[0] = bestMvpNum[0];</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[1] = bestMvpNum[1];</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> verIdx = 0; verIdx &lt; 3; verIdx++)</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;              cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][verIdx] = bestMvd[0][verIdx];</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;              cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][verIdx] = bestMvd[1][verIdx];</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, bestMv[0][0], bestMv[0][1], bestMv[0][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, bestMv[1][0], bestMv[1][1], bestMv[1][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;          {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            uiAffineCost = uiAffine6Cost;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;          }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        uiAffineCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(1); <span class="comment">// add one bit for affine_type</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordflow">if</span> (uiHevcCost &lt;= uiAffineCost)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="comment">// set hevc me result</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ad036b5eb236ab3725436ece9cbf93e57">affine</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#ab2f1d06341e47118fffe7a0b2a9e0464">mergeFlag</a> = bMergeFlag;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aa764a07618a4b6a317c48cc352d99111">regularMergeFlag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a4acf9d693cf1d941b426509c7b0ee4ae">mergeIdx</a> = uiMRGIndex;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = uiInterDir;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aced3784fdb696103af780e51233b938d">smvdMode</a> = iSymMode;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0]  = cHevcMvField[0].<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = cHevcMvField[0].<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0]  = cHevcMvField[1].<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = cHevcMvField[1].<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = uiMvpIdx[0];</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = uiMvpIdx[1];</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = uiMvpNum[0];</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = uiMvpNum[1];</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMvd[0];</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMvd[1];</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aced3784fdb696103af780e51233b938d">smvdMode</a> = 0;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(!cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ad036b5eb236ab3725436ece9cbf93e57">affine</a>, <span class="stringliteral">&quot;Wrong.&quot;</span>);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        uiLastMode = uiLastModeTemp;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> == 3 &amp;&amp; !cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#ab2f1d06341e47118fffe7a0b2a9e0464">mergeFlag</a> )</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="keywordflow">if</span> (BcwIdx != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>)</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      {</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> = BcwIdx;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      }</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <a class="code" href="namespacevvenc_1_1CU.html#a88cd6fcff13e86d529ac63c3d2eca6c0">CU::spanMotionInfo</a>( cu, mergeCtx );</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a36810f08eb1336527c11e152ea1642c8">m_skipPROF</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a97b7311221af453c6fa6d051c6f45da0">m_encOnly</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">//  MC</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBuf = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(cu);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>( cu, predBuf, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384a4750af3c3dcdffb256d98e4ad103e675">REF_PIC_LIST_X</a> );</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    puIdx++;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;}</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="comment">// AMVP</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a4ff177faa51dea313e7bd4049db215e6"> 1795</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a4ff177faa51dea313e7bd4049db215e6">InterSearch::xEstimateMvPredAMVP</a>( <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <span class="keywordtype">int</span> iRefIdx, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvPred, <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>&amp; rAMVPInfo, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; distBiP )</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;{</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>         cBestMv;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="keywordtype">int</span>        iBestIdx   = 0;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiBestCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="keywordtype">int</span>        i;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>*  pcAMVPInfo = &amp;rAMVPInfo;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="comment">// Fill the MV Candidates</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <a class="code" href="namespacevvenc_1_1CU.html#a4803d88dce4e2c5fef3b0fcb1705463a">CU::fillMvpCand</a>( cu, refPicList, iRefIdx, *pcAMVPInfo );</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="comment">// initialize Mvp index &amp; Mvp</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  iBestIdx = 0;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  cBestMv  = pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[0];</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBuf = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="comment">//-- Check Minimum Cost.</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="keywordflow">for</span>( i = 0 ; i &lt; pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; i++)</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiTmpCost = <a class="code" href="classvvenc_1_1InterSearch.html#a771848baeb6a36ee61ee9bc83ededc64">xGetTemplateCost</a>( cu, origBuf, predBuf, pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i], i, <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>, refPicList, iRefIdx );</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordflow">if</span>( uiBestCost &gt; uiTmpCost )</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      uiBestCost  = uiTmpCost;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      cBestMv     = pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i];</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      iBestIdx    = i;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      distBiP     = uiTmpCost;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    }</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  }</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="comment">// Setting Best MVP</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  rcMvPred = cBestMv;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[refPicList] = iBestIdx;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[refPicList] = pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;}</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; </div>
<div class="line"><a name="l01834"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ae1a5f5f359b0f586440af2d441a37544"> 1834</a></span>&#160;uint32_t <a class="code" href="classvvenc_1_1InterSearch.html#ae1a5f5f359b0f586440af2d441a37544">InterSearch::xGetMvpIdxBits</a>(<span class="keywordtype">int</span> iIdx, <span class="keywordtype">int</span> iNum)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;{</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(iIdx &lt; 0 || iNum &lt; 0 || iIdx &gt;= iNum, <span class="stringliteral">&quot;Invalid parameters&quot;</span>);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keywordflow">if</span> (iNum == 1)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  {</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  }</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160; </div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  uint32_t uiLength = 1;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <span class="keywordtype">int</span> iTemp = iIdx;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordflow">if</span> ( iTemp == 0 )</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">return</span> uiLength;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="keywordtype">bool</span> bCodeLast = ( iNum-1 &gt; iTemp );</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  uiLength += (iTemp-1);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="keywordflow">if</span>( bCodeLast )</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    uiLength++;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  }</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">return</span> uiLength;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;}</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#af67498245b43d85d1afe6c053a4eb1b6"> 1862</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#af67498245b43d85d1afe6c053a4eb1b6">InterSearch::xGetBlkBits</a>( <span class="keywordtype">bool</span> bPSlice, <span class="keywordtype">int</span> iPartIdx, uint32_t uiLastMode, uint32_t uiBlkBit[3])</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;{</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  uiBlkBit[0] = (! bPSlice) ? 3 : 1;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  uiBlkBit[1] = 3;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  uiBlkBit[2] = 5;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;}</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981"> 1869</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981">InterSearch::xCopyAMVPInfo</a> (<a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>* pSrc, <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>* pDst)</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;{</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  pDst-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> = pSrc-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pSrc-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; i++)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    pDst-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i] = pSrc-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i];</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;}</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a554f238ef569ea05b99bbef4a0972ae1"> 1878</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a554f238ef569ea05b99bbef4a0972ae1">InterSearch::xCheckBestMVP</a> ( <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; cMv, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvPred, <span class="keywordtype">int</span>&amp; riMVPIdx, <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>&amp; amvpInfo, uint32_t&amp; ruiBits, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost, <span class="keyword">const</span> uint8_t imv )</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;{</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="keywordflow">if</span> ( imv &gt; 0 &amp;&amp; imv &lt; 3 )</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>* pcAMVPInfo = &amp;amvpInfo;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[riMVPIdx] != rcMvPred, <span class="stringliteral">&quot;Invalid MV prediction candidate&quot;</span>);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keywordflow">if</span> (pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> &lt; 2)</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  }</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a> ( 0    );</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordtype">int</span> iBestMVPIdx = riMVPIdx;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = rcMvPred;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  pred.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(imv);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>( pred );</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = cMv;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  mv.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(imv);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <span class="keywordtype">int</span> iOrgMvBits = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>(mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  iOrgMvBits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[riMVPIdx][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="keywordtype">int</span> iBestMvBits = iOrgMvBits;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160; </div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iMVPIdx = 0; iMVPIdx &lt; pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; iMVPIdx++)</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">if</span> (iMVPIdx == riMVPIdx)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    }</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    pred = pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[iMVPIdx];</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    pred.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(imv);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>( pred );</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordtype">int</span> iMvBits = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>(mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    iMvBits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[iMVPIdx][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordflow">if</span> (iMvBits &lt; iBestMvBits)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    {</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      iBestMvBits = iMvBits;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      iBestMVPIdx = iMVPIdx;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    }</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  }</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <span class="keywordflow">if</span> (iBestMVPIdx != riMVPIdx)  <span class="comment">//if changed</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  {</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    rcMvPred = pcAMVPInfo-&gt;<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[iBestMVPIdx];</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    riMVPIdx = iBestMVPIdx;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    uint32_t uiOrgBits = ruiBits;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    ruiBits = uiOrgBits - iOrgMvBits + iBestMvBits;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    ruiCost = (ruiCost - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( uiOrgBits ))  + <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( ruiBits );</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  }</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;}</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; </div>
<div class="line"><a name="l01939"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a771848baeb6a36ee61ee9bc83ededc64"> 1939</a></span>&#160;<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> <a class="code" href="classvvenc_1_1InterSearch.html#a771848baeb6a36ee61ee9bc83ededc64">InterSearch::xGetTemplateCost</a>( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                                          <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf,</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                                          <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>&amp;  predBuf,</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                                          <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvCand,</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                                          <span class="keywordtype">int</span>          iMVPIdx,</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                                          <span class="keywordtype">int</span>          iMVPNum,</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                                          <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>   refPicList,</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                                          <span class="keywordtype">int</span>          iRefIdx</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;)</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;{</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* picRef = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>( refPicList, iRefIdx );</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( cMvCand, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="comment">// prediction pattern</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ac5bedb7997fc561b55c47c2f1713bb59">xPredInterBlk</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, picRef, cMvCand, predBuf, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> ], <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="comment">// calc distortion</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  uiCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(origBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a> ], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4f3ad87be4ac3fc12e60590dda8bf974">DF_SAD</a>);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  uiCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[iMVPIdx][iMVPNum] );</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <span class="keywordflow">return</span> uiCost;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;}</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aa17b8a45afa5a9835b69acd2a4372fc0"> 1965</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#aa17b8a45afa5a9835b69acd2a4372fc0">InterSearch::xMotionEstimation</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvPred, <span class="keywordtype">int</span> iRefIdxPred, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMv, <span class="keywordtype">int</span>&amp; riMVPIdx, uint32_t&amp; ruiBits, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost, <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>&amp; amvpInfo, <span class="keywordtype">bool</span> bBi)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;{</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> &amp;&amp; !bBi &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#a5f82995c567b1a06019ec3069d2f5166">xReadBufferedUniMv</a>( cu, refPicList, iRefIdxPred, rcMvPred, rcMv, ruiBits, ruiCost ) )</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cMvHalf, cMvQter;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(refPicList &gt;= <a class="code" href="namespacevvenc.html#a7cf3acc655efbe44b86894c075acb23c">MAX_NUM_REF_LIST_ADAPT_SR</a> || iRefIdxPred&gt;=<span class="keywordtype">int</span>(<a class="code" href="namespacevvenc.html#aa99f1bbf9afbf8a3b21bb9f306663b45">MAX_IDX_ADAPT_SR</a>), <span class="stringliteral">&quot;Invalid reference picture list&quot;</span>);</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a> = <a class="code" href="classvvenc_1_1InterSearch.html#acfac1ad8a7754b33c46766fe254b7b97">m_aaiAdaptSR</a>[refPicList][iRefIdxPred];</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  <span class="keywordtype">int</span>    iSrchRng   = (bBi ? <a class="code" href="classvvenc_1_1InterSearch.html#a2c737d35b7158e64d1aaeafb34537fc6">m_bipredSearchRange</a> : <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a>);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="keywordtype">double</span> fWeight    = 1.0;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>  origBufTmpCnst;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>* pBuf      = &amp;origBuf;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="keywordflow">if</span>(bBi) <span class="comment">// Bi-predictive ME</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>  origBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="comment">// NOTE: Other buf contains predicted signal from another direction</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> otherBuf = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[1 - (int)refPicList].getCompactBuf( cu );</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    origBufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#ae234f3d4d1911a5f0e1b61a5425c320f">copyFrom</a>(origBuf);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    origBufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#af907ad3e49a30f4c2990626baf9bde6a">removeHighFreq</a>( otherBuf, <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bClipForBiPredMeEnabled, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a> );</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;   </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    origBufTmpCnst = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    pBuf           = &amp;origBufTmpCnst;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    fWeight        = <a class="code" href="classvvenc_1_1InterSearch.html#a38fa18d30e9c51ef390aa273da0f2cc5">xGetMEDistortionWeight</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a>, refPicList );</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <span class="comment">//  Search key pattern initialization</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>  tmpPattern   = pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>();</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>* pcPatternKey = &amp;tmpPattern;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a> = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> ];</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* refPic = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>(refPicList, iRefIdxPred);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> buf = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a9c5b988d87c66e70baf1da88d231bb88">wrapAroundEnabled</a> ? refPic-&gt;<a class="code" href="structvvenc_1_1Picture.html#adfeeb46910b1ca91b82e20aace08b92a">getRecoWrapBuf</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>]) : refPic-&gt;<a class="code" href="structvvenc_1_1Picture.html#aee021e1a0b2774638746e6e9e76a5519">getRecoBuf</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>]);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a> cStruct;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>  = pcPatternKey;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>    = buf.<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>        = buf.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a>      = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">IMV_HPEL</a> ? 1 : (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> &lt;&lt; 1);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a3d559b877ba707a765a8152b4cb2ad59">useAltHpelIf</a>  = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">IMV_HPEL</a>;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a09b3d26422ae3d4e4cb613c071d9b719">inCtuSearch</a>   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#acae32b49c8110d51785e4657b62fe218">zeroMV</a>        = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <a class="code" href="structvvenc_1_1CodedCUInfo.html">CodedCUInfo</a> &amp;relatedCU = <a class="code" href="classvvenc_1_1InterSearch.html#ad78b260566db7787b860f3d09a32b591">m_modeCtrl</a>-&gt;<a class="code" href="classvvenc_1_1CacheBlkInfoCtrl.html#ac67df041ac0893256edaedd0ded4ee04">getBlkInfo</a>( cu );</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keywordtype">bool</span> bQTBTMV  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="keywordtype">bool</span> bQTBTMV2 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cIntMv;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordflow">if</span>( !bBi )</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordtype">bool</span> bValid = relatedCU.<a class="code" href="structvvenc_1_1CodedCUInfo.html#a6a1848e81d42717020cec39b84c97662">getMv</a>( refPicList, iRefIdxPred, cIntMv );</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">if</span>( bValid )</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      bQTBTMV2 = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      cIntMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>( <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> predQuarter = rcMvPred;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  predQuarter.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>( predQuarter );</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(2);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="comment">//  Do integer search</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keywordflow">if</span>( ( <a class="code" href="classvvenc_1_1InterSearch.html#ae98c2fa56ca7cf3b3c994d78d3d1418b">m_motionEstimationSearchMethod</a> == VVENC_MESEARCH_FULL ) || bBi || bQTBTMV )</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE1 || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE3 ? 2 : 0;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a>);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> bestInitMv = (bBi ? rcMv : rcMvPred);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cTmpMv     = bestInitMv;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(cTmpMv, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + (cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> * cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>) + cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiBestSad = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    uiBestSad += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>(cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a>);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> prevMv[<a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#abf2802c95763e945c9e6f472995471e6">m_uniMvListMaxSize</a>];</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#af3247e7f9b36535efa5752aa104ecc34">m_uniMvListSize</a>; i++)</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1BlkUniMvInfo.html">BlkUniMvInfo</a>* curMvInfo = <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#a1d103df528daad4fadc350178509dbd2">getBlkUniMvInfo</a>( i );</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      cTmpMv = curMvInfo-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfo.html#a25405e0363e78f4d7b1670ff1710a892">uniMvs</a>[refPicList][iRefIdxPred];</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      prevMv[i] = cTmpMv;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; </div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;      <span class="keywordtype">int</span> j = 0;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      <span class="keywordflow">for</span> (; j &lt; i; j++)</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <span class="keywordflow">if</span> (cTmpMv == prevMv[j])</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="keywordflow">if</span> (j &lt; i)</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(cTmpMv, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + (cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> * cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>) + cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; </div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiSad = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      uiSad += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>(cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a>);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="keywordflow">if</span> (uiSad &lt; uiBestSad)</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        uiBestSad = uiSad;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        bestInitMv = curMvInfo-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfo.html#a25405e0363e78f4d7b1670ff1710a892">uniMvs</a>[refPicList][iRefIdxPred];</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = uiSad;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    }</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keywordflow">if</span>( !bQTBTMV )</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a923a81a518d0b94fca78be81c59716a6">xSetSearchRange</a>(cu, bestInitMv, iSrchRng, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a> );</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ad546194ff2abcc407c4ad8dbeb88f37b">xPatternSearch</a>( cStruct, rcMv, ruiCost);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  }</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>( bQTBTMV2 )</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    rcMv = cIntMv;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> = ( !<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bRestrictMESampling &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_motionEstimationSearchMethod == VVENC_MESEARCH_SELECTIVE ) ? 1 :</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                            ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE1 || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE3 ) ? 2 : 0;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">xTZSearch</a>(cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiCost, <a class="code" href="CommonDef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> = ( !<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bRestrictMESampling &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_motionEstimationSearchMethod == VVENC_MESEARCH_SELECTIVE ) ? 1 :</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                            ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE1 || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE3 ) ? 2 : 0;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    rcMv = rcMvPred;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> *pIntegerMv2Nx2NPred = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a95d4cdaf8c61540ad5d8a6646df90fe7">xPatternSearchFast</a>(cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiCost, pIntegerMv2Nx2NPred);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    relatedCU.<a class="code" href="structvvenc_1_1CodedCUInfo.html#a0f3e473ce4f36b10586f0b99cf5a7039">setMv</a>( refPicList, iRefIdxPred, rcMv );</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>( g_trace_ctx, D_ME, <span class="stringliteral">&quot;%d %d %d :MECostFPel&lt;L%d,%d&gt;: %d,%d,%dx%d, %d&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>( g_trace_ctx, D_ME ), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#af1fa96a850f404aded578d3e29dedbcb">poc</a>, 0, ( <span class="keywordtype">int</span> ) refPicList, ( <span class="keywordtype">int</span> ) bBi, cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a>, cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a>, cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a>, cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">height</a>, ruiCost );</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="comment">// sub-pel refinement for sub-pel resolution</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="keywordflow">if</span> ( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 0 || cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">IMV_HPEL</a> )</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastSubPel != 2 )</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    {</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a3adb61022e07cfeb1c5112be359930d4">xPatternSearchFracDIF</a>( cu, refPicList, iRefIdxPred, cStruct, rcMv, cMvHalf, cMvQter, ruiCost );</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>( 0 );</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    rcMv &lt;&lt;= 2;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    rcMv  += ( cMvHalf &lt;&lt;= 1 );</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    rcMv  += cMvQter;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    uint32_t uiMvBits = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>( rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, rcMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    ruiBits += uiMvBits;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    ruiCost = ( <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> ) ( floor( fWeight * ( ( <span class="keywordtype">double</span> ) ruiCost - ( <span class="keywordtype">double</span> ) <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( uiMvBits ) ) ) + ( <span class="keywordtype">double</span> ) <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( ruiBits ) );</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    rcMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// integer refinement for integer-pel and 4-pel resolution</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    rcMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a79bbecad33262eecb8522cc540c421ac">xPatternSearchIntRefine</a>( cu, cStruct, rcMv, rcMvPred, riMVPIdx, ruiBits, ruiCost, amvpInfo, fWeight);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_ME, <span class="stringliteral">&quot;   MECost&lt;L%d,%d&gt;: %6d (%d)  MV:%d,%d\n&quot;</span>, (<span class="keywordtype">int</span>)refPicList, (<span class="keywordtype">int</span>)bBi, ruiCost, ruiBits, rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &lt;&lt; 2, rcMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &lt;&lt; 2);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;}</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; </div>
<div class="line"><a name="l02130"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a923a81a518d0b94fca78be81c59716a6"> 2130</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a923a81a518d0b94fca78be81c59716a6">InterSearch::xSetSearchRange</a> ( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; cMvPred,</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">int</span> iSrchRng,</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                                    <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr )</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;{</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1PreCalcValues.html">PreCalcValues</a>&amp; pcv = *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iMvShift = <a class="code" href="namespacevvenc.html#ac805e492b380b892650ee0b344b0f69e">MV_FRACTIONAL_BITS_INTERNAL</a>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cFPMvPred = cMvPred;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( cFPMvPred, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), pcv );</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; </div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvTL(cFPMvPred.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> - (iSrchRng &lt;&lt; iMvShift), cFPMvPred.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> - (iSrchRng &lt;&lt; iMvShift));</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvBR(cFPMvPred.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> + (iSrchRng &lt;&lt; iMvShift), cFPMvPred.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> + (iSrchRng &lt;&lt; iMvShift));</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keywordflow">if</span>( pcv.<a class="code" href="classvvenc_1_1PreCalcValues.html#a00540ef615848135e5a210605f902ecd">wrapArround</a> )</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <a class="code" href="namespacevvenc.html#a24afc1a31bf13037ec3b4a87cc51b97b">wrapClipMv</a>( mvTL, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <a class="code" href="namespacevvenc.html#a24afc1a31bf13037ec3b4a87cc51b97b">wrapClipMv</a>( mvBR, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  }</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( mvTL, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), pcv);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( mvBR, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), pcv);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  mvTL.<a class="code" href="classvvenc_1_1Mv.html#a8666fe6595b172b6d3d8539b6e794339">divideByPowerOf2</a>( iMvShift );</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  mvBR.<a class="code" href="classvvenc_1_1Mv.html#a8666fe6595b172b6d3d8539b6e794339">divideByPowerOf2</a>( iMvShift );</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>   = mvTL.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>    = mvTL.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>  = mvBR.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> = mvBR.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;}</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160; </div>
<div class="line"><a name="l02164"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ad546194ff2abcc407c4ad8dbeb88f37b"> 2164</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#ad546194ff2abcc407c4ad8dbeb88f37b">InterSearch::xPatternSearch</a>( <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp;  cStruct,</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                                  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp;                 rcMv,</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                                  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp;         ruiSAD )</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;{</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  uiSad;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  uiSadBest = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordtype">int</span>         iBestX = 0;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="keywordtype">int</span>         iBestY = 0;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="comment">//-- jclee for using the SAD function pointer</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> );</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160; </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a>;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* piRef = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + (sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a> * cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> y = sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>; y &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a>; y++ )</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  {</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> x = sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>; x &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>; x++ )</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    {</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      <span class="comment">//  find min. distortion position</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = piRef + x;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      uiSad = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a> );</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="comment">// motion cost</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      uiSad += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( x, y, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">if</span> ( uiSad &lt; uiSadBest )</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      {</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        uiSadBest = uiSad;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        iBestX    = x;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        iBestY    = y;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = uiSad;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      }</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    }</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    piRef += cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>( iBestX, iBestY );</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> = uiSadBest; <span class="comment">// th for testing</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  ruiSAD = uiSadBest - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( iBestX, iBestY, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;}</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a95d4cdaf8c61540ad5d8a6646df90fe7"> 2209</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a95d4cdaf8c61540ad5d8a6646df90fe7">InterSearch::xPatternSearchFast</a>( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                                      <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>            refPicList,</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                                      <span class="keywordtype">int</span>                   iRefIdxPred,</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                                      <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp;       cStruct,</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                                      <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp;                   rcMv,</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                                      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp;           ruiSAD,</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* <span class="keyword">const</span>       pIntegerMv2Nx2NPred )</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;{</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">picture</a>-&gt;<a class="code" href="structvvenc_1_1Picture.html#a235d0e90175a94236f1f3ebac8ec0e35">useScME</a> )</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordflow">switch</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#a067e085429f9049d0c4b411fb8622147">m_motionEstimationSearchMethodSCC</a> )</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    {</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      <span class="keywordflow">case</span> 3: <span class="comment">//VVENC_MESEARCH_DIAMOND_FAST:</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">xTZSearch</a>         ( cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiSAD, pIntegerMv2Nx2NPred, <span class="keyword">true</span>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      <span class="keywordflow">case</span> 2: <span class="comment">//VVENC_MESEARCH_DIAMOND:</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">xTZSearch</a>         ( cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiSAD, pIntegerMv2Nx2NPred, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="keywordflow">case</span> 1: <span class="comment">//VVENC_MESEARCH_SELECTIVE:</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a53890dc1d8786e787c63cd6c053979ac">xTZSearchSelective</a>( cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiSAD, pIntegerMv2Nx2NPred );</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        <a class="code" href="StatCounter_8h.html#a27264efd631c4f584ddcb2f5888ae6ed">THROW</a>(<span class="stringliteral">&quot;shouldn&#39;t get here&quot;</span>);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160; </div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="keywordflow">switch</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#ae98c2fa56ca7cf3b3c994d78d3d1418b">m_motionEstimationSearchMethod</a> )</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  {</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="keywordflow">case</span> VVENC_MESEARCH_DIAMOND_FAST:</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">xTZSearch</a>         ( cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiSAD, pIntegerMv2Nx2NPred, <span class="keyword">false</span>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keywordflow">case</span> VVENC_MESEARCH_DIAMOND:</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">xTZSearch</a>         ( cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiSAD, pIntegerMv2Nx2NPred, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="keywordflow">case</span> VVENC_MESEARCH_SELECTIVE:</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a53890dc1d8786e787c63cd6c053979ac">xTZSearchSelective</a>( cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiSAD, pIntegerMv2Nx2NPred );</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">case</span> VVENC_MESEARCH_DIAMOND_ENHANCED:</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">xTZSearch</a>         ( cu, refPicList, iRefIdxPred, cStruct, rcMv, ruiSAD, pIntegerMv2Nx2NPred, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160; </div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">case</span> VVENC_MESEARCH_FULL:</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <a class="code" href="StatCounter_8h.html#a27264efd631c4f584ddcb2f5888ae6ed">THROW</a>(<span class="stringliteral">&quot;shouldn&#39;t get here&quot;</span>);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;}</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb"> 2262</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">InterSearch::xTZSearch</a>( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                             <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>            refPicList,</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                             <span class="keywordtype">int</span>                   iRefIdxPred,</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                             <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp;    cStruct,</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                             <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp;                   rcMv,</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                             <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp;           ruiSAD,</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* <span class="keyword">const</span>       pIntegerMv2Nx2NPred,</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">bool</span>            bExtendedSettings,</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">bool</span>            bFastSettings)</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;{</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bUseRasterInFastMode                    = <span class="keyword">true</span>; <span class="comment">//toggle this to further reduce runtime</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bUseAdaptiveRaster                      = bExtendedSettings;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>  iRaster                                 = (bFastSettings &amp;&amp; bUseRasterInFastMode) ? 8 : 5;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bTestZeroVector                         = <span class="keyword">true</span> &amp;&amp; !bFastSettings;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bTestZeroVectorStart                    = bExtendedSettings;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bTestZeroVectorStop                     = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bFirstSearchDiamond                     = <span class="keyword">true</span>;  <span class="comment">// 1 = xTZ8PointDiamondSearch   0 = xTZ8PointSquareSearch</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bFirstCornersForDiamondDist1            = bExtendedSettings;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bFirstSearchStop                        = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bFastMEAssumingSmootherMVEnabled;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <span class="keyword">const</span> uint32_t uiFirstSearchRounds                 = bFastSettings ? (bUseRasterInFastMode?3:2) : 3;     <span class="comment">// first search stop X rounds after best match (must be &gt;=1)</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bEnableRasterSearch                     = bFastSettings ? bUseRasterInFastMode : <span class="keyword">true</span>;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bAlwaysRasterSearch                     = bExtendedSettings;  <span class="comment">// true: BETTER but factor 2 slower</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bRasterRefinementEnable                 = <span class="keyword">false</span>; <span class="comment">// enable either raster refinement or star refinement</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bRasterRefinementDiamond                = <span class="keyword">false</span>; <span class="comment">// 1 = xTZ8PointDiamondSearch   0 = xTZ8PointSquareSearch</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bRasterRefinementCornersForDiamondDist1 = bExtendedSettings;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bStarRefinementEnable                   = <span class="keyword">true</span>;  <span class="comment">// enable either star refinement or raster refinement</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bStarRefinementDiamond                  = <span class="keyword">true</span>;  <span class="comment">// 1 = xTZ8PointDiamondSearch   0 = xTZ8PointSquareSearch</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bStarRefinementCornersForDiamondDist1   = bExtendedSettings;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bStarRefinementStop                     = <span class="keyword">false</span> || bFastSettings;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <span class="keyword">const</span> uint32_t uiStarRefinementRounds              = 2;  <span class="comment">// star refinement stop X rounds after best match (must be &gt;=1)</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bNewZeroNeighbourhoodTest               = bExtendedSettings;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; </div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  <span class="keywordtype">int</span> iSearchRange = <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a>;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  {</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( rcMv, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(),*cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  }</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#a8666fe6595b172b6d3d8539b6e794339">divideByPowerOf2</a>(2);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="comment">// init TZSearchStruct</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> );</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <span class="comment">// distortion</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <span class="comment">// set rcMv (Median predictor) as start point and as best point</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, rcMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0, 0 );</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="comment">// test whether zero Mv is better start point than Median predictor</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <span class="keywordflow">if</span> ( bTestZeroVector )</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keywordflow">if</span> ((rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> != 0 || rcMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> != 0) &amp;&amp;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      (0 != cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> || 0 != cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>))</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      <span class="comment">// only test 0-vector if not obviously previously tested.</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, 0, 0, 0, 0 );</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; </div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a>;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <span class="keywordflow">if</span> (pIntegerMv2Nx2NPred != 0)</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> integerMv2Nx2NPred = *pIntegerMv2Nx2NPred;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( integerMv2Nx2NPred, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a8666fe6595b172b6d3d8539b6e794339">divideByPowerOf2</a>(2);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordflow">if</span> ((rcMv != integerMv2Nx2NPred) &amp;&amp;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      (integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> != cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> || integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> != cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>))</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      <span class="comment">// only test integerMv2Nx2NPred if not obviously previously tested.</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0, 0);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#af3247e7f9b36535efa5752aa104ecc34">m_uniMvListSize</a>; i++)</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="keyword">const</span> <a class="code" href="structvvenc_1_1BlkUniMvInfo.html">BlkUniMvInfo</a>* curMvInfo = <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#a1d103df528daad4fadc350178509dbd2">getBlkUniMvInfo</a>(i);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cTmpMv = curMvInfo-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfo.html#a25405e0363e78f4d7b1670ff1710a892">uniMvs</a>[refPicList][iRefIdxPred];</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(cTmpMv, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + (cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> * cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>) + cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiSad = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    uiSad += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>(cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a>);</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="keywordflow">if</span> (uiSad &lt; cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>)</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> = uiSad;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> = cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> = cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = uiSad;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  }</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="comment">// set search range</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> currBestMv(cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> );</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    currBestMv &lt;&lt;= <a class="code" href="namespacevvenc.html#ac805e492b380b892650ee0b344b0f69e">MV_FRACTIONAL_BITS_INTERNAL</a>;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a923a81a518d0b94fca78be81c59716a6">xSetSearchRange</a>(cu, currBestMv, <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a> &gt;&gt; (bFastSettings ? 1 : 0), sr );</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  <span class="comment">// starting point after initial examination</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="keywordtype">int</span>  iDist = 0;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="keywordtype">int</span>  iStartX = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="keywordtype">int</span>  iStartY = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="comment">// Early termination of motion search after selection of starting candidate</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bIntegerET )</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  {</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="keywordtype">bool</span> isLargeBlock = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>().<a class="code" href="structvvenc_1_1Size.html#ade69005a9b1da536b0ffaee9db5a6916">area</a>() &gt; 64;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a>( cStruct, iStartX, iStartY, 1, <span class="keyword">false</span> ); <span class="comment">// 4-point small diamond search</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> == iStartX &amp;&amp; cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> == iStartY )</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="keywordflow">if</span> ( isLargeBlock )</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#ae6221582f4c06ae8910bf62fcc456069">xTZ4PointSquareSearch</a>( cStruct, iStartX, iStartY, 1 );</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> == iStartX &amp;&amp; cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> == iStartY )</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        {</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;          <span class="comment">// write out best match</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;          rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> );</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;          ruiSAD = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;          <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      {</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="comment">// write out best match</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> );</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        ruiSAD = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    }</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;  }</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <span class="comment">// start search</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  iDist = 0;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  iStartX = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  iStartY = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bBestCandidateZero = (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> == 0) &amp;&amp; (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> == 0);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <span class="comment">// first search around best position up to now.</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  <span class="comment">// The following works as a &quot;subsampled/log&quot; window search around the best candidate</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;  <span class="keywordflow">for</span> ( iDist = 1; iDist &lt;= iSearchRange; iDist*=2 )</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keywordflow">if</span> ( bFirstSearchDiamond == 1 )</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    {</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a> ( cStruct, iStartX, iStartY, iDist, bFirstCornersForDiamondDist1 );</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    {</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a68106a08253d342623282a38b62c0fae">xTZ8PointSquareSearch</a>  ( cStruct, iStartX, iStartY, iDist );</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    }</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160; </div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="keywordflow">if</span> ( bFirstSearchStop &amp;&amp; ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> &gt;= uiFirstSearchRounds ) ) <span class="comment">// stop criterion</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    {</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="keywordflow">if</span> (!bNewZeroNeighbourhoodTest)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="comment">// test whether zero Mv is a better start point than Median predictor</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="keywordflow">if</span> ( bTestZeroVectorStart &amp;&amp; ((cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> != 0) || (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> != 0)) )</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, 0, 0, 0, 0 );</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      <span class="keywordflow">if</span> ( (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> == 0) &amp;&amp; (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> == 0) )</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <span class="comment">// test its neighborhood</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        <span class="keywordflow">for</span> ( iDist = 1; iDist &lt;= iSearchRange; iDist*=2 )</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a>( cStruct, 0, 0, iDist, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;          <span class="keywordflow">if</span> ( bTestZeroVectorStop &amp;&amp; (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> &gt; 0) ) <span class="comment">// stop criterion</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;          {</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;          }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        }</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      }</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    }</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  }</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="comment">// Test also zero neighbourhood but with half the range</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="comment">// It was reported that the original (above) search scheme using bTestZeroVectorStart did not</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="comment">// make sense since one would have already checked the zero candidate earlier</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="comment">// and thus the conditions for that test would have not been satisfied</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="keywordflow">if</span> (bTestZeroVectorStart == <span class="keyword">true</span> &amp;&amp; bBestCandidateZero != <span class="keyword">true</span>)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="keywordflow">for</span> ( iDist = 1; iDist &lt;= (iSearchRange &gt;&gt; 1); iDist*=2 )</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a>( cStruct, 0, 0, iDist, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;        <span class="keywordflow">if</span> ( bTestZeroVectorStop &amp;&amp; (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> &gt; 2) ) <span class="comment">// stop criterion</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        {</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        }</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      }</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160; </div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  <span class="comment">// calculate only 2 missing points instead 8 points if cStruct.uiBestDistance == 1</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> == 1 )</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  {</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = 0;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7ef728d3e31f6b319e88d2f023ef92cf">xTZ2PointSearch</a>( cStruct );</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  }</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; </div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  <span class="comment">// raster search if distance is too big</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  <span class="keywordflow">if</span> (bUseAdaptiveRaster)</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordtype">int</span> iWindowSize     = iRaster;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a> localsr = sr;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">if</span> (!(bEnableRasterSearch &amp;&amp; ( ((<span class="keywordtype">int</span>)(cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a>) &gt;= iRaster))))</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    {</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      iWindowSize ++;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>   /= 2;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>  /= 2;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>    /= 2;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a> /= 2;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = iWindowSize;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keywordflow">for</span> ( iStartY = localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>; iStartY &lt;= localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a>; iStartY += iWindowSize )</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      <span class="keywordflow">for</span> ( iStartX = localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>; iStartX &lt;= localsr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>; iStartX += iWindowSize )</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, iStartX, iStartY, 0, iWindowSize );</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      }</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    }</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  {</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="keywordflow">if</span> ( bEnableRasterSearch &amp;&amp; ( ((<span class="keywordtype">int</span>)(cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a>) &gt;= iRaster) || bAlwaysRasterSearch ) )</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    {</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = iRaster;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <span class="keywordflow">for</span> ( iStartY = sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>; iStartY &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a>; iStartY += iRaster )</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <span class="keywordflow">for</span> ( iStartX = sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>; iStartX &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>; iStartX += iRaster )</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        {</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, iStartX, iStartY, 0, iRaster );</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        }</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      }</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    }</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  }</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; </div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  <span class="comment">// raster refinement</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160; </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  <span class="keywordflow">if</span> ( bRasterRefinementEnable &amp;&amp; cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt; 0 )</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;  {</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="keywordflow">while</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt; 0 )</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    {</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      iStartX = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      iStartY = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt; 1 )</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      {</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        iDist = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt;&gt;= 1;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        <span class="keywordflow">if</span> ( bRasterRefinementDiamond == 1 )</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        {</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a> ( cStruct, iStartX, iStartY, iDist, bRasterRefinementCornersForDiamondDist1 );</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a68106a08253d342623282a38b62c0fae">xTZ8PointSquareSearch</a>  ( cStruct, iStartX, iStartY, iDist );</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      }</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; </div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <span class="comment">// calculate only 2 missing points instead 8 points if cStruct.uiBestDistance == 1</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> == 1 )</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = 0;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a> != 0 )</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a7ef728d3e31f6b319e88d2f023ef92cf">xTZ2PointSearch</a>( cStruct );</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        }</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    }</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  }</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160; </div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;  <span class="comment">// star refinement</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  <span class="keywordflow">if</span> ( bStarRefinementEnable &amp;&amp; cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt; 0 )</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  {</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="keywordflow">while</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt; 0 )</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      iStartX = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      iStartY = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = 0;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a> = 0;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="keywordflow">for</span> ( iDist = 1; iDist &lt; iSearchRange + 1; iDist*=2 )</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      {</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="keywordflow">if</span> ( bStarRefinementDiamond == 1 )</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a> ( cStruct, iStartX, iStartY, iDist, bStarRefinementCornersForDiamondDist1 );</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        }</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a68106a08253d342623282a38b62c0fae">xTZ8PointSquareSearch</a>  ( cStruct, iStartX, iStartY, iDist );</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        }</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <span class="keywordflow">if</span> ( bStarRefinementStop &amp;&amp; (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> &gt;= uiStarRefinementRounds) ) <span class="comment">// stop criterion</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        }</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      }</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      <span class="comment">// calculate only 2 missing points instead 8 points if cStrukt.uiBestDistance == 1</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> == 1 )</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = 0;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a> != 0 )</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        {</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a7ef728d3e31f6b319e88d2f023ef92cf">xTZ2PointSearch</a>( cStruct );</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;        }</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      }</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    }</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;  }</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  <span class="comment">// write out best match</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> );</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  ruiSAD = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;}</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160; </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a53890dc1d8786e787c63cd6c053979ac"> 2592</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a53890dc1d8786e787c63cd6c053979ac">InterSearch::xTZSearchSelective</a>( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                                      <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>            refPicList,</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                                      <span class="keywordtype">int</span>                   iRefIdxPred,</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                                      <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp;    cStruct,</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                                      <a class="code" href="classvvenc_1_1Mv.html">Mv</a>                    &amp;rcMv,</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                                      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>            &amp;ruiSAD,</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* <span class="keyword">const</span>       pIntegerMv2Nx2NPred )</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;{</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bTestZeroVector          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bEnableRasterSearch      = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bAlwaysRasterSearch      = <span class="keyword">false</span>;  <span class="comment">// 1: BETTER but factor 15x slower</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bStarRefinementEnable    = <span class="keyword">true</span>;   <span class="comment">// enable either star refinement or raster refinement</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bStarRefinementDiamond   = <span class="keyword">true</span>;   <span class="comment">// 1 = xTZ8PointDiamondSearch   0 = xTZ8PointSquareSearch</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bStarRefinementStop      = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  <span class="keyword">const</span> uint32_t uiStarRefinementRounds   = 2;  <span class="comment">// star refinement stop X rounds after best match (must be &gt;=1)</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>  iSearchRange             = <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a>;</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>  iSearchRangeInitial      = <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a> &gt;&gt; 2;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>  uiSearchStep             = 4;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>  iMVDistThresh            = 8;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="keywordtype">int</span>   iStartX                 = 0;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;  <span class="keywordtype">int</span>   iStartY                 = 0;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  <span class="keywordtype">int</span>   iDist                   = 0;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( rcMv, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#a8666fe6595b172b6d3d8539b6e794339">divideByPowerOf2</a>(2);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160; </div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;  <span class="comment">// init TZSearchStruct</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> = 0;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> = 0;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160; </div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> );</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160; </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160; </div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  <span class="comment">// set rcMv (Median predictor) as start point and as best point</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, rcMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0, 0 );</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160; </div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  <span class="comment">// test whether zero Mv is better start point than Median predictor</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="keywordflow">if</span> ( bTestZeroVector )</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  {</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, 0, 0, 0, 0 );</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  }</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160; </div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html">SearchRange</a>&amp; sr = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">searchRange</a>;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <span class="keywordflow">if</span> ( pIntegerMv2Nx2NPred != 0 )</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  {</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> integerMv2Nx2NPred = *pIntegerMv2Nx2NPred;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( integerMv2Nx2NPred, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(),*cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a8666fe6595b172b6d3d8539b6e794339">divideByPowerOf2</a>(2);</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160; </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, integerMv2Nx2NPred.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0, 0);</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160; </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  }</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> prevMv[<a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#abf2802c95763e945c9e6f472995471e6">m_uniMvListMaxSize</a>];</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; </div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#af3247e7f9b36535efa5752aa104ecc34">m_uniMvListSize</a>; i++)</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keyword">const</span> <a class="code" href="structvvenc_1_1BlkUniMvInfo.html">BlkUniMvInfo</a>* curMvInfo = <a class="code" href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">m_BlkUniMvInfoBuffer</a>-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfoBuffer.html#a1d103df528daad4fadc350178509dbd2">getBlkUniMvInfo</a>(i);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cTmpMv = curMvInfo-&gt;<a class="code" href="structvvenc_1_1BlkUniMvInfo.html#a25405e0363e78f4d7b1670ff1710a892">uniMvs</a>[refPicList][iRefIdxPred];</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    prevMv[i] = cTmpMv;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="keywordtype">int</span> j = 0;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="keywordflow">for</span> (; j &lt; i; j++)</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    {</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      <span class="keywordflow">if</span> (cTmpMv == prevMv[j])</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      {</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    }</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="keywordflow">if</span> (j &lt; i)</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160; </div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(cTmpMv, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>);</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + (cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> * cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>) + cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160; </div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiSad = <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    uiSad += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>(cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a>);</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="keywordflow">if</span> (uiSad &lt; cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a>)</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    {</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> = uiSad;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> = cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> = cTmpMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">maximumDistortionForEarlyExit</a> = uiSad;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  {</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="comment">// set search range</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> currBestMv(cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> );</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    currBestMv &lt;&lt;= 2;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a923a81a518d0b94fca78be81c59716a6">xSetSearchRange</a>( cu, currBestMv, <a class="code" href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">m_iSearchRange</a>, sr );</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  }</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; </div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  <span class="comment">// Initial search</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <span class="keywordtype">int</span> iBestX = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <span class="keywordtype">int</span> iBestY = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <span class="keywordtype">int</span> iFirstSrchRngHorLeft    = ((iBestX - iSearchRangeInitial) &gt; sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>)   ? (iBestX - iSearchRangeInitial) : sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>;</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  <span class="keywordtype">int</span> iFirstSrchRngVerTop     = ((iBestY - iSearchRangeInitial) &gt; sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>)    ? (iBestY - iSearchRangeInitial) : sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  <span class="keywordtype">int</span> iFirstSrchRngHorRight   = ((iBestX + iSearchRangeInitial) &lt; sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>)  ? (iBestX + iSearchRangeInitial) : sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  <span class="keywordtype">int</span> iFirstSrchRngVerBottom  = ((iBestY + iSearchRangeInitial) &lt; sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a>) ? (iBestY + iSearchRangeInitial) : sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a>;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;  <span class="keywordflow">for</span> ( iStartY = iFirstSrchRngVerTop; iStartY &lt;= iFirstSrchRngVerBottom; iStartY += uiSearchStep )</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  {</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="keywordflow">for</span> ( iStartX = iFirstSrchRngHorLeft; iStartX &lt;= iFirstSrchRngHorRight; iStartX += uiSearchStep )</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    {</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, iStartX, iStartY, 0, 0 );</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a> ( cStruct, iStartX, iStartY, 1, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a> ( cStruct, iStartX, iStartY, 2, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    }</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  }</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160; </div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;  <span class="keywordtype">int</span> iMaxMVDistToPred = (abs(cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a> - iBestX) &gt; iMVDistThresh || abs(cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> - iBestY) &gt; iMVDistThresh);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160; </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="comment">//full search with early exit if MV is distant from predictors</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  <span class="keywordflow">if</span> ( bEnableRasterSearch &amp;&amp; (iMaxMVDistToPred || bAlwaysRasterSearch) )</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  {</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordflow">for</span> ( iStartY = sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>; iStartY &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">bottom</a>; iStartY += 1 )</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keywordflow">for</span> ( iStartX = sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">left</a>; iStartX &lt;= sr.<a class="code" href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">right</a>; iStartX += 1 )</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;      {</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">xTZSearchHelp</a>( cStruct, iStartX, iStartY, 0, 1 );</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  }</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <span class="comment">//Smaller MV, refine around predictor</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bStarRefinementEnable &amp;&amp; cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt; 0 )</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;  {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    <span class="comment">// start refinement</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <span class="keywordflow">while</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> &gt; 0 )</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    {</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      iStartX = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      iStartY = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = 0;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a> = 0;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      <span class="keywordflow">for</span> ( iDist = 1; iDist &lt; iSearchRange + 1; iDist*=2 )</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      {</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        <span class="keywordflow">if</span> ( bStarRefinementDiamond == 1 )</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        {</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">xTZ8PointDiamondSearch</a> ( cStruct, iStartX, iStartY, iDist, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        }</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        {</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a68106a08253d342623282a38b62c0fae">xTZ8PointSquareSearch</a>  ( cStruct, iStartX, iStartY, iDist );</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        }</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        <span class="keywordflow">if</span> ( bStarRefinementStop &amp;&amp; (cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">uiBestRound</a> &gt;= uiStarRefinementRounds) ) <span class="comment">// stop criterion</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        {</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        }</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160; </div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <span class="comment">// calculate only 2 missing points instead 8 points if cStrukt.uiBestDistance == 1</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> == 1 )</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">uiBestDistance</a> = 0;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        <span class="keywordflow">if</span> ( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">ucPointNr</a> != 0 )</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        {</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a7ef728d3e31f6b319e88d2f023ef92cf">xTZ2PointSearch</a>( cStruct );</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        }</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      }</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    }</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  }</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160; </div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;  <span class="comment">// write out best match</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a> );</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;  ruiSAD = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">uiBestSad</a> - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">getCostOfVectorWithPredictor</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">iBestX</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">iBestY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> );</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;}</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160; </div>
<div class="line"><a name="l02766"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a79bbecad33262eecb8522cc540c421ac"> 2766</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a79bbecad33262eecb8522cc540c421ac">InterSearch::xPatternSearchIntRefine</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp;  cStruct, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMv, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvPred, <span class="keywordtype">int</span>&amp; riMVPIdx, uint32_t&amp; ruiBits, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost, <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>&amp; amvpInfo, <span class="keywordtype">double</span> fWeight)</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;{</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160; </div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 0 || cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">IMV_HPEL</a> , <span class="stringliteral">&quot;xPatternSearchIntRefine(): Sub-pel MV used.&quot;</span>);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[riMVPIdx] != rcMvPred, <span class="stringliteral">&quot;xPatternSearchIntRefine(): MvPred issue.&quot;</span>);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, 0, <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bUseHADME &amp;&amp; !cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">disableSATDForRd</a>);</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  <span class="comment">// -&gt; set MV scale for cost calculation to QPEL (0)</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a> ( 0 );</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  uiDist, uiSATD = 0;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  uiBestDist  = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  <span class="comment">// subtract old MVP costs because costs for all newly tested MVPs are added in here</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  ruiBits -= <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[riMVPIdx][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160; </div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cBestMv = rcMv;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cBaseMvd[2];</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;  <span class="keywordtype">int</span> iBestBits = 0;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  <span class="keywordtype">int</span> iBestMVPIdx = riMVPIdx;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> testPos[9] = { { 0, 0}, { -1, -1},{ -1, 0},{ -1, 1},{ 0, -1},{ 0, 1},{ 1, -1},{ 1, 0},{ 1, 1} };</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160; </div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; </div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  cBaseMvd[0] = (rcMv - amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[0]);</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  cBaseMvd[1] = (rcMv - amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[1]);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( (cBaseMvd[0].hor &amp; 0x03) != 0 || (cBaseMvd[0].ver &amp; 0x03) != 0 , <span class="stringliteral">&quot;xPatternSearchIntRefine(): AMVP cand 0 Mvd issue.&quot;</span>);</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( (cBaseMvd[1].hor &amp; 0x03) != 0 || (cBaseMvd[1].ver &amp; 0x03) != 0 , <span class="stringliteral">&quot;xPatternSearchIntRefine(): AMVP cand 1 Mvd issue.&quot;</span>);</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160; </div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;  cBaseMvd[0].<a class="code" href="classvvenc_1_1Mv.html#ab1d8dda7a67461e9a09ec2c7a414a129">roundTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  cBaseMvd[1].<a class="code" href="classvvenc_1_1Mv.html#ab1d8dda7a67461e9a09ec2c7a414a129">roundTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160; </div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;  <span class="comment">// test best integer position and all 8 neighboring positions</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pos = 0; pos &lt; 9; pos ++)</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;  {</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cTestMv[2];</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    <span class="comment">// test both AMVP candidates for each position</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iMVPIdx = 0; iMVPIdx &lt; amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; iMVPIdx++)</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    {</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      cTestMv[iMVPIdx] = testPos[pos];</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      cTestMv[iMVPIdx].<a class="code" href="classvvenc_1_1Mv.html#a5e2a7bfb346728cabdb6cb45020f8ae1">changeTransPrecAmvr2Internal</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      cTestMv[iMVPIdx] += cBaseMvd[iMVPIdx];</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;      cTestMv[iMVPIdx] += amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[iMVPIdx];</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160; </div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      <span class="keywordflow">if</span> ( iMVPIdx == 0 || cTestMv[0] != cTestMv[1])</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;      {</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cTempMV = cTestMv[iMVPIdx];</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        {</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;          <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(cTempMV, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        }</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>  + cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> * (cTempMV.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt;&gt;  <a class="code" href="namespacevvenc.html#ac805e492b380b892650ee0b344b0f69e">MV_FRACTIONAL_BITS_INTERNAL</a>) + (cTempMV.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &gt;&gt; <a class="code" href="namespacevvenc.html#ac805e492b380b892650ee0b344b0f69e">MV_FRACTIONAL_BITS_INTERNAL</a>);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        uiDist = uiSATD = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>) (<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>( <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a> ) * fWeight);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      }</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      {</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        uiDist = uiSATD;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      }</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160; </div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <span class="keywordtype">int</span> iMvBits = <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[iMVPIdx][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[iMVPIdx];</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      pred.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>( pred );</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = cTestMv[iMVPIdx];</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      mv.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      iMvBits += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>( mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0 );</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      uiDist += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(iMvBits);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160; </div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      <span class="keywordflow">if</span> (uiDist &lt; uiBestDist)</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      {</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        uiBestDist = uiDist;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        cBestMv = cTestMv[iMVPIdx];</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        iBestMVPIdx = iMVPIdx;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        iBestBits = iMvBits;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;      }</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    }</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  }</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <span class="keywordflow">if</span>( uiBestDist == <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a> )</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    ruiCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  }</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160; </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  rcMv = cBestMv;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  rcMvPred = amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[iBestMVPIdx];</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  riMVPIdx = iBestMVPIdx;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>( rcMvPred );</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  ruiBits += iBestBits;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <span class="comment">// taken from JEM 5.0</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  <span class="comment">// verify since it makes no sence to subtract Lamda*(Rmvd+Rmvpidx) from D+Lamda(Rmvd)</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <span class="comment">// this would take the rate for the MVP idx out of the cost calculation</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="comment">// however this rate is always 1 so impact is small</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  ruiCost = uiBestDist - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(iBestBits) + <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(ruiBits);</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  <span class="comment">// taken from JEM 5.0</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="comment">// verify since it makes no sense to add rate for MVDs twicce</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160; </div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;}</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a3adb61022e07cfeb1c5112be359930d4"> 2864</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a3adb61022e07cfeb1c5112be359930d4">InterSearch::xPatternSearchFracDIF</a>(</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>            refPicList,</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  <span class="keywordtype">int</span>                   iRefIdx,</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp;    cStruct,</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp;             rcMvInt,</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp;                   rcMvHalf,</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp;                   rcMvQter,</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp;           ruiCost</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;)</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;{</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  <a class="code" href="TimeProfiler_8h.html#a48e5ee72e953901b1aeca5200b1f751c">PROFILER_SCOPE_AND_STAGE</a>( 0, g_timeProfiler, P_FRAC_PEL );</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160; </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  <span class="comment">//  Reference pattern initialization (integer scale)</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  <span class="keywordtype">int</span>         iOffset    = rcMvInt.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> + rcMvInt.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> * cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> cPatternRoi(cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + iOffset, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160; </div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  <span class="comment">//  Half-pel refinement</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(1);</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <span class="keywordflow">if</span>( 0 == <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastSubPel )</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a4fbc68d90894a76141760cf4b61c21ba">xExtDIFUpSamplingH</a>( &amp;cPatternRoi, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a3d559b877ba707a765a8152b4cb2ad59">useAltHpelIf</a> );</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;  }</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160; </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  rcMvHalf = rcMvInt;   rcMvHalf &lt;&lt;= 1;    <span class="comment">// for mv-cost</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> baseRefMv(0, 0);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  uiDistBest = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;  <span class="keywordtype">int</span> patternId = 41;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  ruiCost = <a class="code" href="classvvenc_1_1InterSearch.html#a44ef45706c20f722aef32216629c45a3">xPatternRefinement</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, baseRefMv, 2, rcMvHalf, ( !cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">disableSATDForRd</a> ), uiDistBest, patternId, &amp;cPatternRoi, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a3d559b877ba707a765a8152b4cb2ad59">useAltHpelIf</a> );</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  patternId -= ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastSubPel == 1 ? 41 : 0 );</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; </div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="comment">//  quarter-pel refinement</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <span class="keywordflow">if</span>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a0be33e739219b0a4aeb18a73315f38e4">IMV_OFF</a> &amp;&amp; 0 != patternId )</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  {</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <a class="code" href="TimeProfiler_8h.html#a48e5ee72e953901b1aeca5200b1f751c">PROFILER_SCOPE_AND_STAGE</a>( 0, g_timeProfiler, P_QPEL );</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>( 0 );</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af96f9b73b3e97111a195da4a3f210558">xExtDIFUpSamplingQ</a>( &amp;cPatternRoi, rcMvHalf, patternId );</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    baseRefMv = rcMvHalf;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    baseRefMv &lt;&lt;= 1;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160; </div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    rcMvQter = rcMvInt;    rcMvQter &lt;&lt;= 1;    <span class="comment">// for mv-cost</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    rcMvQter += rcMvHalf;  rcMvQter &lt;&lt;= 1;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    ruiCost = <a class="code" href="classvvenc_1_1InterSearch.html#a44ef45706c20f722aef32216629c45a3">xPatternRefinement</a>( cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, baseRefMv, 1, rcMvQter, ( !cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">disableSATDForRd</a> ), uiDistBest, patternId, &amp;cPatternRoi, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a3d559b877ba707a765a8152b4cb2ad59">useAltHpelIf</a> );</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;  }</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160; </div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;}</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160; </div>
<div class="line"><a name="l02912"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#af53c99ea0459bcfb52dcf7795770cedb"> 2912</a></span>&#160;<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> <a class="code" href="classvvenc_1_1InterSearch.html#af53c99ea0459bcfb52dcf7795770cedb">InterSearch::xGetSymCost</a>( <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> eCurRefPicList, <span class="keyword">const</span> <a class="code" href="structvvenc_1_1MvField.html">MvField</a>&amp; cCurMvField, <a class="code" href="structvvenc_1_1MvField.html">MvField</a>&amp; cTarMvField, <span class="keywordtype">int</span> BcwIdx )</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;{</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> cost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> eTarRefPicList = (<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>)(1 - (<span class="keywordtype">int</span>)eCurRefPicList);</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  <span class="comment">// get prediction of eCurRefPicList</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>  predBufA  = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[eCurRefPicList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* picRefA = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>( eCurRefPicList, cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a> );</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvA = cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( mvA, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ac5bedb7997fc561b55c47c2f1713bb59">xPredInterBlk</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, picRefA, mvA, predBufA, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> ], <span class="keyword">false</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160; </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  <span class="comment">// get prediction of eTarRefPicList</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufB = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[eTarRefPicList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* picRefB = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>( eTarRefPicList, cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a> );</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvB = cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( mvB, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ac5bedb7997fc561b55c47c2f1713bb59">xPredInterBlk</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, picRefB, mvB, predBufB, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> ], <span class="keyword">false</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> bufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( <a class="code" href="structvvenc_1_1UnitAreaRelative.html">UnitAreaRelative</a>( cu, cu ) );</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  bufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#ae234f3d4d1911a5f0e1b61a5425c320f">copyFrom</a>( origBuf );</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  bufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#af907ad3e49a30f4c2990626baf9bde6a">removeHighFreq</a>( predBufA, <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bClipForBiPredMeEnabled, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a><span class="comment">/*, getBcwWeight( cu.BcwIdx, eTarRefPicList )*/</span> );</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;  <span class="keywordtype">double</span> fWeight = <a class="code" href="classvvenc_1_1InterSearch.html#a38fa18d30e9c51ef390aa273da0f2cc5">xGetMEDistortionWeight</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a>, eTarRefPicList );</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160; </div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  <span class="comment">// calc distortion</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8">DFunc</a> distFunc = ( !cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">disableSATDForRd</a> ) ? <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8ac99f51755fff111dd7d5448a23cdd996">DF_HAD</a> : <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4f3ad87be4ac3fc12e60590dda8bf974">DF_SAD</a>;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  cost = ( <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> ) floor( fWeight * ( <span class="keywordtype">double</span> ) <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>( bufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), predBufB.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a> ], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, distFunc ) );</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160; </div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  <span class="keywordflow">return</span>(cost);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;}</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160; </div>
<div class="line"><a name="l02943"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a0add32f416fb3fc9393a688e7fb27c15"> 2943</a></span>&#160;<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> <a class="code" href="classvvenc_1_1InterSearch.html#a0add32f416fb3fc9393a688e7fb27c15">InterSearch::xSymRefineMvSearch</a>( <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvCurPred, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvTarPred, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <a class="code" href="structvvenc_1_1MvField.html">MvField</a>&amp; rCurMvField, </div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                                            <a class="code" href="structvvenc_1_1MvField.html">MvField</a>&amp; rTarMvField, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiMinCost, <span class="keywordtype">int</span> SearchPattern, <span class="keywordtype">int</span> nSearchStepShift, uint32_t uiMaxSearchRounds, <span class="keywordtype">int</span> BcwIdx )</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;{</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvSearchOffsetCross[4] = { <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 0 , 1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 , 0 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 0 , -1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 ,  0 ) };</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvSearchOffsetSquare[8] = { <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 , 1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 0 , 1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 ,  1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 ,  0 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 , -1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 0 , -1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 , -1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 , 0 ) };</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvSearchOffsetDiamond[8] = { <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 0 , 2 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 , 1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 2 ,  0 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 , -1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 0 , -2 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 , -1 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -2 ,  0 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 , 1 ) };</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvSearchOffsetHexagon[6] = { <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 2 , 0 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 , 2 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 ,  2 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -2 ,  0 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( -1 , -2 ) , <a class="code" href="classvvenc_1_1Mv.html">Mv</a>( 1 , -2 ) };</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160; </div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  <span class="keywordtype">int</span> nDirectStart = 0, nDirectEnd = 0, nDirectRounding = 0, nDirectMask = 0;</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a> * pSearchOffset;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  <span class="keywordflow">if</span> ( SearchPattern == 0 )</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  {</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    nDirectEnd = 3;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    nDirectRounding = 4;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    nDirectMask = 0x03;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    pSearchOffset = mvSearchOffsetCross;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  }</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( SearchPattern == 1 )</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  {</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    nDirectEnd = 7;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    nDirectRounding = 8;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    nDirectMask = 0x07;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    pSearchOffset = mvSearchOffsetSquare;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;  }</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( SearchPattern == 2 )</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;  {</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    nDirectEnd = 7;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    nDirectRounding = 8;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    nDirectMask = 0x07;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    pSearchOffset = mvSearchOffsetDiamond;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;  }</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( SearchPattern == 3 )</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;  {</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    nDirectEnd = 5;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    pSearchOffset = mvSearchOffsetHexagon;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;  }</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  {</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <a class="code" href="StatCounter_8h.html#a27264efd631c4f584ddcb2f5888ae6ed">THROW</a>( <span class="stringliteral">&quot;Invalid search pattern&quot;</span> );</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  }</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160; </div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  <span class="keywordtype">int</span> nBestDirect;</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;  <span class="keywordflow">for</span> ( uint32_t uiRound = 0; uiRound &lt; uiMaxSearchRounds; uiRound++ )</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;  {</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> roundZeroBestCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> positionLut[ 8 ] = { 0, 2, 4, 6, 1, 3, 5, 7 };</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    nBestDirect = -1;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    <a class="code" href="structvvenc_1_1MvField.html">MvField</a> mvCurCenter = rCurMvField;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> nIdx = nDirectStart; nIdx &lt;= nDirectEnd; nIdx++ )</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    {</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="comment">// terminate the search if none of the first four tested points hasn&#39;t provided improvement</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_SMVD &gt; 1 &amp;&amp; 2 == SearchPattern &amp;&amp; 0 == uiRound &amp;&amp; 4 == nIdx &amp;&amp; roundZeroBestCost &gt; uiMinCost )</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      {</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      }</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      <span class="keywordtype">int</span> nDirect;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      <span class="keywordflow">if</span> ( SearchPattern == 3 )</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      {</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        nDirect = nIdx &lt; 0 ? nIdx + 6 : nIdx &gt;= 6 ? nIdx - 6 : nIdx;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;      }</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      {</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_SMVD &gt; 1 &amp;&amp; 2 == SearchPattern &amp;&amp; 0 == uiRound )</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        {</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;          nDirect = positionLut[ ( nIdx + nDirectRounding ) &amp; nDirectMask ];</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        }</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        {</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;          nDirect = ( nIdx + nDirectRounding ) &amp; nDirectMask;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        }</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160; </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvOffset = pSearchOffset[nDirect];</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      mvOffset &lt;&lt;= nSearchStepShift;</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <a class="code" href="structvvenc_1_1MvField.html">MvField</a> mvCand = mvCurCenter, mvPair;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      mvCand.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a> += mvOffset;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      <span class="comment">// get MVD cost</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = rcMvCurPred;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      pred.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>( pred );</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>( 0 );</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = mvCand.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      mv.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      uint32_t uiMvBits = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>( mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0 );</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>( uiMvBits );</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160; </div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      <span class="comment">// get MVD pair and set target MV</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      mvPair.refIdx = rTarMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      mvPair.mv.set( rcMvTarPred.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> - (mvCand.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> - rcMvCurPred.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>), rcMvTarPred.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> - (mvCand.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> - rcMvCurPred.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>) );</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      uiCost += <a class="code" href="classvvenc_1_1InterSearch.html#af53c99ea0459bcfb52dcf7795770cedb">xGetSymCost</a>( cu, origBuf, refPicList, mvCand, mvPair, BcwIdx );</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      <span class="keywordflow">if</span> ( uiCost &lt; uiMinCost )</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      {</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        uiMinCost = uiCost;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        rCurMvField = mvCand;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        rTarMvField = mvPair;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        nBestDirect = nDirect;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      }</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_SMVD &gt; 1 &amp;&amp; 2 == SearchPattern &amp;&amp; 0 == uiRound &amp;&amp; 4 &gt; nIdx &amp;&amp; uiCost &lt; roundZeroBestCost)</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      {</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;        roundZeroBestCost = uiCost;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      }</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    }</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160; </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <span class="keywordflow">if</span> ( nBestDirect == -1 )</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    {</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    }</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <span class="keywordtype">int</span> nStep = 1;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <span class="keywordflow">if</span>( (SearchPattern == 1 || SearchPattern == 2) &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_SMVD &lt;= 1 )</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    {</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="comment">// test at most 3 points in fast presets</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;      nStep = 2 - ( nBestDirect &amp; 0x01 );</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    }</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    nDirectStart = nBestDirect - nStep;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    nDirectEnd = nBestDirect + nStep;</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  }</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; </div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  <span class="keywordflow">return</span>(uiMinCost);</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;}</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; </div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160; </div>
<div class="line"><a name="l03065"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aaf529386910fa2161fa63a3f71657e07"> 3065</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#aaf529386910fa2161fa63a3f71657e07">InterSearch::xSymMotionEstimation</a>( <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvCurPred, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvTarPred, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <a class="code" href="structvvenc_1_1MvField.html">MvField</a>&amp; rCurMvField, <a class="code" href="structvvenc_1_1MvField.html">MvField</a>&amp; rTarMvField, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost, <span class="keywordtype">int</span> BcwIdx )</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;{</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="comment">// Refine Search</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  <span class="keywordtype">int</span> nSearchStepShift = <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;  <span class="keywordtype">int</span> nDiamondRound = 8;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;  <span class="keywordtype">int</span> nCrossRound = 1;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160; </div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  nSearchStepShift += cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">IMV_HPEL</a> ? 1 : (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> &lt;&lt; 1);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  nDiamondRound &gt;&gt;= cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160; </div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;  ruiCost = <a class="code" href="classvvenc_1_1InterSearch.html#a0add32f416fb3fc9393a688e7fb27c15">xSymRefineMvSearch</a>( cu, origBuf, rcMvCurPred, rcMvTarPred, refPicList, rCurMvField, rTarMvField, ruiCost, 2, nSearchStepShift, nDiamondRound, BcwIdx );</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_SMVD &lt; 3 )</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  {</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    ruiCost = <a class="code" href="classvvenc_1_1InterSearch.html#a0add32f416fb3fc9393a688e7fb27c15">xSymRefineMvSearch</a>( cu, origBuf, rcMvCurPred, rcMvTarPred, refPicList, rCurMvField, rTarMvField, ruiCost, 0, nSearchStepShift, nCrossRound, BcwIdx );</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  }</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;}</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160; </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a4fbc68d90894a76141760cf4b61c21ba"> 3089</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a4fbc68d90894a76141760cf4b61c21ba">InterSearch::xExtDIFUpSamplingH</a>(<a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>* pattern, <span class="keywordtype">bool</span> useAltHpelIf)</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;{</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  <a class="code" href="TimeProfiler_8h.html#a48e5ee72e953901b1aeca5200b1f751c">PROFILER_SCOPE_AND_STAGE</a>( 0, g_timeProfiler, P_HPEL_INTERP );</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1ClpRng.html">ClpRng</a>&amp; clpRng = <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <span class="keywordtype">int</span> width      = pattern-&gt;<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a>;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="keywordtype">int</span> height     = pattern-&gt;<a class="code" href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">height</a>;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  <span class="keywordtype">int</span> srcStride  = pattern-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160; </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <span class="keywordtype">int</span> intStride = width + 1;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  <span class="keywordtype">int</span> dstStride = width + 1;</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* intPtr;</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* dstPtr;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  <span class="keywordtype">int</span> filterSize = <a class="code" href="namespacevvenc.html#af34252cbb46dcf09730e3ab02321ee15">NTAPS_LUMA</a>;</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <span class="keywordtype">int</span> halfFilterSize = (filterSize&gt;&gt;1);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* srcPtr = pattern-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> - halfFilterSize*srcStride - 1;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160; </div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  <span class="keyword">const</span> <a class="code" href="TypeDef_8h.html#a70dfa957a71cae40f75782ea972c130e">ChromaFormat</a> chFmt = <a class="code" href="classvvenc_1_1InterPrediction.html#a9ddbb02a220623fa10f87e6f751e77e6">m_currChromaFormat</a>;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160; </div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr,         srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[0][0]        , intStride, width, height + filterSize, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr + width, srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[0][0] + width, intStride,     1, height + filterSize, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr,         srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[2][0],         intStride, width, height + filterSize, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr + width, srcStride, <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[2][0] + width, intStride,     1, height + filterSize, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160; </div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[0][0] + halfFilterSize * intStride + 1;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[0][0][0];</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width + 0, height + 0, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf);</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160; </div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;  intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[0][0] + (halfFilterSize - 1) * intStride + 1;</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;  dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[2][0][0];</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width + 0, height + 1, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf);</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160; </div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[2][0] + halfFilterSize * intStride;</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[0][2][0];</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr,         intStride, dstPtr,         dstStride, width, height + 0, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr + width, intStride, dstPtr + width, dstStride,     1, height + 0, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160; </div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[2][0] + (halfFilterSize - 1) * intStride;</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;  dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[2][2][0];</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;  <span class="comment">// split the prediction with funny widths into power-of-2 and +1 parts for the sake of SIMD speed-up</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr,         intStride, dstPtr,         dstStride, width, height + 1, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr + width, intStride, dstPtr + width, dstStride,     1, height + 1, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng, useAltHpelIf );</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;}</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160; </div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160; </div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160; </div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160; </div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160; </div>
<div class="line"><a name="l03147"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#af96f9b73b3e97111a195da4a3f210558"> 3147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#af96f9b73b3e97111a195da4a3f210558">InterSearch::xExtDIFUpSamplingQ</a>( <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>* pattern, <a class="code" href="classvvenc_1_1Mv.html">Mv</a> halfPelRef, <span class="keywordtype">int</span>&amp; patternId )</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;{</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  <a class="code" href="TimeProfiler_8h.html#a48e5ee72e953901b1aeca5200b1f751c">PROFILER_SCOPE_AND_STAGE</a>( 0, g_timeProfiler, P_QPEL_INTERP );</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1ClpRng.html">ClpRng</a>&amp; clpRng = <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>;</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;  <span class="keywordtype">int</span> width      = pattern-&gt;<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a>;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  <span class="keywordtype">int</span> height     = pattern-&gt;<a class="code" href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">height</a>;</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;  <span class="keywordtype">int</span> srcStride  = pattern-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160; </div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a> <span class="keyword">const</span>* srcPtr;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;  <span class="keywordtype">int</span> intStride = width + 1;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <span class="keywordtype">int</span> dstStride = width + 1;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* intPtr;</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* dstPtr;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;  <span class="keywordtype">int</span> filterSize = <a class="code" href="namespacevvenc.html#af34252cbb46dcf09730e3ab02321ee15">NTAPS_LUMA</a>;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160; </div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  <span class="keywordtype">int</span> halfFilterSize = (filterSize&gt;&gt;1);</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160; </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  <span class="keywordtype">int</span> extHeight = (halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> == 0) ? height + filterSize : height + filterSize-1;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160; </div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  <span class="keyword">const</span> <a class="code" href="TypeDef_8h.html#a70dfa957a71cae40f75782ea972c130e">ChromaFormat</a> chFmt = <a class="code" href="classvvenc_1_1InterPrediction.html#a9ddbb02a220623fa10f87e6f751e77e6">m_currChromaFormat</a>;</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160; </div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 12 ] )</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  {</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    <span class="comment">// Horizontal filter 1/4</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    srcPtr = pattern-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> - halfFilterSize * srcStride - 1;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 1 ][ 0 ];</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt; 0 )</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;      srcPtr += srcStride;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    }</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &gt;= 0 )</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    {</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      srcPtr += 1;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    }</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr, srcStride, intPtr, intStride, width, extHeight, 1 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  }</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160; </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 13 ] )</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;  {</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <span class="comment">// Horizontal filter 3/4</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    srcPtr = pattern-&gt;<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> - halfFilterSize*srcStride - 1;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 3 ][ 0 ];</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt; 0 )</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    {</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;      srcPtr += srcStride;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &gt; 0 )</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      srcPtr += 1;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    }</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">filterHor</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, srcPtr, srcStride, intPtr, intStride, width, extHeight, 3 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;  }</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160; </div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 3 ] )</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;  {</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="comment">// Generate @ 1,1</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 1 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 1 ][ 1 ][ 0 ];</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> == 0 )</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      intPtr += intStride;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    }</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 1 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  }</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160; </div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 11 ] )</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  {</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="comment">// Generate @ 3,3</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 3 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 3 ][ 3 ][ 0 ];</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 3 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;  }</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160; </div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 5 ] )</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  {</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="comment">// Generate @ 3,1</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 1 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 3 ][ 1 ][ 0 ];</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 3 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  }</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160; </div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 9 ] )</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;  {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="comment">// Generate @ 1,3</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 3 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 1 ][ 3 ][ 0 ];</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> == 0 )</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    {</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      intPtr += intStride;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    }</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 1 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;  }</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160; </div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;  <span class="keywordflow">if</span> (halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> != 0)</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;  {</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 4 ] )</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;    {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;      <span class="comment">// Generate @ 2,1</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 1 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 2 ][ 1 ][ 0 ];</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> == 0 )</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;      {</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        intPtr += intStride;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;      }</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    }</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160; </div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 10 ] )</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;    {</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      <span class="comment">// Generate @ 2,3</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 3 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 2 ][ 3 ][ 0 ];</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> == 0 )</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;      {</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;        intPtr += intStride;</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;      }</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 2 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    }</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  }</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  {</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 2 ] )</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    {</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;      <span class="comment">// Generate @ 0,1</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 1 ][ 0 ] + halfFilterSize * intStride;</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 0 ][ 1 ][ 0 ];</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    }</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 8 ] )</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    {</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      <span class="comment">// Generate @ 0,3</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 3 ][ 0 ] + halfFilterSize * intStride;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 0 ][ 3 ][ 0 ];</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 0 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    }</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  }</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160; </div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;  <span class="keywordflow">if</span> (halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> != 0)</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  {</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 6 ] )</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    {</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      <span class="comment">// Generate @ 1,2</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 2 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 1 ][ 2 ][ 0 ];</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &gt; 0 )</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      {</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;        intPtr += 1;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;      }</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt;= 0 )</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      {</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        intPtr += intStride;</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;      }</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 1 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    }</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160; </div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 7 ] )</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    {</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      <span class="comment">// Generate @ 3,2</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 2 ][ 0 ] + ( halfFilterSize - 1 ) * intStride;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 3 ][ 2 ][ 0 ];</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &gt; 0 )</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      {</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        intPtr += 1;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      }</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt; 0 )</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;      {</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        intPtr += intStride;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 3 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    }</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  }</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 0 ] )</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    {</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      <span class="comment">// Generate @ 1,0</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 0 ][ 0 ] + ( halfFilterSize - 1 ) * intStride + 1;</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 1 ][ 0 ][ 0 ];</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt;= 0 )</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      {</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        intPtr += intStride;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;      }</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 1 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    }</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160; </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">s_doInterpQ</a>[ patternId ][ 1 ] )</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    {</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="comment">// Generate @ 3,0</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      intPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">m_filteredBlockTmp</a>[ 0 ][ 0 ] + ( halfFilterSize - 1 ) * intStride + 1;</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;      dstPtr = <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">m_filteredBlock</a>[ 3 ][ 0 ][ 0 ];</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      <span class="keywordflow">if</span>( halfPelRef.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt; 0 )</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      {</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        intPtr += intStride;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;      }</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">m_if</a>.<a class="code" href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">filterVer</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, intPtr, intStride, dstPtr, dstStride, width, height, 3 &lt;&lt; <a class="code" href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">MV_FRACTIONAL_BITS_DIFF</a>, <span class="keyword">false</span>, <span class="keyword">true</span>, chFmt, clpRng );</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    }</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  }</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;}</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160; </div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a23a6f1ead4939bc6154475ae86dda34b"> 3348</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a23a6f1ead4939bc6154475ae86dda34b">InterSearch::xEncodeInterResidualQT</a>(<a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> &amp;cs, <a class="code" href="classvvenc_1_1Partitioner.html">Partitioner</a> &amp;partitioner, <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID)</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;{</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1UnitArea.html">UnitArea</a>&amp; currArea    = partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a979d8cb627dcb558d29ff7f0a14de0a1">currArea</a>();</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1TransformUnit.html">TransformUnit</a>&amp; currTU = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#aae3934300792aab8eab2a4a906952424">getTU</a>(<a class="code" href="namespacevvenc.html#ac5289e15fcc41d93fc27a1efcde294d2">isLuma</a>(partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>) ? currArea.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>() : currArea.<a class="code" href="structvvenc_1_1UnitArea.html#adbbe87f880e5fcea67153030935e047a">chromaPos</a>(), partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>);</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a> &amp;cu        = *currTU.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>;</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> currDepth    = partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a11a11dea891ee137a4a756ba94caaed1">currTrDepth</a>;</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160; </div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> bSubdiv          = currDepth != currTU.<a class="code" href="structvvenc_1_1TransformUnit.html#ab6f276082172be43a6041212071e377b">depth</a>;</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160; </div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;  <span class="keywordflow">if</span> (compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa555c470c9fade36f4bc57231923c0517">MAX_NUM_TBLOCKS</a>)  <span class="comment">// we are not processing a channel, instead we always recurse and code the CBFs</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;  {</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keywordflow">if</span>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d">TU_MAX_TR_SPLIT</a>, cs ) )</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    {</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( !bSubdiv, <span class="stringliteral">&quot;Not performing the implicit TU split&quot;</span> );</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    }</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> &amp;&amp; partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc_1_1CU.html#a10639af982cbc58394e930bae8f96d56">CU::getSbtTuSplit</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> ), cs ) )</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( !bSubdiv, <span class="stringliteral">&quot;Not performing the implicit TU split - sbt&quot;</span> );</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    }</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    {</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( bSubdiv, <span class="stringliteral">&quot;transformsplit not supported&quot;</span> );</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;    }</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160; </div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(<a class="code" href="namespacevvenc_1_1CU.html#ab722b39b132601673d1dcd3547c2c01c">CU::isIntra</a>(cu), <span class="stringliteral">&quot;Inter search provided with intra CU&quot;</span>);</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160; </div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a> != <a class="code" href="TypeDef_8h.html#a1644a589f6466e6ce533230a841fc96a">CHROMA_400</a></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      &amp;&amp; (!<a class="code" href="namespacevvenc_1_1CU.html#a9dba2390376b36d2a779733a99663842">CU::isSepTree</a>(cu) || <a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>(partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>))</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;      )</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    {</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;      {</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;        {</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span>  chroma_cbf = <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>, currDepth );</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;          <span class="keywordflow">if</span> (!(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> &amp;&amp; (currDepth == 0 || (currDepth == 1 &amp;&amp; currTU.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a>))))</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>( cu, chroma_cbf, currArea.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>], currDepth );</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        }</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;        {</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span>  chroma_cbf = <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>, currDepth );</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;          <span class="keywordflow">if</span> (!(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> &amp;&amp; (currDepth == 0 || (currDepth == 1 &amp;&amp; currTU.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a>))))</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>( cu, chroma_cbf, currArea.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>], currDepth, <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>, currDepth ) );</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;        }</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      }</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    }</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160; </div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    <span class="keywordflow">if</span>( !bSubdiv &amp;&amp; !( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> &amp;&amp; currTU.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a> )</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;      &amp;&amp; !<a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>(partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>)</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;      )</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;    {</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>( cu, <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, currDepth ), currArea.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>(), currDepth );</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    }</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  }</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160; </div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  <span class="keywordflow">if</span> (!bSubdiv)</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;  {</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    <span class="keywordflow">if</span> (compID != <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa555c470c9fade36f4bc57231923c0517">MAX_NUM_TBLOCKS</a>) <span class="comment">// we have already coded the CBFs, so now we code coefficients</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    {</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;      <span class="keywordflow">if</span>( currArea.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].valid() )</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        <span class="keywordflow">if</span>( compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> )</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        {</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> cbfMask = ( <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> ) ? 2 : 0) + ( <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ) ? 1 : 0 );</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a1d7e220147dfc5222b5c0e380ee9e734">joint_cb_cr</a>( currTU, cbfMask );</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        }</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>( currTU, compID ) )</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        {</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#acc2b42675b2a7422042407b224435ac7">residual_coding</a>( currTU, compID );</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        }</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;      }</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    }</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;  }</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;  {</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    <span class="keywordflow">if</span>( compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa555c470c9fade36f4bc57231923c0517">MAX_NUM_TBLOCKS</a> || <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( currTU, compID, currDepth ) )</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;    {</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      <span class="keywordflow">if</span>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d">TU_MAX_TR_SPLIT</a>, cs ) )</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;      {</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;        partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a7d54121d05bf25e1dcf3127b87ed43e8">splitCurrArea</a>( <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d">TU_MAX_TR_SPLIT</a>, cs );</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      }</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> &amp;&amp; partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc_1_1CU.html#a10639af982cbc58394e930bae8f96d56">CU::getSbtTuSplit</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> ), cs ) )</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;        partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a7d54121d05bf25e1dcf3127b87ed43e8">splitCurrArea</a>( <a class="code" href="namespacevvenc_1_1CU.html#a10639af982cbc58394e930bae8f96d56">CU::getSbtTuSplit</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> ), cs );</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;      }</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;        <a class="code" href="StatCounter_8h.html#a27264efd631c4f584ddcb2f5888ae6ed">THROW</a>( <span class="stringliteral">&quot;Implicit TU split not available!&quot;</span> );</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160; </div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      {</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a23a6f1ead4939bc6154475ae86dda34b">xEncodeInterResidualQT</a>( cs, partitioner, compID );</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      } <span class="keywordflow">while</span>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#acfc0e74841898a7fcb4981551881b552">nextPart</a>( cs ) );</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160; </div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a959a14b1ba27b7cc28352007af5eafe7">exitCurrSplit</a>();</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;    }</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;  }</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;}</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160; </div>
<div class="line"><a name="l03443"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ae10e385d23d8c4126831cd7bd566bcbc"> 3443</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#ae10e385d23d8c4126831cd7bd566bcbc">InterSearch::xCalcMinDistSbt</a>( <a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> &amp;cs, <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <span class="keyword">const</span> uint8_t sbtAllowed )</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;{</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;  <span class="keywordflow">if</span>( !sbtAllowed )</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;  {</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] = 0;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> comp = 0; comp &lt; <a class="code" href="namespacevvenc.html#aaef1d69143f174b210e402096fdec398">getNumberValidTBlocks</a>( *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> ); comp++ )</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    {</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>( comp );</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> pred = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>( compID );</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> org  = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>( compID );</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>( org, pred, cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>( compID ) ], compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">DF_SSE</a> );</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;    }</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  }</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; </div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  <span class="comment">//SBT fast algorithm 2.1 : estimate a minimum RD cost of a SBT mode based on the luma distortion of uncoded part and coded part (assuming distorted can be reduced to 1/16);</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;  <span class="comment">//                         if this cost is larger than the best cost, no need to try a specific SBT mode</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;  <span class="keywordtype">int</span> cuWidth  = cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>();</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;  <span class="keywordtype">int</span> cuHeight = cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>();</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  <span class="keywordtype">int</span> numPartX = cuWidth  &gt;= 16 ? 4 : ( cuWidth  == 4 ? 1 : 2 );</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  <span class="keywordtype">int</span> numPartY = cuHeight &gt;= 16 ? 4 : ( cuHeight == 4 ? 1 : 2 );</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> dist[4][4];</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;  memset( dist, 0, <span class="keyword">sizeof</span>( <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> ) * 16 );</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160; </div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  <span class="keywordflow">for</span>( uint32_t c = 0; c &lt; <a class="code" href="namespacevvenc.html#aaef1d69143f174b210e402096fdec398">getNumberValidTBlocks</a>( *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> ); c++ )</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;  {</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID   = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>( c );</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CompArea.html">CompArea</a>&amp;   compArea = cu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID];</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> orgPel  = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>( compArea );</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> predPel = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>( compArea );</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    <span class="keywordtype">int</span> lengthX = compArea.<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a> / numPartX;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    <span class="keywordtype">int</span> lengthY = compArea.<a class="code" href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">height</a> / numPartY;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <span class="keywordtype">int</span> strideOrg  = orgPel.<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    <span class="keywordtype">int</span> stridePred = predPel.<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    uint32_t   uiShift = <a class="code" href="TypeDef_8h.html#a29d5c9e713ec90b037a5aaa3865ccfa9">DISTORTION_PRECISION_ADJUSTMENT</a>( ( *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>( compID ) ] - 8 ) &lt;&lt; 1 );</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <a class="code" href="namespacevvenc.html#a19c81c236ede05b64eae8326f68aaa00">Intermediate_Int</a> iTemp;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160; </div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    <span class="comment">//calc distY of 16 sub parts</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; numPartY; j++ )</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    {</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; numPartX; i++ )</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;      {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        <span class="keywordtype">int</span> posX = i * lengthX;</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        <span class="keywordtype">int</span> posY = j * lengthY;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* ptrOrg  = orgPel.<a class="code" href="structvvenc_1_1AreaBuf.html#a2e1dc15633648502db33304d40ba91df">bufAt</a>( posX, posY );</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* ptrPred = predPel.<a class="code" href="structvvenc_1_1AreaBuf.html#a2e1dc15633648502db33304d40ba91df">bufAt</a>( posX, posY );</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiSum = 0;</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> n = 0; n &lt; lengthY; n++ )</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;        {</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;          <span class="keywordflow">for</span>( <span class="keywordtype">int</span> m = 0; m &lt; lengthX; m++ )</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;          {</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;            iTemp = ptrOrg[m] - ptrPred[m];</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;            uiSum += <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>( ( iTemp * iTemp ) &gt;&gt; uiShift );</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;          }</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;          ptrOrg += strideOrg;</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;          ptrPred += stridePred;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;        }</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>( compID ) )</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;        {</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;          uiSum = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>)( uiSum * <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac6a8561b7d9b7867c09f54438aad305a">getChromaWeight</a>() );</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        }</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        dist[j][i] += uiSum;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      }</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    }</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;  }</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160; </div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  <span class="comment">//SSE of a CU</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] = 0;</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; numPartY; j++ )</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;  {</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; numPartX; i++ )</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    {</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] += dist[j][i];</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    }</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;  }</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;  <span class="comment">//init per-mode dist</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7be139e95d2f0c3a60ecc5c654609f18">SBT_VER_H0</a>; i &lt; <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>; i++ )</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;  {</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[i] = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;  }</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160; </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;  <span class="comment">//SBT fast algorithm 1: not try SBT if the residual is too small to compensate bits for encoding residual info</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;  uint64_t minNonZeroResiFracBits = 12 &lt;&lt; <a class="code" href="namespacevvenc.html#abec647b6cf94dcd6aa9ce4d5fba1ee82">SCALE_BITS</a>;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( 0, <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] ) &lt; <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( minNonZeroResiFracBits, 0 ) )</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;  {</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ab129abe12f06cef41d20e46b18c69d70">m_skipSbtAll</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  }</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160; </div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;  <span class="comment">//derive estimated minDist of SBT = zero-residual part distortion + non-zero residual part distortion / 16</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;  <span class="keywordtype">int</span> shift = 5;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> distResiPart = 0, distNoResiPart = 0;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160; </div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090afa1fb9ec8d0ac776c8feafb4d5bd404e">SBT_VER_HALF</a>, sbtAllowed ) )</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;  {</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    <span class="keywordtype">int</span> offsetResiPart = 0;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    <span class="keywordtype">int</span> offsetNoResiPart = numPartX / 2;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    distResiPart = distNoResiPart = 0;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    assert( numPartX &gt;= 2 );</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; numPartY; j++ )</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    {</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; numPartX / 2; i++ )</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;      {</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;        distResiPart   += dist[j][i + offsetResiPart];</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        distNoResiPart += dist[j][i + offsetNoResiPart];</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      }</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    }</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7be139e95d2f0c3a60ecc5c654609f18">SBT_VER_H0</a>] = ( distResiPart &gt;&gt; shift ) + distNoResiPart;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88aae67f3784a4fc379f6de1e051d033877">SBT_VER_H1</a>] = ( distNoResiPart &gt;&gt; shift ) + distResiPart;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;  }</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160; </div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a2e0ddb9e99d386c945eee355baa5ebff">SBT_HOR_HALF</a>, sbtAllowed ) )</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;  {</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    <span class="keywordtype">int</span> offsetResiPart = 0;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    <span class="keywordtype">int</span> offsetNoResiPart = numPartY / 2;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    assert( numPartY &gt;= 2 );</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    distResiPart = distNoResiPart = 0;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; numPartY / 2; j++ )</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    {</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; numPartX; i++ )</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;      {</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;        distResiPart   += dist[j + offsetResiPart][i];</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;        distNoResiPart += dist[j + offsetNoResiPart][i];</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;      }</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    }</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88acdce76d79a2b0b6baf7f5dedd429113c">SBT_HOR_H0</a>] = ( distResiPart &gt;&gt; shift ) + distNoResiPart;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ad607bcbef136c1907302c67b0250e404">SBT_HOR_H1</a>] = ( distNoResiPart &gt;&gt; shift ) + distResiPart;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;  }</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160; </div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a9fe3eb5d1e62f7f7c8480862c62952cd">SBT_VER_QUAD</a>, sbtAllowed ) )</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;  {</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    assert( numPartX == 4 );</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ac71acd764b4f5140f495e6d1d940fc51">SBT_VER_Q0</a>] = <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8e9d0ea49be38a05b06f289bf0999806">SBT_VER_Q1</a>] = 0;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; numPartY; j++ )</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    {</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ac71acd764b4f5140f495e6d1d940fc51">SBT_VER_Q0</a>] += dist[j][0] + ( ( dist[j][1] + dist[j][2] + dist[j][3] ) &lt;&lt; shift );</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8e9d0ea49be38a05b06f289bf0999806">SBT_VER_Q1</a>] += dist[j][3] + ( ( dist[j][0] + dist[j][1] + dist[j][2] ) &lt;&lt; shift );</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    }</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ac71acd764b4f5140f495e6d1d940fc51">SBT_VER_Q0</a>] = <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ac71acd764b4f5140f495e6d1d940fc51">SBT_VER_Q0</a>] &gt;&gt; shift;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8e9d0ea49be38a05b06f289bf0999806">SBT_VER_Q1</a>] = <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8e9d0ea49be38a05b06f289bf0999806">SBT_VER_Q1</a>] &gt;&gt; shift;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;  }</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160; </div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a747352234727cd258515baff1a178831">SBT_HOR_QUAD</a>, sbtAllowed ) )</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  {</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    assert( numPartY == 4 );</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8c5c94eef555382fe4299f9a9842097d">SBT_HOR_Q0</a>] = <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7a32b38087042ef6256e48d430a995a2">SBT_HOR_Q1</a>] = 0;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; numPartX; i++ )</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    {</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8c5c94eef555382fe4299f9a9842097d">SBT_HOR_Q0</a>] += dist[0][i] + ( ( dist[1][i] + dist[2][i] + dist[3][i] ) &lt;&lt; shift );</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7a32b38087042ef6256e48d430a995a2">SBT_HOR_Q1</a>] += dist[3][i] + ( ( dist[0][i] + dist[1][i] + dist[2][i] ) &lt;&lt; shift );</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    }</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8c5c94eef555382fe4299f9a9842097d">SBT_HOR_Q0</a>] = <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8c5c94eef555382fe4299f9a9842097d">SBT_HOR_Q0</a>] &gt;&gt; shift;</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7a32b38087042ef6256e48d430a995a2">SBT_HOR_Q1</a>] = <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7a32b38087042ef6256e48d430a995a2">SBT_HOR_Q1</a>] &gt;&gt; shift;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  }</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160; </div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;  <span class="comment">//SBT fast algorithm 5: try N SBT modes with the lowest distortion</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> temp[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>];</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;  memcpy( temp, <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>, <span class="keyword">sizeof</span>( <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> ) * <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a> );</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;  memset( <a class="code" href="classvvenc_1_1InterSearch.html#afa470f8b1c0f3cb28395539dfa4bc4cc">m_sbtRdoOrder</a>, 255, <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a> );</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  <span class="keywordtype">int</span> startIdx = 0, numRDO;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;  numRDO = <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090afa1fb9ec8d0ac776c8feafb4d5bd404e">SBT_VER_HALF</a>, sbtAllowed ) + <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a2e0ddb9e99d386c945eee355baa5ebff">SBT_HOR_HALF</a>, sbtAllowed );</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;  numRDO = std::min( ( numRDO &lt;&lt; 1 ), <a class="code" href="namespacevvenc.html#a8eb9b5b7e65483d0fdd92a3523e937e7">SBT_NUM_RDO</a> );</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = startIdx; i &lt; startIdx + numRDO; i++ )</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;  {</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> minDist = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> n = <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7be139e95d2f0c3a60ecc5c654609f18">SBT_VER_H0</a>; n &lt;= <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ad607bcbef136c1907302c67b0250e404">SBT_HOR_H1</a>; n++ )</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;    {</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;      <span class="keywordflow">if</span>( temp[n] &lt; minDist )</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      {</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;        minDist = temp[n];</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#afa470f8b1c0f3cb28395539dfa4bc4cc">m_sbtRdoOrder</a>[i] = n;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;      }</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    }</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    temp[<a class="code" href="classvvenc_1_1InterSearch.html#afa470f8b1c0f3cb28395539dfa4bc4cc">m_sbtRdoOrder</a>[i]] = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  }</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160; </div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  startIdx += numRDO;</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  numRDO = <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a9fe3eb5d1e62f7f7c8480862c62952cd">SBT_VER_QUAD</a>, sbtAllowed ) + <a class="code" href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">CU::targetSbtAllowed</a>( <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a747352234727cd258515baff1a178831">SBT_HOR_QUAD</a>, sbtAllowed );</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  numRDO = std::min( ( numRDO &lt;&lt; 1 ), <a class="code" href="namespacevvenc.html#a8eb9b5b7e65483d0fdd92a3523e937e7">SBT_NUM_RDO</a> );</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = startIdx; i &lt; startIdx + numRDO; i++ )</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;  {</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> minDist = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> n = <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ac71acd764b4f5140f495e6d1d940fc51">SBT_VER_Q0</a>; n &lt;= <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7a32b38087042ef6256e48d430a995a2">SBT_HOR_Q1</a>; n++ )</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    {</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      <span class="keywordflow">if</span>( temp[n] &lt; minDist )</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      {</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        minDist = temp[n];</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#afa470f8b1c0f3cb28395539dfa4bc4cc">m_sbtRdoOrder</a>[i] = n;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      }</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    }</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    temp[<a class="code" href="classvvenc_1_1InterSearch.html#afa470f8b1c0f3cb28395539dfa4bc4cc">m_sbtRdoOrder</a>[i]] = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;  }</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;}</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160; </div>
<div class="line"><a name="l03637"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a3b688da19bcfb0ff8a8f92f82132d5da"> 3637</a></span>&#160;uint8_t <a class="code" href="classvvenc_1_1InterSearch.html#a3b688da19bcfb0ff8a8f92f82132d5da">InterSearch::skipSbtByRDCost</a>( <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <span class="keywordtype">int</span> mtDepth, uint8_t sbtIdx, uint8_t sbtPos, <span class="keywordtype">double</span> bestCost, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> distSbtOff, <span class="keywordtype">double</span> costSbtOff, <span class="keywordtype">bool</span> rootCbfSbtOff )</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;{</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;  <span class="keywordtype">int</span> sbtMode = <a class="code" href="namespacevvenc_1_1CU.html#ad76564dacc5c55751e4d2f6d96490052">CU::getSbtMode</a>( sbtIdx, sbtPos );</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160; </div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  <span class="comment">//SBT fast algorithm 2.2 : estimate a minimum RD cost of a SBT mode based on the luma distortion of uncoded part and coded part (assuming distorted can be reduced to 1/16);</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;  <span class="comment">//                         if this cost is larger than the best cost, no need to try a specific SBT mode</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( 11 &lt;&lt; <a class="code" href="namespacevvenc.html#abec647b6cf94dcd6aa9ce4d5fba1ee82">SCALE_BITS</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[sbtMode] ) &gt; bestCost )</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;  {</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">//early skip type 0</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;  }</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160; </div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;  <span class="keywordflow">if</span>( costSbtOff != <a class="code" href="namespacevvenc.html#af3b8fe3c3850ac884f854414f26c76b2">MAX_DOUBLE</a> )</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;  {</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    <span class="keywordflow">if</span>( !rootCbfSbtOff )</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    {</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <span class="comment">//SBT fast algorithm 3: skip SBT when the residual is too small (estCost is more accurate than fast algorithm 1, counting PU mode bits)</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      uint64_t minNonZeroResiFracBits = 10 &lt;&lt; <a class="code" href="namespacevvenc.html#abec647b6cf94dcd6aa9ce4d5fba1ee82">SCALE_BITS</a>;</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> distResiPart;</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      <span class="keywordflow">if</span>( sbtIdx == <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090afa1fb9ec8d0ac776c8feafb4d5bd404e">SBT_VER_HALF</a> || sbtIdx == <a class="code" href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a2e0ddb9e99d386c945eee355baa5ebff">SBT_HOR_HALF</a> )</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        distResiPart = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>)( ( ( <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] - <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[sbtMode] ) * 9 ) &gt;&gt; 4 );</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;      }</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      {</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;        distResiPart = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>)( ( ( <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[<a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">NUMBER_SBT_MODE</a>] - <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[sbtMode] ) * 3 ) &gt;&gt; 3 );</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      }</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160; </div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;      <span class="keywordtype">double</span> estCost = ( costSbtOff - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( 0 &lt;&lt; <a class="code" href="namespacevvenc.html#abec647b6cf94dcd6aa9ce4d5fba1ee82">SCALE_BITS</a>, distSbtOff ) ) + <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( minNonZeroResiFracBits, <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[sbtMode] + distResiPart );</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      <span class="keywordflow">if</span>( estCost &gt; costSbtOff )</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;      {</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      }</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;      <span class="keywordflow">if</span>( estCost &gt; bestCost )</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      {</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      }</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    }</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    {</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      <span class="comment">//SBT fast algorithm 4: skip SBT when an estimated RD cost is larger than the bestCost</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;      <span class="keywordtype">double</span> weight = sbtMode &gt; <a class="code" href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ad607bcbef136c1907302c67b0250e404">SBT_HOR_H1</a> ? 0.4 : 0.6;</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      <span class="keywordtype">double</span> estCost = ( ( costSbtOff - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( 0 &lt;&lt; <a class="code" href="namespacevvenc.html#abec647b6cf94dcd6aa9ce4d5fba1ee82">SCALE_BITS</a>, distSbtOff ) ) * weight ) + <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( 0 &lt;&lt; <a class="code" href="namespacevvenc.html#abec647b6cf94dcd6aa9ce4d5fba1ee82">SCALE_BITS</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">m_estMinDistSbt</a>[sbtMode] );</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;      <span class="keywordflow">if</span>( estCost &gt; bestCost )</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;      {</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;        <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      }</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    }</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;  }</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacevvenc.html#af837675097d4327bced55e989582462d">MAX_UCHAR</a>;</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;}</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160; </div>
<div class="line"><a name="l03688"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a3690ee43ddf352cc2fa9fab4d65d8616"> 3688</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a3690ee43ddf352cc2fa9fab4d65d8616">InterSearch::xEstimateInterResidualQT</a>(<a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> &amp;cs, <a class="code" href="classvvenc_1_1Partitioner.html">Partitioner</a> &amp;partitioner, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> *puiZeroDist <span class="comment">/*= NULL*/</span>)</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;{</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1UnitArea.html">UnitArea</a>&amp; currArea = partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a979d8cb627dcb558d29ff7f0a14de0a1">currArea</a>();</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1SPS.html">SPS</a> &amp;sps           = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>;</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160; </div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;  <span class="keyword">const</span> uint32_t numValidComp  = <a class="code" href="namespacevvenc.html#a9003964e78e9d46fb169c59874f7c4a8">getNumberValidComponents</a>( sps.<a class="code" href="structvvenc_1_1SPS.html#af671e643fcbb19af8b0cf8aa94657716">chromaFormatIdc</a> );</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  <span class="keyword">const</span> uint32_t numTBlocks    = <a class="code" href="namespacevvenc.html#aaef1d69143f174b210e402096fdec398">getNumberValidTBlocks</a>   ( *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu               = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ac1fb6d2f0f24ad434b770a78ba00d30a">getCU</a>(partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a5807aec71a4db132719a28dc3f094714">treeType</a>);</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> currDepth = partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a11a11dea891ee137a4a756ba94caaed1">currTrDepth</a>;</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> useTS = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">picture</a>-&gt;<a class="code" href="structvvenc_1_1Picture.html#ac2177ac5931e79008f369548ea5aa533">useScTS</a>;</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160; </div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;  <span class="keywordtype">bool</span> bCheckFull  = !partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d">TU_MAX_TR_SPLIT</a>, cs );</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;  <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> &amp;&amp; partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc_1_1CU.html#a10639af982cbc58394e930bae8f96d56">CU::getSbtTuSplit</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> ), cs ) )</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  {</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    bCheckFull = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;  }</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  <span class="keywordtype">bool</span> bCheckSplit = !bCheckFull;</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160; </div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;  <span class="comment">// get temporary data</span></div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;  <a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> *csSplit = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;  <a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> *csFull  = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;  <span class="keywordflow">if</span> (bCheckSplit)</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  {</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    csSplit = &amp;cs;</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;  }</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bCheckFull)</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  {</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    csFull = &amp;cs;</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;  }</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160; </div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiSingleDist         = 0;</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiSingleDistComp [3] = { 0, 0, 0 };</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160; </div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1TempCtx.html">TempCtx</a> ctxStart  ( <a class="code" href="classvvenc_1_1InterSearch.html#adc15ecb13505785bb69c278578c79980">m_CtxCache</a>, <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() );</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  <a class="code" href="classvvenc_1_1TempCtx.html">TempCtx</a>       ctxBest   ( <a class="code" href="classvvenc_1_1InterSearch.html#adc15ecb13505785bb69c278578c79980">m_CtxCache</a> );</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160; </div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>    orgResiBuf;</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;  orgResiBuf = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( currArea );</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;  orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#ae234f3d4d1911a5f0e1b61a5425c320f">copyFrom</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(currArea));</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160; </div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;  <span class="keywordflow">if</span> (bCheckFull)</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;  {</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    <a class="code" href="classvvenc_1_1ReshapeData.html">ReshapeData</a>&amp; reshapeData = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">picture</a>-&gt;<a class="code" href="structvvenc_1_1Picture.html#a2487e6c4ee0e4106a128c09f68105170">reshapeData</a>;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160; </div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    <a class="code" href="structvvenc_1_1TransformUnit.html">TransformUnit</a>&amp; tu = csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#adc4eacf3bc04920048d835c3370b3922">addTU</a>(<a class="code" href="namespacevvenc_1_1CS.html#a3fb95e33195ec4a44e586f6f8480fa38">CS::getArea</a>(cs, currArea, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a5807aec71a4db132719a28dc3f094714">treeType</a>), partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, &amp;cu);</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ab6f276082172be43a6041212071e377b">depth</a>          = currDepth;</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;    tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>] = <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">MTS_DCT2_DCT2</a>;</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a06f0abb90ba59ce634a81d1b81af46b4">checkTuNoResidual</a>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#ac71f852bf800be16d8fad4f0024c78ad">currPartIdx</a>() );</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;    <span class="keywordflow">if</span> (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>() &amp;&amp; cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#ab397bddbf3c96f9b0fe2d48b16f1b51b">lmcsChromaResidualScale</a> &amp;&amp; !(<a class="code" href="namespacevvenc_1_1CS.html#a740c9fbc8b40bc5bfd3a11aeefcf13bb">CS::isDualITree</a>(cs) &amp;&amp; cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a022764e04d9a5b3e4e90b20a70d05677">isIntra</a>() &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#ac7eaae99495c02b91aae61ef0201b027">predMode</a> == <a class="code" href="namespacevvenc.html#a33d1666f1cc95252c96e39584255954ea3771dff51788e6c0254bcf3e9e992602">MODE_IBC</a>))</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    {</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;      tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a> = reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#ae4ed8d1a51a8c76e7c92769282c379e0">calculateChromaAdjVpduNei</a>(tu, tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>], tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#a5807aec71a4db132719a28dc3f094714">treeType</a>);</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;    }</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160; </div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;    <span class="keywordtype">double</span> minCost [<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa555c470c9fade36f4bc57231923c0517">MAX_NUM_TBLOCKS</a>];</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160; </div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160; </div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    memset(<a class="code" href="classvvenc_1_1InterSearch.html#a9e6b286fba70f2939620587a433bd651">m_pTempPel</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>) * tu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#ade69005a9b1da536b0ffaee9db5a6916">area</a>()); <span class="comment">// not necessary needed for inside of recursion (only at the beginning)</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160; </div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; numTBlocks; i++)</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    {</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;      minCost[i] = <a class="code" href="namespacevvenc.html#af3b8fe3c3850ac884f854414f26c76b2">MAX_DOUBLE</a>;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    }</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160; </div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> &amp;saveCS = *<a class="code" href="classvvenc_1_1InterSearch.html#ad5e48395a803d72de5136bce7a37933d">m_pSaveCS</a>[0];</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>     = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">picture</a> = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">picture</a>;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;    saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#abce2e87aaf7e3dd8fb0a930b2f1fb82f">area</a>.<a class="code" href="structvvenc_1_1UnitArea.html#a9f6af7b1d0e90f070ecbc7bdca1509f9">repositionTo</a>(currArea);</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;    saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#ac0a8e9885f1c7c492a6949e06c15c834">clearTUs</a>();</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    <a class="code" href="structvvenc_1_1TransformUnit.html">TransformUnit</a>&amp;  bestTU = saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#adc4eacf3bc04920048d835c3370b3922">addTU</a>(<a class="code" href="namespacevvenc_1_1CS.html#a3fb95e33195ec4a44e586f6f8480fa38">CS::getArea</a>(cs, currArea, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a5807aec71a4db132719a28dc3f094714">treeType</a>), partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160; </div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    <span class="keywordflow">for</span>( uint32_t c = 0; c &lt; numTBlocks; c++ )</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    {</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID    = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(c);</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CompArea.html">CompArea</a>&amp;   compArea  = tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID];</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> channelBitDepth   = sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>(compID)];</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160; </div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;      <span class="keywordflow">if</span>( !tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].valid() )</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      {</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      }</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      <span class="keywordtype">bool</span> tsAllowed = useTS &amp;&amp; <a class="code" href="namespacevvenc_1_1TU.html#aee00d6cb0167549b59828b4df8604a51">TU::isTSAllowed</a>(tu, compID) &amp;&amp; (<a class="code" href="namespacevvenc.html#ac5289e15fcc41d93fc27a1efcde294d2">isLuma</a>(compID) || (<a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>(compID) &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_useChromaTS));</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>(compID) &amp;&amp; tsAllowed &amp;&amp; (tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>] != <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">MTS_SKIP</a>))</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      {</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        tsAllowed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      }</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      uint8_t nNumTransformCands = 1 + (tsAllowed ? 1 : 0); <span class="comment">// DCT + TS = 2 tests</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      std::vector&lt;TrMode&gt; trModes;</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160; </div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      <span class="keywordflow">if</span> (nNumTransformCands &gt; 1)</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      {</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;        trModes.push_back(<a class="code" href="namespacevvenc.html#ad62ea957935587c4a14c133ba59d63ba">TrMode</a>(0, <span class="keyword">true</span>)); <span class="comment">//DCT2</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;        <span class="comment">//for a SBT-no-residual TU, the RDO process should be called once, in order to get the RD cost</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;        <span class="keywordflow">if</span> ( !tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a> )</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;          trModes.push_back(<a class="code" href="namespacevvenc.html#ad62ea957935587c4a14c133ba59d63ba">TrMode</a>(1, <span class="keyword">true</span>));</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        }</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        {</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;          nNumTransformCands--;</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        }</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      }</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      <span class="keywordtype">bool</span> isLast = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> transformMode = 0; transformMode &lt; nNumTransformCands; transformMode++)</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      {</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> isFirstMode = transformMode == 0;</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160; </div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;        <span class="comment">// copy the original residual into the residual buffer</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;        csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(compArea).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a59fa1e9c0d0dafd04140d8e96323587f">get</a>(compID));</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160; </div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160; </div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() = ctxStart;</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160; </div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;        <span class="keywordflow">if</span> (bestTU.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[compID] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">MTS_SKIP</a> &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_TS)</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;        {</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;        }</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;        tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[compID] = transformMode ? trModes[transformMode].first : 0;</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160; </div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;        <span class="keyword">const</span> <a class="code" href="classvvenc_1_1QpParam.html">QpParam</a> cQP(tu, compID);  <span class="comment">// note: uses tu.transformSkip[compID]</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#a03afb3eb7f04ff2cb52376063d842a94">selectLambda</a>(compID);</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160; </div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;        <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Slice.html">Slice</a>&amp; slice = *tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;        <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>() &amp;&amp; <a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>(compID) &amp;&amp; slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#ab397bddbf3c96f9b0fe2d48b16f1b51b">lmcsChromaResidualScale</a> )</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;        {</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;          <span class="keywordtype">double</span> cRescale = (double)(1 &lt;&lt; <a class="code" href="namespacevvenc.html#a053ff437868fc90a5f56a4cc8a715ccb">CSCALE_FP_PREC</a>) / (double)(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>);</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ae88b42646e4ac67be7437f88406d2285">scaleLambda</a>( 1.0/(cRescale*cRescale) );</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;        }</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160; </div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;        <span class="keywordflow">if</span> ( sps.<a class="code" href="structvvenc_1_1SPS.html#a32fa8b93af52b377f7f9224ae04bec8b">jointCbCr</a> &amp;&amp; <a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>( compID ) &amp;&amp; ( tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a508c08bc126bef2837ba572ad52a9892">sliceQp</a> &gt; 18 ) )</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;        {</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ae88b42646e4ac67be7437f88406d2285">scaleLambda</a>( 1.05 );</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;        }</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;        <a class="code" href="namespacevvenc.html#aeba68786bfeeda596a9fc2ef5ebe7ce6">TCoeff</a>     currAbsSum = 0;</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;        uint64_t   currCompFracBits = 0;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;        <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> currCompDist = 0;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;        <span class="keywordtype">double</span>     currCompCost = 0;</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        uint64_t   nonCoeffFracBits = 0;</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;        <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> nonCoeffDist = 0;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;        <span class="keywordtype">double</span>     nonCoeffCost = 0;</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160; </div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;        <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>() &amp;&amp; <a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>(compID) &amp;&amp; slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#ab397bddbf3c96f9b0fe2d48b16f1b51b">lmcsChromaResidualScale</a> &amp;&amp; tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].width*tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].height &gt; 4 )</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;        {</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;          <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> resiBuf = csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(compArea);</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;          resiBuf.<a class="code" href="structvvenc_1_1AreaBuf.html#a165820082d9eeb0308c4acc06f599284">scaleSignal</a>(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>, 1, slice.<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[compID]);</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;        }</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160; </div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        <span class="keywordflow">if</span> (nNumTransformCands &gt; 1)</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;        {</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;          <span class="keywordflow">if</span> (transformMode == 0)</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;          {</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ac402a78434b540bc32cc370e4a69aace">checktransformsNxN</a>(tu, &amp;trModes, 2, compID);</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;            tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[compID] = trModes[0].first;</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            <span class="keywordflow">if</span> (!trModes[transformMode + 1].second)</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;            {</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;              nNumTransformCands = 1;</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;            }</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;          }</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#aa75cb739cc3a76b68078e6696558b79d">transformNxN</a>(tu, compID, cQP, currAbsSum, <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;        }</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;        {</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#aa75cb739cc3a76b68078e6696558b79d">transformNxN</a>(tu, compID, cQP, currAbsSum, <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>());</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;        }</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;        <span class="keywordflow">if</span> (isFirstMode || (currAbsSum == 0))</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;        {</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;          <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> zeroBuf(<a class="code" href="classvvenc_1_1InterSearch.html#a9e6b286fba70f2939620587a433bd651">m_pTempPel</a>, compArea);</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;          <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>&amp; orgResi = orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a59fa1e9c0d0dafd04140d8e96323587f">get</a>(compID);</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160; </div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;          nonCoeffDist = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(zeroBuf, orgResi, channelBitDepth, compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">DF_SSE</a>); <span class="comment">// initialized with zero residual distortion</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160; </div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;          <span class="keywordflow">if</span> (!tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a>)</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;          {</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> prevCbf = (compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ? tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ac0de654f5be7ffeb0a468a36a6f5f522">cbf</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] : <span class="keyword">false</span>);</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>(*tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>, <span class="keyword">false</span>, compArea, currDepth, prevCbf);</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;          }</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160; </div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;          nonCoeffFracBits = <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;          nonCoeffCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>(nonCoeffFracBits, nonCoeffDist, !<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_lumaLevelToDeltaQPEnabled);</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;        }</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160; </div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        <span class="keywordflow">if</span> ((puiZeroDist != <a class="code" href="CommonDef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; isFirstMode)</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;        {</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;          *puiZeroDist += nonCoeffDist; <span class="comment">// initialized with zero residual distortion</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;        }</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160; </div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;        <span class="keywordflow">if</span> (currAbsSum &gt; 0) <span class="comment">//if non-zero coefficients are present, a residual needs to be derived for further prediction</span></div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;        {</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;          <span class="keywordflow">if</span> (isFirstMode)</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;          {</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() = ctxStart;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;          }</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160; </div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span> prevCbf = ( compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ? tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ac0de654f5be7ffeb0a468a36a6f5f522">cbf</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] : false );</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>( *tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>, <span class="keyword">true</span>, compArea, currDepth, prevCbf );</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;          <span class="keywordflow">if</span>( compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> )</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;          {</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> cbfMask = ( tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ac0de654f5be7ffeb0a468a36a6f5f522">cbf</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] ? 2 : 0 ) + 1;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a1d7e220147dfc5222b5c0e380ee9e734">joint_cb_cr</a>( tu, cbfMask );</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;          }</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;          <a class="code" href="structvvenc_1_1CUCtx.html">CUCtx</a> cuCtx;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;          cuCtx.<a class="code" href="structvvenc_1_1CUCtx.html#a6596d42054bcbcb99840f2c76dc68861">isDQPCoded</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;          cuCtx.<a class="code" href="structvvenc_1_1CUCtx.html#af5ca41eb85bff40ec28a48c3b0860284">isChromaQpAdjCoded</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#acc2b42675b2a7422042407b224435ac7">residual_coding</a>(tu, compID, &amp;cuCtx);</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#af1517a1da99ed0821dec739003b62921">mts_idx</a>(cu, &amp;cuCtx);</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160; </div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;          currCompFracBits = <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160; </div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;          <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> resiBuf  = csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(compArea);</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;          <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> orgResi = orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a59fa1e9c0d0dafd04140d8e96323587f">get</a>(compID);</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160; </div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ade34c28b491ba61af93501c1fd5abcd3">invTransformNxN</a>(tu, compID, resiBuf, cQP);</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;          <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; <a class="code" href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">isChroma</a>(compID) &amp;&amp; slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#ab397bddbf3c96f9b0fe2d48b16f1b51b">lmcsChromaResidualScale</a> &amp;&amp; tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].width*tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].height &gt; 4)</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;          {</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;            resiBuf.<a class="code" href="structvvenc_1_1AreaBuf.html#a165820082d9eeb0308c4acc06f599284">scaleSignal</a>(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>, 0, slice.<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[compID]);</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;          }</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160; </div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;          currCompDist = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(orgResi, resiBuf, channelBitDepth, compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">DF_SSE</a>);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;          currCompCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>(currCompFracBits, currCompDist, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        }</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (transformMode &gt; 0)</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        {</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;          currCompCost = <a class="code" href="namespacevvenc.html#af3b8fe3c3850ac884f854414f26c76b2">MAX_DOUBLE</a>;</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        }</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        {</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;          currCompFracBits = nonCoeffFracBits;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;          currCompDist     = nonCoeffDist;</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;          currCompCost     = nonCoeffCost;</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160; </div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;          tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ac0de654f5be7ffeb0a468a36a6f5f522">cbf</a>[compID] = 0;</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;        }</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160; </div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        <span class="comment">// evaluate</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        <span class="keywordflow">if</span> ((currCompCost &lt; minCost[compID]) || (transformMode == 1 &amp;&amp; currCompCost == minCost[compID]))</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;        {</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;          <span class="comment">// copy component</span></div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;          <span class="keywordflow">if</span> (isFirstMode &amp;&amp; ((nonCoeffCost &lt; currCompCost) || (currAbsSum == 0))) <span class="comment">// check for forced null</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;          {</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;            tu.<a class="code" href="structvvenc_1_1TransformUnit.html#af06878784876e3b0829bb6d446c0a5e1">getCoeffs</a>( compID ).<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>( 0 );</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;            csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>( compArea ).<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>( 0 );</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;            tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ac0de654f5be7ffeb0a468a36a6f5f522">cbf</a>[compID]   = 0;</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160; </div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;            currAbsSum       = 0;</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;            currCompFracBits = nonCoeffFracBits;</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;            currCompDist     = nonCoeffDist;</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;            currCompCost     = nonCoeffCost;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;          }</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160; </div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;          uiSingleDistComp[compID] = currCompDist;</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;          minCost[compID]          = currCompCost;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;          <span class="keywordflow">if</span> (transformMode != (nNumTransformCands - 1))</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;          {</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;            bestTU.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>(tu, compID);</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;            saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(compArea).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(compArea));</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;          }</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;          {</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;            isLast = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;          }</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;        }</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;        <span class="keywordflow">if</span>( tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a> )</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;        {</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;          <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( currCompFracBits &gt; 0 || currAbsSum, <span class="stringliteral">&quot;currCompFracBits &gt; 0 when tu noResidual&quot;</span> );</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;        }</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      }</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      <span class="keywordflow">if</span> (isLast)</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;      {</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;        tu.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>(bestTU, compID);</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;        csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(compArea).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(compArea));</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;      }</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    } <span class="comment">// component loop</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160; </div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    <span class="keywordflow">if</span> ( tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>.<a class="code" href="classvvenc_1_1static__vector.html#a60304b65bf89363bcc3165d3cde67f86">size</a>()&gt;2 &amp;&amp; tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>].valid() )</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    {</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CompArea.html">CompArea</a>&amp; cbArea = tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>];</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CompArea.html">CompArea</a>&amp; crArea = tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>];</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      <span class="keywordtype">bool</span> checkJointCbCr = (sps.<a class="code" href="structvvenc_1_1SPS.html#a32fa8b93af52b377f7f9224ae04bec8b">jointCbCr</a>) &amp;&amp; (!tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a>) &amp;&amp; (<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>) || <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>));</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> channelBitDepth = sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>)];</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;      <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Slice.html">Slice</a>&amp; slice = *tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>;</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;      <span class="keywordtype">bool</span>      reshape         = slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>() &amp;&amp; slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#ab397bddbf3c96f9b0fe2d48b16f1b51b">lmcsChromaResidualScale</a></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;                               &amp;&amp; tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>].width * tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>].height &gt; 4;</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      <span class="keywordtype">double</span> minCostCbCr = minCost[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] + minCost[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>];</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      <span class="keywordtype">bool</span>   isLastBest  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160; </div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      <span class="keywordtype">bool</span> checkDCTOnly = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_useChromaTS &amp;&amp; ((<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">MTS_DCT2_DCT2</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>)) ||</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        (<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">MTS_DCT2_DCT2</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>)) ||</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;        (<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">MTS_DCT2_DCT2</a> &amp;&amp; <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">MTS_DCT2_DCT2</a>));</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;      <span class="keywordtype">bool</span> checkTSOnly = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_useChromaTS &amp;&amp; ((<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">MTS_SKIP</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>)) ||</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;        (<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">MTS_SKIP</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>)) ||</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;        (<a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">MTS_SKIP</a> &amp;&amp; <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>) &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>] == <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">MTS_SKIP</a>));</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160; </div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      <a class="code" href="structvvenc_1_1CompStorage.html">CompStorage</a>      orgResiCb[4], orgResiCr[4];   <span class="comment">// 0:std, 1-3:jointCbCr</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;      std::vector&lt;int&gt; jointCbfMasksToTest;</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;      <span class="keywordflow">if</span> ( checkJointCbCr )</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;      {</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;        orgResiCb[0].<a class="code" href="structvvenc_1_1CompStorage.html#ab1e81cc503ec0bbb39b0302881cea9e0">create</a>(cbArea);</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;        orgResiCr[0].<a class="code" href="structvvenc_1_1CompStorage.html#ab1e81cc503ec0bbb39b0302881cea9e0">create</a>(crArea);</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;        orgResiCb[0].<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#ad90881994b2968bd1c48e4fb16723fd5">Cb</a>());</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;        orgResiCr[0].<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a0d5f330a76f9f3b4b896a8589b8acb47">Cr</a>());</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;        <span class="keywordflow">if</span> (reshape)</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;        {</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;          orgResiCb[0].<a class="code" href="structvvenc_1_1AreaBuf.html#a165820082d9eeb0308c4acc06f599284">scaleSignal</a>(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>, 1, slice.<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>]);</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;          orgResiCr[0].<a class="code" href="structvvenc_1_1AreaBuf.html#a165820082d9eeb0308c4acc06f599284">scaleSignal</a>(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>, 1, slice.<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>]);</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;        }</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160; </div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;        jointCbfMasksToTest = <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#a85398aca013c701f21594ab422bec5e7">selectICTCandidates</a>(tu, orgResiCb, orgResiCr);</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160; </div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;        bestTU.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>);</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;        bestTU.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>);</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;        saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(cbArea).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(cbArea));</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;        saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(crArea).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(crArea));</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;      }</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160; </div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cbfMask: jointCbfMasksToTest)</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      {</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> codeCompId = (cbfMask &gt;&gt; 1 ? <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> : <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>);</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;        <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> otherCompId = (codeCompId == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ? <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> : <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>);</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;        <span class="keywordtype">bool</span> tsAllowed = useTS &amp;&amp; <a class="code" href="namespacevvenc_1_1TU.html#aee00d6cb0167549b59828b4df8604a51">TU::isTSAllowed</a>(tu, codeCompId) &amp;&amp; (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_useChromaTS);</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        <span class="keywordflow">if</span> (tsAllowed &amp;&amp; (tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>] != <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">MTS_SKIP</a>))</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;        {</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;          tsAllowed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        }</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;        <span class="keywordflow">if</span> (!tsAllowed)</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;        {</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;          checkTSOnly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        }</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        uint8_t     numTransformCands = 1 + (tsAllowed &amp;&amp; (!(checkDCTOnly || checkTSOnly)) ? 1 : 0); <span class="comment">// DCT + TS = 2 tests</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        std::vector&lt;TrMode&gt; trModes;</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        <span class="keywordflow">if</span> (numTransformCands &gt; 1)</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        {</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;          trModes.push_back(<a class="code" href="namespacevvenc.html#ad62ea957935587c4a14c133ba59d63ba">TrMode</a>(0, <span class="keyword">true</span>)); <span class="comment">// DCT2</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;          trModes.push_back(<a class="code" href="namespacevvenc.html#ad62ea957935587c4a14c133ba59d63ba">TrMode</a>(1, <span class="keyword">true</span>));<span class="comment">//TS</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        }</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        {</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;          tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[codeCompId] = checkTSOnly ? 1 : 0;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        }</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> modeId = 0; modeId &lt; numTransformCands; modeId++)</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;        {</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;          <a class="code" href="namespacevvenc.html#aeba68786bfeeda596a9fc2ef5ebe7ce6">TCoeff</a>     currAbsSum = 0;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;          uint64_t   currCompFracBits = 0;</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> currCompDistCb = 0;</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> currCompDistCr = 0;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;          <span class="keywordtype">double</span>     currCompCost = 0;</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160; </div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;          tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a9c8574e5da04a261981db4c362d46ade">jointCbCr</a> = (uint8_t)cbfMask;</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;          <span class="keywordflow">if</span> (numTransformCands &gt; 1)</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;          {</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;            tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[codeCompId] = trModes[modeId].first;</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;          }</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;          tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[otherCompId] = <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">MTS_DCT2_DCT2</a>;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;          <span class="keyword">const</span> <a class="code" href="classvvenc_1_1QpParam.html">QpParam</a> cQP(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>);  <span class="comment">// note: uses tu.transformSkip[compID]</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#a03afb3eb7f04ff2cb52376063d842a94">selectLambda</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>);</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160; </div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;          <span class="comment">// Lambda is loosened for the joint mode with respect to single modes as the same residual is used for both chroma blocks</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span>    absIct = abs(<a class="code" href="namespacevvenc_1_1TU.html#a4a1b594da27641480650e8bca1a752eb">TU::getICTMode</a>(tu));</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> lfact = (absIct == 1 || absIct == 3 ? 0.8 : 0.5);</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ae88b42646e4ac67be7437f88406d2285">scaleLambda</a>(lfact);</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;          <span class="keywordflow">if</span> (checkJointCbCr &amp;&amp; (tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>-&gt;<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a508c08bc126bef2837ba572ad52a9892">sliceQp</a> &gt; 18))</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;          {</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ae88b42646e4ac67be7437f88406d2285">scaleLambda</a>(1.05);</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;          }</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160; </div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() = ctxStart;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160; </div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;          <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> cbResi = csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(cbArea);</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;          <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> crResi = csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(crArea);</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;          cbResi.<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(orgResiCb[cbfMask]);</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;          crResi.<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(orgResiCr[cbfMask]);</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160; </div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;          <span class="keywordflow">if</span> (reshape)</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;          {</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;            <span class="keywordtype">double</span> cRescale = (double)(1 &lt;&lt; <a class="code" href="namespacevvenc.html#a053ff437868fc90a5f56a4cc8a715ccb">CSCALE_FP_PREC</a>) / (double)(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>);</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ae88b42646e4ac67be7437f88406d2285">scaleLambda</a>(1.0 / (cRescale * cRescale));</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;          }</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160; </div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;          <span class="keywordtype">int</span>         codedCbfMask = 0;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;          <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> codeCompId = (tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a9c8574e5da04a261981db4c362d46ade">jointCbCr</a> &gt;&gt; 1 ? <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> : <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>);</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;          <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> otherCompId = (codeCompId == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ? <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> : <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>);</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;          <span class="keyword">const</span> <a class="code" href="classvvenc_1_1QpParam.html">QpParam</a> qpCbCr(tu, codeCompId);</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160; </div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;          tu.<a class="code" href="structvvenc_1_1TransformUnit.html#af06878784876e3b0829bb6d446c0a5e1">getCoeffs</a>(otherCompId).<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>(0);   <span class="comment">// do we need that?</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;          <a class="code" href="namespacevvenc_1_1TU.html#afeb76a93cab1a555ddc0e30677536c35">TU::setCbfAtDepth</a>(tu, otherCompId, tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ab6f276082172be43a6041212071e377b">depth</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160; </div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;          <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a>&amp; codeResi = (codeCompId == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ? crResi : cbResi);</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;          <a class="code" href="namespacevvenc.html#aeba68786bfeeda596a9fc2ef5ebe7ce6">TCoeff</a>  compAbsSum = 0;</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;          <span class="keywordflow">if</span> (numTransformCands &gt; 1)</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;          {</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;            <span class="keywordflow">if</span> (modeId == 0)</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;            {</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ac402a78434b540bc32cc370e4a69aace">checktransformsNxN</a>(tu, &amp;trModes, 2, codeCompId);</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;              tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[codeCompId] = trModes[modeId].first;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;              tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[otherCompId] = <a class="code" href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">MTS_DCT2_DCT2</a>;</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;              <span class="keywordflow">if</span> (!trModes[modeId + 1].second)</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;              {</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;                numTransformCands = 1;</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;              }</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;            }</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#aa75cb739cc3a76b68078e6696558b79d">transformNxN</a>(tu, codeCompId, qpCbCr, compAbsSum, <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;          }</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;          {</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#aa75cb739cc3a76b68078e6696558b79d">transformNxN</a>(tu, codeCompId, qpCbCr, compAbsSum, <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>());</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;          }</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;          <span class="keywordflow">if</span> (compAbsSum &gt; 0)</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;          {</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#ade34c28b491ba61af93501c1fd5abcd3">invTransformNxN</a>(tu, codeCompId, codeResi, qpCbCr);</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;            codedCbfMask += (codeCompId == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> ? 2 : 1);</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;          }</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;          {</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;            codeResi.<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>(0);</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;          }</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160; </div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;          <span class="keywordflow">if</span> (tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a9c8574e5da04a261981db4c362d46ade">jointCbCr</a> == 3 &amp;&amp; codedCbfMask == 2)</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;          {</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;            codedCbfMask = 3;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;            <a class="code" href="namespacevvenc_1_1TU.html#afeb76a93cab1a555ddc0e30677536c35">TU::setCbfAtDepth</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>, tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ab6f276082172be43a6041212071e377b">depth</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;          }</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;          <span class="keywordflow">if</span> (codedCbfMask &amp;&amp; tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a9c8574e5da04a261981db4c362d46ade">jointCbCr</a> != codedCbfMask)</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;          {</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;            codedCbfMask = 0;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;          }</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;          currAbsSum = codedCbfMask;</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;          <span class="keywordflow">if</span> (!tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">mtsIdx</a>[codeCompId])</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;          {</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;            numTransformCands = (currAbsSum &lt;= 0) ? 1 : numTransformCands;</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;          }</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;          <span class="keywordflow">if</span> (currAbsSum &gt; 0)</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;          {</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>(*tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>, codedCbfMask &gt;&gt; 1, cbArea, currDepth, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>(*tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>, codedCbfMask &amp; 1, crArea, currDepth, codedCbfMask &gt;&gt; 1);</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a1d7e220147dfc5222b5c0e380ee9e734">joint_cb_cr</a>(tu, codedCbfMask);</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;            <span class="keywordflow">if</span> (codedCbfMask &gt;&gt; 1)</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#acc2b42675b2a7422042407b224435ac7">residual_coding</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>);</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;            <span class="keywordflow">if</span> (codedCbfMask &amp; 1)</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#acc2b42675b2a7422042407b224435ac7">residual_coding</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>);</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;            currCompFracBits = <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160; </div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">m_pcTrQuant</a>-&gt;<a class="code" href="classvvenc_1_1TrQuant.html#a05f1ce6070ab15e4a6a6ee621891926c">invTransformICT</a>(tu, cbResi, crResi);</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;            <span class="keywordflow">if</span> (reshape)</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;            {</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;              cbResi.<a class="code" href="structvvenc_1_1AreaBuf.html#a165820082d9eeb0308c4acc06f599284">scaleSignal</a>(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>, 0, slice.<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>]);</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;              crResi.<a class="code" href="structvvenc_1_1AreaBuf.html#a165820082d9eeb0308c4acc06f599284">scaleSignal</a>(tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">chromaAdj</a>, 0, slice.<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>]);</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;            }</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160; </div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;            currCompDistCb = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#ad90881994b2968bd1c48e4fb16723fd5">Cb</a>(), cbResi, channelBitDepth, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">DF_SSE</a>);</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;            currCompDistCr = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(orgResiBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a0d5f330a76f9f3b4b896a8589b8acb47">Cr</a>(), crResi, channelBitDepth, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">DF_SSE</a>);</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;            currCompCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>(currCompFracBits, currCompDistCr + currCompDistCb, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;          }</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;            currCompCost = <a class="code" href="namespacevvenc.html#af3b8fe3c3850ac884f854414f26c76b2">MAX_DOUBLE</a>;</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160; </div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;          <span class="comment">// evaluate</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;          <span class="keywordflow">if</span> (currCompCost &lt; minCostCbCr)</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;          {</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;            uiSingleDistComp[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>] = currCompDistCb;</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;            uiSingleDistComp[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>] = currCompDistCr;</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;            minCostCbCr = currCompCost;</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;            isLastBest = (cbfMask == jointCbfMasksToTest.back()) &amp;&amp; (modeId == (numTransformCands - 1));</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;            <span class="keywordflow">if</span> (!isLastBest)</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;            {</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;              bestTU.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>);</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;              bestTU.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>(tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>);</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;              saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(cbArea).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(cbArea));</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;              saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(crArea).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(crArea));</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;            }</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;          }</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;        }</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160; </div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;        <span class="keywordflow">if</span>( !isLastBest )</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;        {</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;          <span class="comment">// copy component</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;          tu.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>( bestTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> );</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;          tu.<a class="code" href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">copyComponentFrom</a>( bestTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> );</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;          csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>( cbArea ).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>( saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>( cbArea ) );</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;          csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>( crArea ).<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>( saveCS.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>( crArea ) );</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;        }</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;      }</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;    }</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160; </div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() = ctxStart;</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;    <span class="keywordflow">if</span>( !tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a> )</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;    {</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> cbf_getComp[3] = { <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> };</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;      <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> c = 0; c &lt; numTBlocks; c++)</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;      {</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID = numTBlocks&gt;1 ? cbf_getComp[c] : <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>;</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;        <span class="keywordflow">if</span>( tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].valid() )</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        {</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">bool</span> prevCbf = ( compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ? <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>, currDepth ) : false );</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">cbf_comp</a>( *tu.<a class="code" href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">cu</a>, <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( tu, compID, currDepth ), tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID], currDepth, prevCbf );</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        }</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;      }</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    }</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160; </div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <span class="keywordflow">for</span> (uint32_t ch = 0; ch &lt; numValidComp; ch++)</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    {</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch);</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;      <span class="keywordflow">if</span> (tu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[compID].valid())</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;      {</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;        <span class="keywordflow">if</span>( compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> )</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;        {</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> cbfMask = ( <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>( tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> ) ? 2 : 0 ) + ( <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>( tu, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ) ? 1 : 0 );</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a1d7e220147dfc5222b5c0e380ee9e734">joint_cb_cr</a>(tu, cbfMask);</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;        }</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">TU::getCbf</a>( tu, compID ) )</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;        {</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#acc2b42675b2a7422042407b224435ac7">residual_coding</a>( tu, compID );</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;        }</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;        uiSingleDist += uiSingleDistComp[compID];</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;      }</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;    }</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    <span class="keywordflow">if</span>( tu.<a class="code" href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">noResidual</a> )</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    {</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;      <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>() &gt; 0, <span class="stringliteral">&quot;no residual TU&#39;s bits shall be 0&quot;</span> );</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    }</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160; </div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a> += <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;    csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a>     += uiSingleDist;</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a>      = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>(csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a>, csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a>, !<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_lumaLevelToDeltaQPEnabled);</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;  } <span class="comment">// check full</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160; </div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;  <span class="comment">// code sub-blocks</span></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;  <span class="keywordflow">if</span>( bCheckSplit )</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;  {</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;    <span class="keywordflow">if</span>( bCheckFull )</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    {</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() = ctxStart;</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    }</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160; </div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    <span class="keywordflow">if</span>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d">TU_MAX_TR_SPLIT</a>, cs ) )</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    {</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a7d54121d05bf25e1dcf3127b87ed43e8">splitCurrArea</a>( <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d">TU_MAX_TR_SPLIT</a>, cs );</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    }</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> &amp;&amp; partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">canSplit</a>( <a class="code" href="namespacevvenc_1_1CU.html#a10639af982cbc58394e930bae8f96d56">CU::getSbtTuSplit</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> ), cs ) )</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;    {</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;      partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a7d54121d05bf25e1dcf3127b87ed43e8">splitCurrArea</a>( <a class="code" href="namespacevvenc_1_1CU.html#a10639af982cbc58394e930bae8f96d56">CU::getSbtTuSplit</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> ), cs );</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;    }</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;      <a class="code" href="StatCounter_8h.html#a27264efd631c4f584ddcb2f5888ae6ed">THROW</a>( <span class="stringliteral">&quot;Implicit TU split not available!&quot;</span> );</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160; </div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    {</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a3690ee43ddf352cc2fa9fab4d65d8616">xEstimateInterResidualQT</a>(*csSplit, partitioner, bCheckFull ? <span class="keyword">nullptr</span> : puiZeroDist );</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160; </div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;      csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a> = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a>, csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a> );</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    } <span class="keywordflow">while</span>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#acfc0e74841898a7fcb4981551881b552">nextPart</a>( *csSplit ) );</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160; </div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;    partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a959a14b1ba27b7cc28352007af5eafe7">exitCurrSplit</a>();</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160; </div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    <span class="keywordtype">unsigned</span>        anyCbfSet   =   0;</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;    <span class="keywordtype">unsigned</span>        compCbf[3]  = { 0, 0, 0 };</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160; </div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    <span class="keywordflow">if</span>( !bCheckFull )</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    {</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;currTU : csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0fe73397dafd172ff20c334c5e410663">traverseTUs</a>( currArea, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a> ) )</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;      {</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> ch = 0; ch &lt; numTBlocks; ch++ )</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;        {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;          compCbf[ ch ] |= ( <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch), currDepth + 1 ) ? 1 : 0 );</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;        }</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;      }</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160; </div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;currTU : csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0fe73397dafd172ff20c334c5e410663">traverseTUs</a>( currArea, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a> ) )</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;      {</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        <a class="code" href="namespacevvenc_1_1TU.html#afeb76a93cab1a555ddc0e30677536c35">TU::setCbfAtDepth</a>   ( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>,  currDepth, compCbf[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>  ] );</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        <span class="keywordflow">if</span>( currArea.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a> != <a class="code" href="TypeDef_8h.html#a1644a589f6466e6ce533230a841fc96a">CHROMA_400</a> )</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        {</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;          <a class="code" href="namespacevvenc_1_1TU.html#afeb76a93cab1a555ddc0e30677536c35">TU::setCbfAtDepth</a> ( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>, currDepth, compCbf[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> ] );</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;          <a class="code" href="namespacevvenc_1_1TU.html#afeb76a93cab1a555ddc0e30677536c35">TU::setCbfAtDepth</a> ( currTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>, currDepth, compCbf[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ] );</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        }</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      }</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160; </div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;      anyCbfSet    = compCbf[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>  ];</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;      <span class="keywordflow">if</span>( currArea.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a> != <a class="code" href="TypeDef_8h.html#a1644a589f6466e6ce533230a841fc96a">CHROMA_400</a> )</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;      {</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;        anyCbfSet |= compCbf[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a> ];</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;        anyCbfSet |= compCbf[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a> ];</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;      }</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160; </div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() = ctxStart;</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160; </div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      <span class="comment">// when compID isn&#39;t a channel, code Cbfs:</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a23a6f1ead4939bc6154475ae86dda34b">xEncodeInterResidualQT</a>( *csSplit, partitioner, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa555c470c9fade36f4bc57231923c0517">MAX_NUM_TBLOCKS</a> );</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160; </div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;      <span class="keywordflow">for</span> (uint32_t ch = 0; ch &lt; numValidComp; ch++)</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;      {</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch);</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a23a6f1ead4939bc6154475ae86dda34b">xEncodeInterResidualQT</a>( *csSplit, partitioner, compID );</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;      }</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160; </div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;      csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a> = <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;      csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a>     = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>(csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a>, csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a>);</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160; </div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;      <span class="keywordflow">if</span>( bCheckFull &amp;&amp; anyCbfSet &amp;&amp; csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a> &lt; csFull-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a> )</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;      {</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;        cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a6cbe682149541a426b984c71fc83baa8">useSubStructure</a>( *csSplit, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a5807aec71a4db132719a28dc3f094714">treeType</a>, currArea, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;        cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a> = csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a>;</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;      }</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    }</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160; </div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    <span class="keywordflow">if</span>( csSplit &amp;&amp; csFull )</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    {</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      csSplit-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ab28e0caee71d21ed19f59303e11a1ef7">releaseIntermediateData</a>();</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;      csFull -&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ab28e0caee71d21ed19f59303e11a1ef7">releaseIntermediateData</a>();</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;    }</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;  }</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;}</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160; </div>
<div class="line"><a name="l04304"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a9c686c694eaa5ea4e414cb623bde0139"> 4304</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a9c686c694eaa5ea4e414cb623bde0139">InterSearch::encodeResAndCalcRdInterCU</a>(<a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> &amp;cs, <a class="code" href="classvvenc_1_1Partitioner.html">Partitioner</a> &amp;partitioner, <span class="keyword">const</span> <span class="keywordtype">bool</span> skipResidual )</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;{</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;  <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a> &amp;cu = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ac1fb6d2f0f24ad434b770a78ba00d30a">getCU</a>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a5807aec71a4db132719a28dc3f094714">treeType</a> );</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;  <span class="keywordtype">bool</span> luma      = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;  <span class="keywordtype">bool</span> chroma    = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>-&gt;<a class="code" href="classvvenc_1_1PreCalcValues.html#accd995becc51735172dd859be536687a">chrFormat</a> != VVENC_CHROMA_400;</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac7eaae99495c02b91aae61ef0201b027">predMode</a> == <a class="code" href="namespacevvenc.html#a33d1666f1cc95252c96e39584255954ea3771dff51788e6c0254bcf3e9e992602">MODE_IBC</a>)</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;  {</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    luma    = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52609774fae02bf0caf55120ed83adc5">mcControl</a> &lt;= 3;</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    chroma &amp;= (cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52609774fae02bf0caf55120ed83adc5">mcControl</a> &gt;&gt; 1) != 1;</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;  }</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;  <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac7eaae99495c02b91aae61ef0201b027">predMode</a> == <a class="code" href="namespacevvenc.html#a33d1666f1cc95252c96e39584255954eaba4c54773c9f75ca10798034f712cc5f">MODE_INTER</a> )</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( <a class="code" href="namespacevvenc_1_1CU.html#a9dba2390376b36d2a779733a99663842">CU::isSepTree</a>(cu), <span class="stringliteral">&quot;CU with Inter mode must be in single tree&quot;</span> );</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160; </div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;  <span class="keyword">const</span> <a class="code" href="TypeDef_8h.html#a70dfa957a71cae40f75782ea972c130e">ChromaFormat</a> format      = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#abce2e87aaf7e3dd8fb0a930b2f1fb82f">area</a>.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a>;;</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>  numValidComponents  = <a class="code" href="namespacevvenc.html#a9003964e78e9d46fb169c59874f7c4a8">getNumberValidComponents</a>(format);</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1SPS.html">SPS</a> &amp;sps                 = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>;</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1ReshapeData.html">ReshapeData</a>&amp; reshapeData = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">picture</a>-&gt;<a class="code" href="structvvenc_1_1Picture.html#a2487e6c4ee0e4106a128c09f68105170">reshapeData</a>;</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160; </div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;  <span class="keywordflow">if</span>( skipResidual ) <span class="comment">//  No residual coding : SKIP mode</span></div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;  {</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a06a3c4a69b5863a5c06aa2da13dd30f3">skip</a>    = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> != 0, <span class="stringliteral">&quot;sbtInfo shall be 0 if CU has no residual&quot;</span> );</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>().<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>(0);</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>().<a class="code" href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">copyFrom</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>() );</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    <span class="keywordflow">if</span>( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>() &amp;&amp; !cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a34eddb3a879db373b6440a82c57b9fec">ciip</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1CU.html#a3041ffe17dbda47017f7e074f714c544">CU::isIBC</a>(cu))</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;    {</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;      cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>().Y().<a class="code" href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">rspSignal</a>( reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#ab39ba02b7f7b8d316d4ff7361a216ece">getFwdLUT</a>());</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    }</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160; </div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    <span class="comment">// add new &quot;empty&quot; TU(s) spanning the whole CU</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a19852e52eee8260a242359ede1e23084">addEmptyTUs</a>( partitioner, &amp;cu );</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> distortion = 0;</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160; </div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp = 0; comp &lt; numValidComponents; comp++)</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;    {</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(comp);</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;      <span class="keywordflow">if</span> (compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> &amp;&amp; !luma)</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;      <span class="keywordflow">if</span> (compID != <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> &amp;&amp; !chroma)</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> reco = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a> (compID);</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> org  = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>  (compID);</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;      <span class="keywordflow">if</span> ((cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>()) || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_lumaLevelToDeltaQPEnabled )</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;      {</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;        <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CompArea.html">CompArea</a>&amp; areaY = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>();</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;        <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> orgLuma = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>( areaY );</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;        <span class="keywordflow">if</span> (compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> &amp;&amp; !<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_lumaLevelToDeltaQPEnabled )</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;        {</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;          <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> tmpRecLuma = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ae1b62ea8953effa1be0f1bea3865fbbb">getRspRecoBuf</a>();</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;          tmpRecLuma.<a class="code" href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">rspSignal</a>(reco, reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aa5bb3b64b46c55daa973047310d70393">getInvLUT</a>());</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;          distortion += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(org, tmpRecLuma, sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a> ], compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4a5f003e50e352a3621b5dd637200e65">DF_SSE_WTD</a>, &amp;orgLuma);</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;        }</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;          distortion += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>( org, reco, sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a6b0616d0bcb1e796289f0f100bc9131a">CH_C</a> ], compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4a5f003e50e352a3621b5dd637200e65">DF_SSE_WTD</a>, &amp;orgLuma );</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      }</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      {</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;        distortion  += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>( org, reco, sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>( compID ) ], compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">DF_SSE</a> );</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;      }</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    }</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160; </div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ac1fb6d2f0f24ad434b770a78ba00d30a">getCU</a>(partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, <a class="code" href="namespacevvenc.html#ad31da9b5f4979160b0e600cd47e42b91a6e6e24d1d7c3c9c0e6ae48644aafbd36">TREE_D</a>);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#ac4519cfbb088d32c987e5a55a1edede9">cu_skip_flag</a>  ( cu );</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a25209148715302298bf0df62aed7f801">merge_data</a>(cu);</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a> = <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a>     = distortion;</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a>     = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a>, cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a>);</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160; </div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;  }</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160; </div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <span class="comment">//  Residual coding.</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <span class="keywordflow">if</span> (luma)</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;  {</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;    <span class="keywordflow">if</span> (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>())</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    {</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;      <span class="keywordflow">if</span> (!cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a34eddb3a879db373b6440a82c57b9fec">ciip</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1CU.html#a3041ffe17dbda47017f7e074f714c544">CU::isIBC</a>(cu))</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;      {</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        <span class="keyword">const</span> <a class="code" href="structvvenc_1_1CompArea.html">CompArea</a>&amp; areaY = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>();</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;        <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> tmpPred = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>(areaY);</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;        tmpPred.<a class="code" href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">rspSignal</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>), reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#ab39ba02b7f7b8d316d4ff7361a216ece">getFwdLUT</a>());</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;        cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>).<a class="code" href="structvvenc_1_1AreaBuf.html#ac7920a1ee068639dc3fb665b87aad9de">subtract</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#af3b393634f7347dadafa6b2698fa0b45">getRspOrgBuf</a>(), tmpPred);</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;      }</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      {</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;        cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>).<a class="code" href="structvvenc_1_1AreaBuf.html#ac7920a1ee068639dc3fb665b87aad9de">subtract</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#af3b393634f7347dadafa6b2698fa0b45">getRspOrgBuf</a>(), cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>));</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;      }</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    }</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    {</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>).<a class="code" href="structvvenc_1_1AreaBuf.html#ac7920a1ee068639dc3fb665b87aad9de">subtract</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>), cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>));</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    }</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;  }</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;  <span class="keywordflow">if</span> (chroma)</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;  {</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>).<a class="code" href="structvvenc_1_1AreaBuf.html#ac7920a1ee068639dc3fb665b87aad9de">subtract</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>), cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>));</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>).<a class="code" href="structvvenc_1_1AreaBuf.html#ac7920a1ee068639dc3fb665b87aad9de">subtract</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>), cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>));</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  }</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160; </div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> zeroDistortion = 0;</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160; </div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1TempCtx.html">TempCtx</a> ctxStart( <a class="code" href="classvvenc_1_1InterSearch.html#adc15ecb13505785bb69c278578c79980">m_CtxCache</a>, <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() );</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160; </div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a3690ee43ddf352cc2fa9fab4d65d8616">xEstimateInterResidualQT</a>(cs, partitioner, &amp;zeroDistortion );</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;  <a class="code" href="structvvenc_1_1TransformUnit.html">TransformUnit</a>&amp; firstTU = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#aae3934300792aab8eab2a4a906952424">getTU</a>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a> );</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160; </div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;  cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#ad0d270a4440e9686641a3d6131a6d26a">rqt_root_cbf</a>( cu );</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;  <span class="keyword">const</span> uint64_t  zeroFracBits = <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;  <span class="keywordtype">double</span> zeroCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>( zeroFracBits, zeroDistortion, !<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_lumaLevelToDeltaQPEnabled );</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160; </div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>  numValidTBlocks   = <a class="code" href="namespacevvenc.html#aaef1d69143f174b210e402096fdec398">getNumberValidTBlocks</a>( *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; numValidTBlocks; i++)</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;  {</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a> |= <a class="code" href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">TU::getCbfAtDepth</a>(firstTU, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(i), 0);</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;  }</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160; </div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;  <span class="comment">// -------------------------------------------------------</span></div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;  <span class="comment">// If a block full of 0&#39;s is efficient, then just use 0&#39;s.</span></div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  <span class="comment">// The costs at this point do not include header bits.</span></div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160; </div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;  <span class="keywordflow">if</span> (zeroCost &lt; cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a> || !cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a>)</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  {</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">sbtInfo</a> = 0;</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160; </div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ac0a8e9885f1c7c492a6949e06c15c834">clearTUs</a>();</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160; </div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;    <span class="comment">// add a new &quot;empty&quot; TU spanning the whole CU</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a19852e52eee8260a242359ede1e23084">addEmptyTUs</a>( partitioner, &amp;cu );</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  }</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160; </div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;  <span class="comment">// all decisions now made. Fully encode the CU, including the headers:</span></div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">getCtx</a>() = ctxStart;</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160; </div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;  uint64_t finalFracBits = <a class="code" href="classvvenc_1_1InterSearch.html#ad63bfa3ac9511f55501c000f8dda5cd4">xGetSymbolFracBitsInter</a>( cs, partitioner );</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;  <span class="comment">// we&#39;ve now encoded the CU, and so have a valid bit cost</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <span class="keywordflow">if</span> (!cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a>)</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;  {</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    <span class="keywordflow">if</span> (luma)</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;    {</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;      cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>().bufs[0].<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>(0); <span class="comment">// Clear the residual image, if we didn&#39;t code it.</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;    }</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    <span class="keywordflow">if</span> (chroma &amp;&amp; <a class="code" href="namespacevvenc.html#ae73f6f2b632c978d0661ed7c8d50a685">isChromaEnabled</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>-&gt;<a class="code" href="classvvenc_1_1PreCalcValues.html#accd995becc51735172dd859be536687a">chrFormat</a>))</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    {</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>().bufs[1].<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>(0); <span class="comment">// Clear the residual image, if we didn&#39;t code it.</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;      cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>().bufs[2].<a class="code" href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">fill</a>(0); <span class="comment">// Clear the residual image, if we didn&#39;t code it.</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;    }</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;  }</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;  <span class="keywordflow">if</span> (luma)</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;  {</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;    <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a> &amp;&amp; cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>())</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    {</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;      <span class="keywordflow">if</span> (!cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a34eddb3a879db373b6440a82c57b9fec">ciip</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1CU.html#a3041ffe17dbda47017f7e074f714c544">CU::isIBC</a>(cu))</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      {</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;        <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> tmpPred = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>());</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;        tmpPred.<a class="code" href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">rspSignal</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>), reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#ab39ba02b7f7b8d316d4ff7361a216ece">getFwdLUT</a>());</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;        cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>).<a class="code" href="structvvenc_1_1AreaBuf.html#ae418053da28e3f07a1ced285eee38c13">reconstruct</a>(tmpPred, cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>), cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>]);</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;      }</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;      {</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;        cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>).<a class="code" href="structvvenc_1_1AreaBuf.html#ae418053da28e3f07a1ced285eee38c13">reconstruct</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>), cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>), cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>]);</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;      }</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;    }</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;    {</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;      cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>().bufs[0].<a class="code" href="structvvenc_1_1AreaBuf.html#ae418053da28e3f07a1ced285eee38c13">reconstruct</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>().bufs[0], cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>().bufs[0], cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>]);</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      <span class="keywordflow">if</span> (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>() &amp;&amp; !cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a34eddb3a879db373b6440a82c57b9fec">ciip</a> &amp;&amp; !<a class="code" href="namespacevvenc_1_1CU.html#a3041ffe17dbda47017f7e074f714c544">CU::isIBC</a>(cu))</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      {</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;        cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>().bufs[0].<a class="code" href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">rspSignal</a>(reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#ab39ba02b7f7b8d316d4ff7361a216ece">getFwdLUT</a>());</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;      }</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    }</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;  }</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;  <span class="keywordflow">if</span> (chroma)</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;  {</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>().bufs[1].<a class="code" href="structvvenc_1_1AreaBuf.html#ae418053da28e3f07a1ced285eee38c13">reconstruct</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>().bufs[1], cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>().bufs[1], cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>]);</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a>().bufs[2].<a class="code" href="structvvenc_1_1AreaBuf.html#ae418053da28e3f07a1ced285eee38c13">reconstruct</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">getPredBuf</a>().bufs[2], cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">getResiBuf</a>().bufs[2], cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">COMP_Cr</a>]);</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;  }</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;  <span class="comment">// update with clipped distortion and cost (previously unclipped reconstruction values were used)</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> finalDistortion = 0;</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160; </div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp = 0; comp &lt; numValidComponents; comp++)</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;  {</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a> compID = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(comp);</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;    <span class="keywordflow">if</span> (compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> &amp;&amp; !luma)</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    <span class="keywordflow">if</span> (compID != <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> &amp;&amp; !chroma)</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;    <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> reco = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">getRecoBuf</a> (compID);</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;    <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> org  = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>  (compID);</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160; </div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    <span class="keywordflow">if</span>( (cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>()) || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_lumaLevelToDeltaQPEnabled )</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;    {</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> orgLuma = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>( cs.<a class="code" href="classvvenc_1_1CodingStructure.html#abce2e87aaf7e3dd8fb0a930b2f1fb82f">area</a>.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>] );</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;      <span class="keywordflow">if</span> (compID == <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> &amp;&amp; !<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_lumaLevelToDeltaQPEnabled )</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      {</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;        <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> tmpRecLuma = cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ae1b62ea8953effa1be0f1bea3865fbbb">getRspRecoBuf</a>();</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;        tmpRecLuma.<a class="code" href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">rspSignal</a>( reco, reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aa5bb3b64b46c55daa973047310d70393">getInvLUT</a>());</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;        finalDistortion += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(org, tmpRecLuma, sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>(compID)], compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4a5f003e50e352a3621b5dd637200e65">DF_SSE_WTD</a>, &amp;orgLuma);</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      }</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;      {</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;        finalDistortion += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(org, reco, sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>(compID)], compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4a5f003e50e352a3621b5dd637200e65">DF_SSE_WTD</a>, &amp;orgLuma);</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      }</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;    }</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;    {</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;      finalDistortion += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>( org, reco, sps.<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">toChannelType</a>(compID)], compID, <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">DF_SSE</a> );</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;    }</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;  }</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160; </div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;  cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a>     = finalDistortion;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;  cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a> = finalFracBits;</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;  cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">cost</a>     = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">calcRdCost</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">fracBits</a>, cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">dist</a>);</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160; </div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(cs.<a class="code" href="classvvenc_1_1CodingStructure.html#a4e591e79f5c8f5c0145e9088bb273703">tus</a>.size() == 0, <span class="stringliteral">&quot;No TUs present&quot;</span>);</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;}</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160; </div>
<div class="line"><a name="l04525"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ad63bfa3ac9511f55501c000f8dda5cd4"> 4525</a></span>&#160;uint64_t <a class="code" href="classvvenc_1_1InterSearch.html#ad63bfa3ac9511f55501c000f8dda5cd4">InterSearch::xGetSymbolFracBitsInter</a>(<a class="code" href="classvvenc_1_1CodingStructure.html">CodingStructure</a> &amp;cs, <a class="code" href="classvvenc_1_1Partitioner.html">Partitioner</a> &amp;partitioner)</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;{</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;  uint64_t fracBits   = 0;</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;  <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a> &amp;cu    = *cs.<a class="code" href="classvvenc_1_1CodingStructure.html#ac1fb6d2f0f24ad434b770a78ba00d30a">getCU</a>( partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">chType</a>, partitioner.<a class="code" href="classvvenc_1_1Partitioner.html#a5807aec71a4db132719a28dc3f094714">treeType</a> );</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160; </div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">resetBits</a>();</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160; </div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;  <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#ab2f1d06341e47118fffe7a0b2a9e0464">mergeFlag</a> &amp;&amp; !cu.<a class="code" href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">rootCbf</a> )</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;  {</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a06a3c4a69b5863a5c06aa2da13dd30f3">skip</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160; </div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#ac4519cfbb088d32c987e5a55a1edede9">cu_skip_flag</a>  ( cu );</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    <span class="keywordflow">if</span> (!cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a34eddb3a879db373b6440a82c57b9fec">ciip</a>)</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    {</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a25209148715302298bf0df62aed7f801">merge_data</a>(cu);</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    }</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;    fracBits   += <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;  }</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;  {</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;    <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a06a3c4a69b5863a5c06aa2da13dd30f3">skip</a>, <span class="stringliteral">&quot;Skip flag has to be off at this point!&quot;</span> );</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160; </div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1CompArea.html#a315419f26d3c59fa143b49b90a019049">valid</a>())</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#ac4519cfbb088d32c987e5a55a1edede9">cu_skip_flag</a>( cu );</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a83e839c5cb54dcf94ae015bdfd54d81d">pred_mode</a>   ( cu );</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a5d1c1cc9d0693589b31afb4de87c6ffb">cu_pred_data</a>( cu );</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;    <a class="code" href="structvvenc_1_1CUCtx.html">CUCtx</a> cuCtx;</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;    cuCtx.<a class="code" href="structvvenc_1_1CUCtx.html#a6596d42054bcbcb99840f2c76dc68861">isDQPCoded</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;    cuCtx.<a class="code" href="structvvenc_1_1CUCtx.html#af5ca41eb85bff40ec28a48c3b0860284">isChromaQpAdjCoded</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a09cfeacdc2b818e48bc3fc71b59ea829">cu_residual</a> ( cu, partitioner, cuCtx );</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;    fracBits       += <a class="code" href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">m_CABACEstimator</a>-&gt;<a class="code" href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">getEstFracBits</a>();</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;  }</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160; </div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  <span class="keywordflow">return</span> fracBits;</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;}</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160; </div>
<div class="line"><a name="l04561"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a38fa18d30e9c51ef390aa273da0f2cc5"> 4561</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classvvenc_1_1InterSearch.html#a38fa18d30e9c51ef390aa273da0f2cc5">InterSearch::xGetMEDistortionWeight</a>(uint8_t BcwIdx, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList)</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;{</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;  <span class="keywordflow">if</span>( BcwIdx != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> )</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;  {</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;    <span class="keywordflow">return</span> fabs( (<span class="keywordtype">double</span>)<a class="code" href="namespacevvenc.html#a2f2a8fb396fa1416e8a8ce3393fdcc93">getBcwWeight</a>( BcwIdx, refPicList ) / (<span class="keywordtype">double</span>)<a class="code" href="namespacevvenc.html#af662770c8086fcf63f3f6122c33f2d60">g_BcwWeightBase</a> );</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;  }</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;  {</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;    <span class="keywordflow">return</span> 0.5;</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;  }</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;}</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160; </div>
<div class="line"><a name="l04573"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a5f82995c567b1a06019ec3069d2f5166"> 4573</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classvvenc_1_1InterSearch.html#a5f82995c567b1a06019ec3069d2f5166">InterSearch::xReadBufferedUniMv</a>( <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> eRefPicList, int32_t iRefIdx, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; pcMvPred, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMv, uint32_t&amp; ruiBits, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost )</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;{</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a205b1a87b71065c7ced869e726f01b20">isReadMode</a>( (uint32_t)eRefPicList, (uint32_t)iRefIdx ) )</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;  {</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a412226c3b5b12371a91d1eb635a55dd8">copyTo</a>(rcMv, ruiCost, (uint32_t)eRefPicList, (uint32_t)iRefIdx);</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160; </div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = pcMvPred;</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;    pred.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> );</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>(pred);</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160; </div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = rcMv;</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    mv.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> );</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;    uint32_t mvBits = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>( mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0 );</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160; </div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    ruiBits += mvBits;</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;    ruiCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(ruiBits);</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;  }</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;}</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160; </div>
<div class="line"><a name="l04595"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a2b416c27fd70dc219f0bdc256a640fb3"> 4595</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classvvenc_1_1InterSearch.html#a2b416c27fd70dc219f0bdc256a640fb3">InterSearch::xReadBufferedAffineUniMv</a>( <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> eRefPicList, int32_t iRefIdx, <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvPred[3], <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMv[3], uint32_t&amp; ruiBits, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost, <span class="keywordtype">int</span>&amp; mvpIdx, <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a>&amp; aamvpi )</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;{</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a977c89bc082dcea4f5b2976cd3401b1d">isReadModeAffine</a>( (uint32_t)eRefPicList, (uint32_t)iRefIdx, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> ) )</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;  {</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a2d5859675f1d89520140269c4d1815a9">copyAffineMvTo</a>( acMv, ruiCost, (uint32_t)eRefPicList, (uint32_t)iRefIdx, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a>, mvpIdx );</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;    acMvPred[0] = aamvpi.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[mvpIdx];</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;    acMvPred[1] = aamvpi.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[mvpIdx];</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;    acMvPred[2] = aamvpi.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[mvpIdx];</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160; </div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;    uint32_t mvBits = 0;</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> verIdx = 0; verIdx &lt; ( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> ? 3 : 2 ); verIdx++ )</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;    {</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = verIdx ? acMvPred[verIdx] + acMv[0] - acMvPred[0] : acMvPred[verIdx];</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;      pred.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>);</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>(pred);</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = acMv[verIdx];</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;      mv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>);</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;      mvBits += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>( mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0 );</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;    }</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;    ruiBits += mvBits;</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;    ruiCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(ruiBits);</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;  }</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;}</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160; </div>
<div class="line"><a name="l04622"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a1014955f8421b10b97bd219860e426d1"> 4622</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a1014955f8421b10b97bd219860e426d1">InterSearch::xSymMvdCheckBestMvp</a>(</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;  <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf,</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> curMv,</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;  <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> curRefList,</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a> amvpInfo[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>],</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;  int32_t BcwIdx,</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cMvPredSym[2],</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;  int32_t mvpIdxSym[2],</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; bestCost,</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;  <span class="keywordtype">bool</span> skip</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;)</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;{</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;  <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> tarRefList = (<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>)(1 - curRefList);</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;  int32_t refIdxCur = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a8c0a668a25b6180c50283588b195fec8">symRefIdx</a>[curRefList];</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;  int32_t refIdxTar = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a8c0a668a25b6180c50283588b195fec8">symRefIdx</a>[tarRefList];</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160; </div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;  <a class="code" href="structvvenc_1_1MvField.html">MvField</a> cCurMvField, cTarMvField;</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;  cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>(curMv, refIdxCur);</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>&amp; amvpCur = amvpInfo[curRefList][refIdxCur];</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a>&amp; amvpTar = amvpInfo[tarRefList][refIdxTar];</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160; </div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;  <span class="keywordtype">double</span> fWeight = 0.0;</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> bufTmp;</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160; </div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;  <span class="comment">// get prediction of eCurRefPicList</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufA = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[curRefList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* picRefA = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>(curRefList, cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>);</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvA = cCurMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( mvA, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ac5bedb7997fc561b55c47c2f1713bb59">xPredInterBlk</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, picRefA, mvA, predBufA, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> ], <span class="keyword">false</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160; </div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;  bufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a152d389c7524c627fd78f149e531c54d">getBuf</a>( <a class="code" href="structvvenc_1_1UnitAreaRelative.html">UnitAreaRelative</a>( cu, cu ) );</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;  bufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#ae234f3d4d1911a5f0e1b61a5425c320f">copyFrom</a>( origBuf );</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;  bufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#af907ad3e49a30f4c2990626baf9bde6a">removeHighFreq</a>( predBufA, <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bClipForBiPredMeEnabled, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a><span class="comment">/*, getBcwWeight( cu.BcwIdx, tarRefList )*/</span> );</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;  fWeight = <a class="code" href="classvvenc_1_1InterSearch.html#a38fa18d30e9c51ef390aa273da0f2cc5">xGetMEDistortionWeight</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a>, tarRefList );</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160; </div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;  int32_t skipMvpIdx[2];</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;  skipMvpIdx[0] = skip ? mvpIdxSym[0] : -1;</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;  skipMvpIdx[1] = skip ? mvpIdxSym[1] : -1;</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160; </div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; amvpCur.<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; i++)</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;  {</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; amvpTar.<a class="code" href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; j++)</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;    {</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;      <span class="keywordflow">if</span> (skipMvpIdx[curRefList] == i &amp;&amp; skipMvpIdx[tarRefList] == j)</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160; </div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> cost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;      cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">setMvField</a>(curMv.<a class="code" href="classvvenc_1_1Mv.html#a13b80290d7963cd27cc751f73020a798">getSymmvdMv</a>(amvpCur.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i], amvpTar.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[j]), refIdxTar);</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160; </div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;      <span class="comment">// get prediction of eTarRefPicList</span></div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufB = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[tarRefList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* picRefB = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>(tarRefList, cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">refIdx</a>);</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvB = cTarMvField.<a class="code" href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">mv</a>;</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;      <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>( mvB, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a> );</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;      <a class="code" href="classvvenc_1_1InterPredInterpolation.html#ac5bedb7997fc561b55c47c2f1713bb59">xPredInterBlk</a>( <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, picRefB, mvB, predBufB, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[ <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a> ], <span class="keyword">false</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160; </div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;        <span class="comment">// calc distortion</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;      <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8">DFunc</a> distFunc = ( !cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">disableSATDForRd</a> ) ? <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8ac99f51755fff111dd7d5448a23cdd996">DF_HAD</a> : <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4f3ad87be4ac3fc12e60590dda8bf974">DF_SAD</a>;</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;      cost = ( <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> ) floor( fWeight * ( <span class="keywordtype">double</span> ) <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>( bufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), predBufB.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[ <a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a> ], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, distFunc ) );</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160; </div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = amvpCur.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i];</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;      pred.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>(pred);</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = curMv;</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;      mv.<a class="code" href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">changeTransPrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;      uint32_t bits = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>(mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0);</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;      bits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[i][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;      bits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[j][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      cost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(bits);</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;      <span class="keywordflow">if</span> (cost &lt; bestCost)</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;      {</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;        bestCost = cost;</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;        cMvPredSym[curRefList] = amvpCur.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[i];</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;        cMvPredSym[tarRefList] = amvpTar.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[j];</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;        mvpIdxSym[curRefList] = i;</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;        mvpIdxSym[tarRefList] = j;</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;      }</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;    }</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;  }</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;}</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160; </div>
<div class="line"><a name="l04706"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aa90c4598c609d56310a72938f1d4aa94"> 4706</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#aa90c4598c609d56310a72938f1d4aa94">InterSearch::resetSavedAffineMotion</a>()</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;{</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;  {</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    {</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#add89f792c489068f44461d536b5a62e7">acMvAffine4Para</a>[i][j] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(0, 0);</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a4dbcc7261c9dd98be00f210d30864789">acMvAffine6Para</a>[i][j] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(0, 0);</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;    }</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a4dbcc7261c9dd98be00f210d30864789">acMvAffine6Para</a>[i][2] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(0, 0);</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160; </div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#ae020ae260f3c6c7459d1264c96f43306">affine4ParaRefIdx</a>[i] = -1;</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a226ab6f3b39d18c621dc1d39bf320225">affine6ParaRefIdx</a>[i] = -1;</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;  }</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#adbc53a4a7c528639f9a617b825031205">affine4ParaAvail</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a84a2b6bad76fa5b695fcf78c3a0e2b91">affine6ParaAvail</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;}</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160; </div>
<div class="line"><a name="l04724"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a91007e4c7d30c0ad661ca2222874443b"> 4724</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a91007e4c7d30c0ad661ca2222874443b">InterSearch::storeAffineMotion</a>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a> acAffineMv[2][3], int16_t affineRefIdx[2], <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817">EAffineModel</a> affineType, <span class="keywordtype">int</span> BcwIdx)</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;{</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;  <span class="keywordflow">if</span> ((BcwIdx == <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> || !<a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a84a2b6bad76fa5b695fcf78c3a0e2b91">affine6ParaAvail</a>) &amp;&amp; affineType == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>)</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;  {</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    {</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++)</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;      {</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a4dbcc7261c9dd98be00f210d30864789">acMvAffine6Para</a>[i][j] = acAffineMv[i][j];</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      }</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a226ab6f3b39d18c621dc1d39bf320225">affine6ParaRefIdx</a>[i] = affineRefIdx[i];</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;    }</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a84a2b6bad76fa5b695fcf78c3a0e2b91">affine6ParaAvail</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;  }</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160; </div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;  <span class="keywordflow">if</span> ((BcwIdx == <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> || !<a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#adbc53a4a7c528639f9a617b825031205">affine4ParaAvail</a>) &amp;&amp; affineType == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">AFFINEMODEL_4PARAM</a>)</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;  {</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;    {</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      {</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#add89f792c489068f44461d536b5a62e7">acMvAffine4Para</a>[i][j] = acAffineMv[i][j];</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;      }</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#ae020ae260f3c6c7459d1264c96f43306">affine4ParaRefIdx</a>[i] = affineRefIdx[i];</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;    }</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#adbc53a4a7c528639f9a617b825031205">affine4ParaAvail</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;  }</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;}</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160; </div>
<div class="line"><a name="l04753"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a74b43514d85787c262e18084a20d61e1"> 4753</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a74b43514d85787c262e18084a20d61e1">InterSearch::xPredAffineInterSearch</a>( <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                                          <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp;    origBuf,</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;                                          <span class="keywordtype">int</span>             puIdx,</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                                          uint32_t&amp;       lastMode,</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;                                          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp;     affineCost,</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                                          <a class="code" href="classvvenc_1_1Mv.html">Mv</a>              hevcMv[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>],</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                                          <a class="code" href="classvvenc_1_1Mv.html">Mv</a>              mvAffine4Para[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>][3],</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                                          <span class="keywordtype">int</span>             refIdx4Para[2],</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;                                          uint8_t         BcwIdx,</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;                                          <span class="keywordtype">bool</span>            enforceBcwPred,</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;                                          uint32_t        BcwIdxBits )</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;{</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;  <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Slice.html">Slice</a> &amp;slice = *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>;</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160; </div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;  affineCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160; </div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>        cMvZero;</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>        aacMv[2][3];</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>        cMvBi[2][3];</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;  <a class="code" href="structvvenc_1_1AffineMVInfo.html">AffineMVInfo</a> tmp;</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160; </div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;  <span class="keywordtype">int</span>       iNumPredDir = slice.<a class="code" href="classvvenc_1_1Slice.html#a530d6092c6fac441ddd03762efdf5c2f">isInterP</a>() ? 1 : 2;</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160; </div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;  <span class="keywordtype">int</span> mvNum = 2;</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;  mvNum = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> ? 3 : 2;</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160; </div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;  <span class="comment">// Mvp</span></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>        cMvPred[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>][3];</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>        cMvPredBi[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>][3];</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;  <span class="keywordtype">int</span>       aaiMvpIdxBi[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;  <span class="keywordtype">int</span>       aaiMvpIdx[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;  <span class="keywordtype">int</span>       aaiMvpNum[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160; </div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;  <a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a> aacAffineAMVPInfo[2][<a class="code" href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">MAX_REF_PICS</a>];</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;  <a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a> affiAMVPInfoTemp[2];</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160; </div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;  uint32_t      uiMbBits[3] = { 1, 1, 0 };</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;  <span class="keywordtype">int</span>           iRefIdx[2] = { 0,0 }; <span class="comment">// If un-initialized, may cause SEGV in bi-directional prediction iterative stage.</span></div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;  <span class="keywordtype">int</span>           iRefIdxBi[2];</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;  <span class="keywordtype">int</span>           iRefStart, iRefEnd;</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;  <span class="keywordtype">int</span>           bestBiPRefIdxL1 = 0;</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;  <span class="keywordtype">int</span>           bestBiPMvpL1 = 0;</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>    biPDistTemp = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160; </div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>    uiCost[2] = { <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>, <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a> };</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>    uiCostBi = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>    uiCostTemp;</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160; </div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;  uint32_t      uiBits[3] = { 0 };</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;  uint32_t      uiBitsTemp;</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>    bestBiPDist = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160; </div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>    uiCostTempL0[<a class="code" href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">MAX_NUM_REF</a>];</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iNumRef = 0; iNumRef &lt; <a class="code" href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">MAX_NUM_REF</a>; iNumRef++)</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;  {</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;    uiCostTempL0[iNumRef] = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;  }</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;  uint32_t      uiBitsTempL0[<a class="code" href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">MAX_NUM_REF</a>];</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160; </div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>            mvValidList1[4];</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;  <span class="keywordtype">int</span>           refIdxValidList1 = 0;</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;  uint32_t      bitsValidList1 = <a class="code" href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">MAX_UINT</a>;</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>    costValidList1 = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>            mvHevc[3];</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>    affineAmvrEnabled = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160; </div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#af67498245b43d85d1afe6c053a4eb1b6">xGetBlkBits</a>(slice.<a class="code" href="classvvenc_1_1Slice.html#a530d6092c6fac441ddd03762efdf5c2f">isInterP</a>(), puIdx, lastMode, uiMbBits);</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160; </div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;  cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ad036b5eb236ab3725436ece9cbf93e57">affine</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#ab2f1d06341e47118fffe7a0b2a9e0464">mergeFlag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aa764a07618a4b6a317c48cc352d99111">regularMergeFlag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;  <span class="keywordflow">if</span> (BcwIdx != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>)</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;  {</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> = BcwIdx;</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;  }</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160; </div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;  <span class="comment">// Uni-directional prediction</span></div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iRefList = 0; iRefList &lt; iNumPredDir; iRefList++)</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;  {</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;    <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>  refPicList = (iRefList ? <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> : <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>);</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = (iRefList ? 2 : 1);</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iRefIdxTemp = 0; iRefIdxTemp &lt; slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[refPicList]; iRefIdxTemp++)</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;    {</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      <span class="comment">// Get RefIdx bits</span></div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;      uiBitsTemp = uiMbBits[iRefList];</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;      <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[refPicList] &gt; 1)</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;      {</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;        uiBitsTemp += iRefIdxTemp + 1;</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;        <span class="keywordflow">if</span> (iRefIdxTemp == slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[refPicList] - 1)</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;        {</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;          uiBitsTemp--;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;        }</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;      }</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160; </div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <span class="comment">// Do Affine AMVP</span></div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a1c8d4c0817299ee000cd3a3679a6d52d">xEstimateAffineAMVP</a>(cu, affiAMVPInfoTemp[refPicList], origBuf, refPicList, iRefIdxTemp, cMvPred[iRefList][iRefIdxTemp], biPDistTemp);</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <span class="keywordflow">if</span> (affineAmvrEnabled)</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      {</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;        biPDistTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(<a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, cMvPred[iRefList][iRefIdxTemp], cMvPred[iRefList][iRefIdxTemp]));</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      }</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      aaiMvpIdx[iRefList][iRefIdxTemp] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[refPicList];</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      aaiMvpNum[iRefList][iRefIdxTemp] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[refPicList];;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a> &amp;&amp; refIdx4Para[iRefList] != iRefIdxTemp)</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;      {</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">xCopyAffineAMVPInfo</a>(affiAMVPInfoTemp[refPicList], aacAffineAMVPInfo[iRefList][iRefIdxTemp]);</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;      }</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160; </div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      <span class="comment">// set hevc ME result as start search position when it is best than mvp</span></div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;3; i++)</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;      {</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;        mvHevc[i] = hevcMv[iRefList][iRefIdxTemp];</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;        mvHevc[i].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;      }</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;      <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBuf = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>(cu);</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160; </div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;      <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiCandCost = <a class="code" href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9">xGetAffineTemplateCost</a>(cu, origBuf, predBuf, mvHevc, aaiMvpIdx[iRefList][iRefIdxTemp],</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;        <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>, refPicList, iRefIdxTemp);</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160; </div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;      <span class="keywordflow">if</span> (affineAmvrEnabled)</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;      {</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;        uiCandCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(<a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, mvHevc, cMvPred[iRefList][iRefIdxTemp]));</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      }</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160; </div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;      <span class="comment">//check stored affine motion</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;      <span class="keywordtype">bool</span> affine4Para = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">AFFINEMODEL_4PARAM</a>;</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;      <span class="keywordtype">bool</span> savedParaAvail = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> &amp;&amp; ((<a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#ae020ae260f3c6c7459d1264c96f43306">affine4ParaRefIdx</a>[iRefList] == iRefIdxTemp &amp;&amp; affine4Para &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#adbc53a4a7c528639f9a617b825031205">affine4ParaAvail</a>) ||</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        (<a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a226ab6f3b39d18c621dc1d39bf320225">affine6ParaRefIdx</a>[iRefList] == iRefIdxTemp &amp;&amp; !affine4Para &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a84a2b6bad76fa5b695fcf78c3a0e2b91">affine6ParaAvail</a>));</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160; </div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;      <span class="keywordflow">if</span> (savedParaAvail)</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;      {</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;        <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvFour[3];</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mvNum; i++)</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;        {</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;          mvFour[i] = affine4Para ? <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#add89f792c489068f44461d536b5a62e7">acMvAffine4Para</a>[iRefList][i] : <a class="code" href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">m_affineMotion</a>.<a class="code" href="structvvenc_1_1EncAffineMotion.html#a4dbcc7261c9dd98be00f210d30864789">acMvAffine6Para</a>[iRefList][i];</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;          mvFour[i].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;        }</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160; </div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;        <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> candCostInherit = <a class="code" href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9">xGetAffineTemplateCost</a>(cu, origBuf, predBuf, mvFour, aaiMvpIdx[iRefList][iRefIdxTemp], <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>, refPicList, iRefIdxTemp);</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        candCostInherit += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(<a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, mvFour, cMvPred[iRefList][iRefIdxTemp]));</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160; </div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;        <span class="keywordflow">if</span> (candCostInherit &lt; uiCandCost)</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;        {</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;          uiCandCost = candCostInherit;</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;          memcpy(mvHevc, mvFour, 3 * <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>));</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;        }</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;      }</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160; </div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;      <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">AFFINEMODEL_4PARAM</a> &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#add4fcdf487f8ef726f83fcc91719350f">m_affMVListSize</a> &amp;&amp; (!cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> || BcwIdx == <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> ) )</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      {</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;        <span class="keywordtype">int</span> shift = <a class="code" href="namespacevvenc.html#a00ea24186f746c566300adaf3b8668a7">MAX_CU_DEPTH</a>;</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#add4fcdf487f8ef726f83fcc91719350f">m_affMVListSize</a>; i++)</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;        {</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;          <a class="code" href="structvvenc_1_1AffineMVInfo.html">AffineMVInfo</a> *mvInfo = <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#a708dd38ca21b6001d06e0e7bd8f8ceca">m_affMVList</a> + ((<a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#a831eed65684e7d8b7a3cde1b07b64b0a">m_affMVListIdx</a> - i - 1 + <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#afb452971293b331a7627fe79642904df">m_affMVListMaxSize</a>) % (<a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#afb452971293b331a7627fe79642904df">m_affMVListMaxSize</a>));</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;          <span class="comment">//check;</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;          <span class="keywordtype">int</span> j = 0;</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;          <span class="keywordflow">for</span> (; j &lt; i; j++)</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;          {</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;            <a class="code" href="structvvenc_1_1AffineMVInfo.html">AffineMVInfo</a> *prevMvInfo = <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#a708dd38ca21b6001d06e0e7bd8f8ceca">m_affMVList</a> + ((<a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#a831eed65684e7d8b7a3cde1b07b64b0a">m_affMVListIdx</a> - j - 1 + <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#afb452971293b331a7627fe79642904df">m_affMVListMaxSize</a>) % (<a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#afb452971293b331a7627fe79642904df">m_affMVListMaxSize</a>));</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;            <span class="keywordflow">if</span> ((mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp][0] == prevMvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp][0]) &amp;&amp;</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;              (mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp][1] == prevMvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp][1])</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;              &amp;&amp; (mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> == prevMvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>) &amp;&amp; (mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> == prevMvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>)</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;              &amp;&amp; (mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#aac374e320caaadeca4874add33b62af2">w</a> == prevMvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#aac374e320caaadeca4874add33b62af2">w</a>)</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;              )</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;            {</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;            }</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;          }</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;          <span class="keywordflow">if</span> (j &lt; i)</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160; </div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvTmp[3], *nbMv = mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp];</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;          <span class="keywordtype">int</span> vx, vy;</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;          <span class="keywordtype">int</span> dMvHorX, dMvHorY, dMvVerX, dMvVerY;</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;          <span class="keywordtype">int</span> mvScaleHor = nbMv[0].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &lt;&lt; shift;</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;          <span class="keywordtype">int</span> mvScaleVer = nbMv[0].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &lt;&lt; shift;</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> dMv = nbMv[1] - nbMv[0];</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;          dMvHorX = dMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &lt;&lt; (shift - <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>(mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#aac374e320caaadeca4874add33b62af2">w</a>));</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;          dMvHorY = dMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &lt;&lt; (shift - <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>(mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#aac374e320caaadeca4874add33b62af2">w</a>));</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;          dMvVerX = -dMvHorY;</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;          dMvVerY = dMvHorX;</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;          vx = mvScaleHor + dMvHorX * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>) + dMvVerX * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>);</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;          vy = mvScaleVer + dMvHorY * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>) + dMvVerY * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>);</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;          <a class="code" href="namespacevvenc.html#a73942a45402ce654d35f505f148b08fb">roundAffineMv</a>(vx, vy, shift);</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;          mvTmp[0] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(vx, vy);</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;          mvTmp[0].<a class="code" href="classvvenc_1_1Mv.html#ac541e4f875501dce06e356504d2283cc">clipToStorageBitDepth</a>();</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;          <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(mvTmp[0], cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;          mvTmp[0].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;          vx = mvScaleHor + dMvHorX * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> + cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>) + dMvVerX * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>);</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;          vy = mvScaleVer + dMvHorY * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> + cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>) + dMvVerY * (cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> - mvInfo-&gt;<a class="code" href="structvvenc_1_1AffineMVInfo.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>);</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;          <a class="code" href="namespacevvenc.html#a73942a45402ce654d35f505f148b08fb">roundAffineMv</a>(vx, vy, shift);</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;          mvTmp[1] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(vx, vy);</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;          mvTmp[1].<a class="code" href="classvvenc_1_1Mv.html#ac541e4f875501dce06e356504d2283cc">clipToStorageBitDepth</a>();</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;          <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(mvTmp[1], cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;          mvTmp[0].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;          mvTmp[1].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> tmpCost = <a class="code" href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9">xGetAffineTemplateCost</a>(cu, origBuf, predBuf, mvTmp, aaiMvpIdx[iRefList][iRefIdxTemp], <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>, refPicList, iRefIdxTemp);</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;          <span class="keywordflow">if</span> (affineAmvrEnabled)</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;          {</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;            tmpCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(<a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, mvTmp, cMvPred[iRefList][iRefIdxTemp]));</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;          }</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;          <span class="keywordflow">if</span> (tmpCost &lt; uiCandCost)</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;          {</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;            uiCandCost = tmpCost;</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;            std::memcpy(mvHevc, mvTmp, 3 * <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>));</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;          }</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;        }</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;      }</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>)</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;      {</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;        <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvFour[3];</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;        mvFour[0] = mvAffine4Para[iRefList][iRefIdxTemp][0];</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;        mvFour[1] = mvAffine4Para[iRefList][iRefIdxTemp][1];</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;        mvAffine4Para[iRefList][iRefIdxTemp][0].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;        mvAffine4Para[iRefList][iRefIdxTemp][1].roundAffinePrecInternal2Amvr(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160; </div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;        <span class="keywordtype">int</span> shift = <a class="code" href="namespacevvenc.html#a00ea24186f746c566300adaf3b8668a7">MAX_CU_DEPTH</a>;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;        <span class="keywordtype">int</span> vx2 = (mvFour[0].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &lt;&lt; shift) - ((mvFour[1].ver - mvFour[0].ver) &lt;&lt; (shift + <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>()) - <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>())));</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;        <span class="keywordtype">int</span> vy2 = (mvFour[0].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &lt;&lt; shift) + ((mvFour[1].hor - mvFour[0].hor) &lt;&lt; (shift + <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>()) - <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>())));</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;        <span class="keywordtype">int</span> offset = (1 &lt;&lt; (shift - 1));</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;        vx2 = (vx2 + offset - (vx2 &gt;= 0)) &gt;&gt; shift;</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;        vy2 = (vy2 + offset - (vy2 &gt;= 0)) &gt;&gt; shift;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;        mvFour[2].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> = vx2;</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;        mvFour[2].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> = vy2;</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;        mvFour[2].<a class="code" href="classvvenc_1_1Mv.html#ac541e4f875501dce06e356504d2283cc">clipToStorageBitDepth</a>();</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;        mvFour[0].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;        mvFour[1].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;        mvFour[2].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;        <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiCandCostInherit = <a class="code" href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9">xGetAffineTemplateCost</a>(cu, origBuf, predBuf, mvFour, aaiMvpIdx[iRefList][iRefIdxTemp], <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>, refPicList, iRefIdxTemp);</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;        <span class="keywordflow">if</span> (affineAmvrEnabled)</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;        {</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;          uiCandCostInherit += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(<a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, mvFour, cMvPred[iRefList][iRefIdxTemp]));</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;        }</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;        <span class="keywordflow">if</span> (uiCandCostInherit &lt; uiCandCost)</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;        {</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;          uiCandCost = uiCandCostInherit;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;          {</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;            mvHevc[i] = mvFour[i];</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;          }</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;        }</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;      }</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160; </div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      <span class="keywordflow">if</span> (uiCandCost &lt; biPDistTemp)</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;      {</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;        ::memcpy(tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], mvHevc, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      }</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;      {</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;        ::memcpy(tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], cMvPred[iRefList][iRefIdxTemp], <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;      }</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160; </div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;      <span class="comment">// GPB list 1, save the best MvpIdx, RefIdx and Cost</span></div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;      <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a> &amp;&amp; iRefList == 1 &amp;&amp; biPDistTemp &lt; bestBiPDist)</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;      {</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;        bestBiPDist = biPDistTemp;</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;        bestBiPMvpL1 = aaiMvpIdx[iRefList][iRefIdxTemp];</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;        bestBiPRefIdxL1 = iRefIdxTemp;</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;      }</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160; </div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      <span class="comment">// Update bits</span></div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      uiBitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[aaiMvpIdx[iRefList][iRefIdxTemp]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160; </div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bFastMEForGenBLowDelayEnabled &amp;&amp; iRefList == 1)   <span class="comment">// list 1</span></div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;      {</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;        <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[iRefIdxTemp] &gt;= 0 &amp;&amp; (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> != <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a> || slice.<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[iRefIdxTemp] == refIdx4Para[0]))</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;        {</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;          <span class="keywordtype">int</span> iList1ToList0Idx = slice.<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[iRefIdxTemp];</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;          ::memcpy(tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[1][iRefIdxTemp], tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[0][iList1ToList0Idx], <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;          uiCostTemp = uiCostTempL0[iList1ToList0Idx];</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160; </div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;          uiCostTemp -= <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(uiBitsTempL0[iList1ToList0Idx]);</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;          uiBitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], cMvPred[iRefList][iRefIdxTemp]);</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;          <span class="comment">/*calculate the correct cost*/</span></div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;          uiCostTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(uiBitsTemp);</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;          <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) uiCostTemp=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiCostTemp);</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;        }</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;        {</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a44e957b819a43dba1f284e80d49809f4">xAffineMotionEstimation</a>(cu, origBuf, refPicList, cMvPred[iRefList][iRefIdxTemp], iRefIdxTemp, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], </div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;                                  uiBitsTemp, uiCostTemp, aaiMvpIdx[iRefList][iRefIdxTemp], affiAMVPInfoTemp[refPicList]);</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;        }</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      }</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      {</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a44e957b819a43dba1f284e80d49809f4">xAffineMotionEstimation</a>(cu, origBuf, refPicList, cMvPred[iRefList][iRefIdxTemp], iRefIdxTemp, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], </div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;                                uiBitsTemp, uiCostTemp, aaiMvpIdx[iRefList][iRefIdxTemp], affiAMVPInfoTemp[refPicList]);</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      }</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      </div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;      <span class="keywordflow">if</span>( slice.<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> == <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> &amp;&amp; slice.<a class="code" href="classvvenc_1_1Slice.html#a2df1dd5ac8070482b6042070f73cffa4">isInterB</a>() )</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      {</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a177bef416654af38fd196cb0cb96a1c8">setReadModeAffine</a>( <span class="keyword">true</span>, (uint8_t)iRefList, (uint8_t)iRefIdxTemp, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> );</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">m_uniMotions</a>.<a class="code" href="classvvenc_1_1BcwMotionParam.html#a3c5f47d1cb0d7e4ef40d949ad2c12ba7">copyAffineMvFrom</a>( tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], uiCostTemp - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(uiBitsTemp), (uint8_t)iRefList, (uint8_t)iRefIdxTemp, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a>,</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                                       aaiMvpIdx[iRefList][iRefIdxTemp] );</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;      }</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160; </div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;      <span class="comment">// Set best AMVP Index</span></div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">xCopyAffineAMVPInfo</a>(affiAMVPInfoTemp[refPicList], aacAffineAMVPInfo[iRefList][iRefIdxTemp]);</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> != 2)<span class="comment">//|| !m_pcEncCfg-&gt;getUseAffineAmvrEncOpt())</span></div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a684f4005176cc6580b29960d10514bcb">xCheckBestAffineMVP</a>(cu, affiAMVPInfoTemp[refPicList], refPicList, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], cMvPred[iRefList][iRefIdxTemp], aaiMvpIdx[iRefList][iRefIdxTemp], uiBitsTemp, uiCostTemp);</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160; </div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;      <span class="keywordflow">if</span> (iRefList == 0)</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;      {</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;        uiCostTempL0[iRefIdxTemp] = uiCostTemp;</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;        uiBitsTempL0[iRefIdxTemp] = uiBitsTemp;</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;      }</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;      <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) uiCostTemp=%d, uiCost[iRefList]=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiCostTemp, uiCost[iRefList]);</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;      <span class="keywordflow">if</span> (uiCostTemp &lt; uiCost[iRefList])</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      {</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;        uiCost[iRefList] = uiCostTemp;</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;        uiBits[iRefList] = uiBitsTemp; <span class="comment">// storing for bi-prediction</span></div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160; </div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;                                       <span class="comment">// set best motion</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;        ::memcpy(aacMv[iRefList], tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;        iRefIdx[iRefList] = iRefIdxTemp;</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      }</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160; </div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      <span class="keywordflow">if</span> (iRefList == 1 &amp;&amp; uiCostTemp &lt; costValidList1 &amp;&amp; slice.<a class="code" href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">list1IdxToList0Idx</a>[iRefIdxTemp] &lt; 0)</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;      {</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;        costValidList1 = uiCostTemp;</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;        bitsValidList1 = uiBitsTemp;</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160; </div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;        <span class="comment">// set motion</span></div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;        memcpy(mvValidList1, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;        refIdxValidList1 = iRefIdxTemp;</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;      }</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;    } <span class="comment">// End refIdx loop</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;  } <span class="comment">// end Uni-prediction</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160; </div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">AFFINEMODEL_4PARAM</a>)</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;  {</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;    ::memcpy(mvAffine4Para, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>, <span class="keyword">sizeof</span>(tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>));</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;    <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 0)</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;    {</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">m_AffineProfList</a>-&gt;<a class="code" href="structvvenc_1_1AffineProfList.html#a99bcba6d9e68123d5703e06d6d0243c3">insert</a>( tmp, cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>());</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;    }</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;  }</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160; </div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;  <span class="comment">// Bi-directional prediction</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;  <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a2df1dd5ac8070482b6042070f73cffa4">isInterB</a>() &amp;&amp; !<a class="code" href="namespacevvenc_1_1CU.html#a7c89d15e3cd1f22016e3c0c3f506b9ca">CU::isBipredRestriction</a>(cu))</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;  {</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 3;</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#aab9964fa91dda0ff5c13d2ac3c4d32a8">m_isBi</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160; </div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;    <span class="comment">// Set as best list0 and list1</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    iRefIdxBi[0] = iRefIdx[0];</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;    iRefIdxBi[1] = iRefIdx[1];</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160; </div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;    ::memcpy(cMvBi, aacMv, <span class="keyword">sizeof</span>(aacMv));</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;    ::memcpy(cMvPredBi, cMvPred, <span class="keyword">sizeof</span>(cMvPred));</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;    ::memcpy(aaiMvpIdxBi, aaiMvpIdx, <span class="keyword">sizeof</span>(aaiMvpIdx));</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160; </div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;    uint32_t uiMotBits[2];</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    <span class="keywordtype">bool</span> doBiPred = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160; </div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>) <span class="comment">// GPB, list 1 only use Mvp</span></div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;    {</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">xCopyAffineAMVPInfo</a>(aacAffineAMVPInfo[1][bestBiPRefIdxL1], affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>]);</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = bestBiPMvpL1;</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;      aaiMvpIdxBi[1][bestBiPRefIdxL1] = bestBiPMvpL1;</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160; </div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;      <span class="comment">// Set Mv for list1</span></div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pcMvTemp[3] = { affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>].<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[bestBiPMvpL1],</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;                         affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>].<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[bestBiPMvpL1],</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;                         affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>].<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[bestBiPMvpL1] };</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;      ::memcpy(cMvPredBi[1][bestBiPRefIdxL1], pcMvTemp, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;      ::memcpy(cMvBi[1], pcMvTemp, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      ::memcpy(tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[1][bestBiPRefIdxL1], pcMvTemp, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      iRefIdxBi[1] = bestBiPRefIdxL1;</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160; </div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      <span class="comment">// Get list1 prediction block</span></div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;      <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, cMvBi[1][0], cMvBi[1][1], cMvBi[1][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>);</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = iRefIdxBi[1];</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160; </div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;      <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;      <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>(cu, predBufTmp, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>);</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160; </div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;      <span class="comment">// Update bits</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;      uiMotBits[0] = uiBits[0] - uiMbBits[0];</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;      uiMotBits[1] = uiMbBits[1];</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160; </div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;      <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] &gt; 1)</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;      {</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;        uiMotBits[1] += bestBiPRefIdxL1 + 1;</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;        <span class="keywordflow">if</span> (bestBiPRefIdxL1 == slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] - 1)</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;        {</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;          uiMotBits[1]--;</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;        }</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;      }</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;      uiMotBits[1] += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[aaiMvpIdxBi[1][bestBiPRefIdxL1]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;      uiBits[2] = uiMbBits[2] + uiMotBits[0] + uiMotBits[1];</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;    }</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;    {</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;      uiMotBits[0] = uiBits[0] - uiMbBits[0];</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      uiMotBits[1] = uiBits[1] - uiMbBits[1];</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;      uiBits[2] = uiMbBits[2] + uiMotBits[0] + uiMotBits[1];</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;    }</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160; </div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;    <span class="keywordflow">if</span> (doBiPred)</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;    {</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;      <span class="comment">// 4-times iteration (default)</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;      <span class="keywordtype">int</span> iNumIter = 4;</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;      <span class="comment">// fast encoder setting or GPB: only one iteration</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE1 || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE2 || slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>)</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;      {</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;        iNumIter = 1;</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;      }</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160; </div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIter = 0; iIter &lt; iNumIter; iIter++)</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      {</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;        <span class="comment">// Set RefList</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;        <span class="keywordtype">int</span> iRefList = iIter % 2;</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE1 || <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_fastInterSearchMode == VVENC_FASTINTERSEARCH_MODE2)</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;        {</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;          <span class="keywordflow">if</span> (uiCost[0] &lt;= uiCost[1])</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;          {</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;            iRefList = 1;</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;          }</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;          {</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;            iRefList = 0;</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;          }</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;        }</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iIter == 0)</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;        {</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;          iRefList = 0;</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;        }</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160; </div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;        <span class="comment">// First iterate, get prediction block of opposite direction</span></div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;        <span class="keywordflow">if</span> (iIter == 0 &amp;&amp; !slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>)</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;        {</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;          <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, aacMv[1 - iRefList][0], aacMv[1 - iRefList][1], aacMv[1 - iRefList][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>(1 - iRefList));</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;          cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[1 - iRefList] = iRefIdx[1 - iRefList];</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160; </div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;          <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[1 - iRefList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;          <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>(cu, predBufTmp, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>(1 - iRefList));</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;        }</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160; </div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;        <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList = (iRefList ? <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> : <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>);</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160; </div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;        <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>) <span class="comment">// GPB, fix List 1, search List 0</span></div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;        {</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;          iRefList = 0;</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;          refPicList = <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>;</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;        }</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160; </div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;        <span class="keywordtype">bool</span> bChanged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160; </div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;        iRefStart = 0;</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;        iRefEnd = slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[refPicList] - 1;</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iRefIdxTemp = iRefStart; iRefIdxTemp &lt;= iRefEnd; iRefIdxTemp++)</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;        {</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;          <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a> &amp;&amp; refIdx4Para[iRefList] != iRefIdxTemp)</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;          {</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;          }</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;          <span class="comment">// update bits</span></div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;          uiBitsTemp = uiMbBits[2] + uiMotBits[1 - iRefList];</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;          uiBitsTemp += ( (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> == <span class="keyword">true</span>) ? BcwIdxBits : 0 );</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;          <span class="keywordflow">if</span> (slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[refPicList] &gt; 1)</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;          {</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;            uiBitsTemp += iRefIdxTemp + 1;</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;            <span class="keywordflow">if</span> (iRefIdxTemp == slice.<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[refPicList] - 1)</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;            {</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;              uiBitsTemp--;</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;            }</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;          }</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;          uiBitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[aaiMvpIdxBi[iRefList][iRefIdxTemp]][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160; </div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;          <span class="comment">// call Affine ME</span></div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a44e957b819a43dba1f284e80d49809f4">xAffineMotionEstimation</a>(cu, origBuf, refPicList, cMvPredBi[iRefList][iRefIdxTemp], iRefIdxTemp, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], </div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;                                  uiBitsTemp, uiCostTemp, aaiMvpIdxBi[iRefList][iRefIdxTemp], aacAffineAMVPInfo[iRefList][iRefIdxTemp], <span class="keyword">true</span>);</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">xCopyAffineAMVPInfo</a>(aacAffineAMVPInfo[iRefList][iRefIdxTemp], affiAMVPInfoTemp[refPicList]);</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;          <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> != 2)</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;          {</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a684f4005176cc6580b29960d10514bcb">xCheckBestAffineMVP</a>(cu, affiAMVPInfoTemp[refPicList], refPicList, tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], cMvPredBi[iRefList][iRefIdxTemp], aaiMvpIdxBi[iRefList][iRefIdxTemp], uiBitsTemp, uiCostTemp);</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;          }</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160; </div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;          <span class="keywordflow">if</span> (uiCostTemp &lt; uiCostBi)</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;          {</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;            bChanged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;            ::memcpy(cMvBi[iRefList], tmp.<a class="code" href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">affMVs</a>[iRefList][iRefIdxTemp], <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;            iRefIdxBi[iRefList] = iRefIdxTemp;</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160; </div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;            uiCostBi = uiCostTemp;</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;            uiMotBits[iRefList] = uiBitsTemp - uiMbBits[2] - uiMotBits[1 - iRefList];</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;            uiMotBits[iRefList] -= ( (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> == <span class="keyword">true</span>) ? BcwIdxBits : 0 );</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;            uiBits[2] = uiBitsTemp;</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160; </div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;            <span class="keywordflow">if</span> (iNumIter != 1) <span class="comment">// MC for next iter</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;            {</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;              <span class="comment">//  Set motion</span></div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;              <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, cMvBi[iRefList][0], cMvBi[iRefList][1], cMvBi[iRefList][2], refPicList);</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;              cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[refPicList] = iRefIdxBi[refPicList];</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;              <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[iRefList].<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;              <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>(cu, predBufTmp, refPicList);</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;            }</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;          }</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;        } <span class="comment">// for loop-iRefIdxTemp</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160; </div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;        <span class="keywordflow">if</span> (!bChanged)</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;        {</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;          <span class="keywordflow">if</span> ((uiCostBi &lt;= uiCost[0] &amp;&amp; uiCostBi &lt;= uiCost[1]) || enforceBcwPred)</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;          {</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">xCopyAffineAMVPInfo</a>(aacAffineAMVPInfo[0][iRefIdxBi[0]], affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>]);</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a684f4005176cc6580b29960d10514bcb">xCheckBestAffineMVP</a>(cu, affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>, cMvBi[0], cMvPredBi[0][iRefIdxBi[0]], aaiMvpIdxBi[0][iRefIdxBi[0]], uiBits[2], uiCostBi);</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160; </div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;            <span class="keywordflow">if</span> (!slice.<a class="code" href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">picHeader</a>-&gt;<a class="code" href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">mvdL1Zero</a>)</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;            {</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">xCopyAffineAMVPInfo</a>(aacAffineAMVPInfo[1][iRefIdxBi[1]], affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>]);</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;              <a class="code" href="classvvenc_1_1InterSearch.html#a684f4005176cc6580b29960d10514bcb">xCheckBestAffineMVP</a>(cu, affiAMVPInfoTemp[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>, cMvBi[1], cMvPredBi[1][iRefIdxBi[1]], aaiMvpIdxBi[1][iRefIdxBi[1]], uiBits[2], uiCostBi);</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;            }</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;          }</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;        }</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      } <span class="comment">// for loop-iter</span></div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;    }</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#aab9964fa91dda0ff5c13d2ac3c4d32a8">m_isBi</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;  } <span class="comment">// if (B_SLICE)</span></div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160; </div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>();</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a> [<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>();</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMvZero;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][0] = cMvZero;</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = <a class="code" href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">NOT_VALID</a>;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160; </div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> verIdx = 0; verIdx &lt; 3; verIdx++)</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;  {</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][verIdx] = cMvZero;</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][verIdx] = cMvZero;</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;  }</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160; </div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;  <span class="comment">// Set Motion Field</span></div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;  memcpy(aacMv[1], mvValidList1, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;  iRefIdx[1] = refIdxValidList1;</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;  uiBits[1] = bitsValidList1;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;  uiCost[1] = costValidList1;</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160; </div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;  <span class="keywordflow">if</span> (enforceBcwPred)</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;  {</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;    uiCost[0] = uiCost[1] = <a class="code" href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">MAX_UINT</a>;</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;  }</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160; </div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;  <span class="comment">// Affine ME result set</span></div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;  <span class="keywordflow">if</span> (uiCostBi &lt;= uiCost[0] &amp;&amp; uiCostBi &lt;= uiCost[1]) <span class="comment">// Bi</span></div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;  {</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;    lastMode = 2;</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;    affineCost = uiCostBi;</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 3;</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;    <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, cMvBi[0][0], cMvBi[0][1], cMvBi[0][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>);</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;    <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, cMvBi[1][0], cMvBi[1][1], cMvBi[1][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>);</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = iRefIdxBi[0];</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = iRefIdxBi[1];</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160; </div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> verIdx = 0; verIdx &lt; mvNum; verIdx++)</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;    {</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][verIdx] = cMvBi[0][verIdx] - cMvPredBi[0][iRefIdxBi[0]][verIdx];</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][verIdx] = cMvBi[1][verIdx] - cMvPredBi[1][iRefIdxBi[1]][verIdx];</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;      <span class="keywordflow">if</span> (verIdx != 0)</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;      {</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[0][verIdx] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[0][verIdx] - cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[0][0];</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[1][verIdx] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[1][verIdx] - cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[1][0];</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;      }</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;    }</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160; </div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160; </div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpIdxBi[0][iRefIdxBi[0]];</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpNum[0][iRefIdxBi[0]];</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpIdxBi[1][iRefIdxBi[1]];</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpNum[1][iRefIdxBi[1]];</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;  }</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (uiCost[0] &lt;= uiCost[1]) <span class="comment">// List 0</span></div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;  {</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;    lastMode = 0;</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;    affineCost = uiCost[0];</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 1;</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;    <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, aacMv[0][0], aacMv[0][1], aacMv[0][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>);</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = iRefIdx[0];</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160; </div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> verIdx = 0; verIdx &lt; mvNum; verIdx++)</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;    {</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][verIdx] = aacMv[0][verIdx] - cMvPred[0][iRefIdx[0]][verIdx];</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;      <span class="keywordflow">if</span> (verIdx != 0)</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;      {</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[0][verIdx] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[0][verIdx] - cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[0][0];</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;      }</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;    }</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160; </div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpIdx[0][iRefIdx[0]];</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = aaiMvpNum[0][iRefIdx[0]];</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;  }</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;  {</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;    lastMode = 1;</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;    affineCost = uiCost[1];</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 2;</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;    <a class="code" href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">CU::setAllAffineMv</a>(cu, aacMv[1][0], aacMv[1][1], aacMv[1][2], <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>);</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = iRefIdx[1];</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160; </div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> verIdx = 0; verIdx &lt; mvNum; verIdx++)</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;    {</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;      cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>][verIdx] = aacMv[1][verIdx] - cMvPred[1][iRefIdx[1]][verIdx];</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;      <span class="keywordflow">if</span> (verIdx != 0)</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;      {</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;        cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[1][verIdx] = cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[1][verIdx] - cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[1][0];</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      }</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;    }</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160; </div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpIdx[1][iRefIdx[1]];</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a>] = aaiMvpNum[1][iRefIdx[1]];</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;  }</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;  <span class="keywordflow">if</span> (BcwIdx != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>)</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;  {</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> = <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a>;</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;  }</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;}</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160; </div>
<div class="line"><a name="l05376"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9"> 5376</a></span>&#160;<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> <a class="code" href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9">InterSearch::xGetAffineTemplateCost</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf, <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>&amp; predBuf, <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvCand[3], <span class="keywordtype">int</span> iMVPIdx, <span class="keywordtype">int</span> iMVPNum, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <span class="keywordtype">int</span> iRefIdx)</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;{</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160; </div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* picRef = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>(refPicList, iRefIdx);</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160; </div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;  <span class="comment">// prediction pattern</span></div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv[3];</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;  memcpy(mv, acMvCand, <span class="keyword">sizeof</span>(mv));</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#aed661f58d6fe05e1522dfab76c0d27ec">xPredAffineBlk</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, picRef, mv, predBuf, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>], refPicList);</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160; </div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;  <span class="comment">// calc distortion</span></div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;  <span class="keyword">enum</span> <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8">DFunc</a> distFunc = (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">disableSATDForRd</a>) ? <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4f3ad87be4ac3fc12e60590dda8bf974">DF_SAD</a> : <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8ac99f51755fff111dd7d5448a23cdd996">DF_HAD</a>;</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;  uiCost = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(origBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a>], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a></div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;    , distFunc</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;  );</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;  uiCost += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[iMVPIdx][iMVPNum]);</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160; </div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) affineTemplateCost=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiCost);</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;  <span class="keywordflow">return</span> uiCost;</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;}</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160; </div>
<div class="line"><a name="l05398"></a><span class="lineno"><a class="line" href="namespacevvenc.html#addfbcd7236d485fdef78287e1c6693d6"> 5398</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacevvenc.html#addfbcd7236d485fdef78287e1c6693d6">solveEqual</a>(<span class="keywordtype">double</span>** dEqualCoeff, <span class="keywordtype">int</span> iOrder, <span class="keywordtype">double</span>* dAffinePara)</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;{</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; iOrder; k++)</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;  {</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;    dAffinePara[k] = 0.;</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;  }</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160; </div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;  <span class="comment">// row echelon</span></div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; iOrder; i++)</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;  {</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;    <span class="comment">// find column max</span></div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    <span class="keywordtype">double</span> temp = fabs(dEqualCoeff[i][i - 1]);</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;    <span class="keywordtype">int</span> tempIdx = i;</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; iOrder + 1; j++)</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;    {</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;      <span class="keywordflow">if</span> (fabs(dEqualCoeff[j][i - 1]) &gt; temp)</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;      {</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;        temp = fabs(dEqualCoeff[j][i - 1]);</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;        tempIdx = j;</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      }</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;    }</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160; </div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;    <span class="comment">// swap line</span></div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;    <span class="keywordflow">if</span> (tempIdx != i)</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;    {</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; iOrder + 1; j++)</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;      {</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;        dEqualCoeff[0][j] = dEqualCoeff[i][j];</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;        dEqualCoeff[i][j] = dEqualCoeff[tempIdx][j];</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;        dEqualCoeff[tempIdx][j] = dEqualCoeff[0][j];</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;      }</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;    }</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160; </div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;    <span class="comment">// elimination first column</span></div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;    <span class="keywordflow">if</span> (dEqualCoeff[i][i - 1] == 0.)</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;    {</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;    }</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; iOrder + 1; j++)</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;    {</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = i; k &lt; iOrder + 1; k++)</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      {</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;        dEqualCoeff[j][k] = dEqualCoeff[j][k] - dEqualCoeff[i][k] * dEqualCoeff[j][i - 1] / dEqualCoeff[i][i - 1];</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;      }</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;    }</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;  }</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160; </div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;  <span class="keywordflow">if</span> (dEqualCoeff[iOrder][iOrder - 1] == 0.)</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;  {</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;  }</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;  dAffinePara[iOrder - 1] = dEqualCoeff[iOrder][iOrder] / dEqualCoeff[iOrder][iOrder - 1];</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = iOrder - 2; i &gt;= 0; i--)</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;  {</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;    <span class="keywordflow">if</span> (dEqualCoeff[i + 1][i] == 0.)</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;    {</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; iOrder; k++)</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;      {</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;        dAffinePara[k] = 0.;</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;      }</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;    }</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;    <span class="keywordtype">double</span> temp = 0;</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; iOrder; j++)</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;    {</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;      temp += dEqualCoeff[i + 1][j] * dAffinePara[j];</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;    }</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;    dAffinePara[i] = (dEqualCoeff[i + 1][iOrder] - temp) / dEqualCoeff[i + 1][i];</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;  }</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;}</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160; </div>
<div class="line"><a name="l05469"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a684f4005176cc6580b29960d10514bcb"> 5469</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a684f4005176cc6580b29960d10514bcb">InterSearch::xCheckBestAffineMVP</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a> &amp;affineAMVPInfo, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMv[3], <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvPred[3], <span class="keywordtype">int</span>&amp; riMVPIdx, uint32_t&amp; ruiBits, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost)</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;{</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;  <span class="keywordflow">if</span> (affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> &lt; 2)</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;  {</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;  }</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160; </div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;  <span class="keywordtype">int</span> mvNum = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> ? 3 : 2;</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160; </div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ade7e91ebda6f8dce573eac07a1278a6c">selectMotionLambda</a>();</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160; </div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;  <span class="keywordtype">int</span> iBestMVPIdx = riMVPIdx;</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160; </div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;  <span class="comment">// Get origin MV bits</span></div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> tmpPredMv[3];</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;  <span class="keywordtype">int</span> iOrgMvBits = <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, acMv, acMvPred);</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;  iOrgMvBits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[riMVPIdx][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160; </div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;  <span class="keywordtype">int</span> iBestMvBits = iOrgMvBits;</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iMVPIdx = 0; iMVPIdx &lt; affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; iMVPIdx++)</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;  {</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;    <span class="keywordflow">if</span> (iMVPIdx == riMVPIdx)</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;    {</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;    }</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;    tmpPredMv[0] = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[iMVPIdx];</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;    tmpPredMv[1] = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[iMVPIdx];</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;    <span class="keywordflow">if</span> (mvNum == 3)</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;    {</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;      tmpPredMv[2] = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[iMVPIdx];</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;    }</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;    <span class="keywordtype">int</span> iMvBits = <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, acMv, tmpPredMv);</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;    iMvBits += <a class="code" href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">m_auiMVPIdxCost</a>[iMVPIdx][<a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>];</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160; </div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;    <span class="keywordflow">if</span> (iMvBits &lt; iBestMvBits)</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;    {</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;      iBestMvBits = iMvBits;</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;      iBestMVPIdx = iMVPIdx;</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;    }</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;  }</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160; </div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;  <span class="keywordflow">if</span> (iBestMVPIdx != riMVPIdx)  <span class="comment">// if changed</span></div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;  {</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;    acMvPred[0] = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[iBestMVPIdx];</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;    acMvPred[1] = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[iBestMVPIdx];</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;    acMvPred[2] = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[iBestMVPIdx];</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;    riMVPIdx = iBestMVPIdx;</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;    uint32_t uiOrgBits = ruiBits;</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;    ruiBits = uiOrgBits - iOrgMvBits + iBestMvBits;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;    ruiCost = (ruiCost - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(uiOrgBits)) + <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(ruiBits);</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;  }</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;}</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160; </div>
<div class="line"><a name="l05523"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a44e957b819a43dba1f284e80d49809f4"> 5523</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a44e957b819a43dba1f284e80d49809f4">InterSearch::xAffineMotionEstimation</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp;    origBuf,</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;  <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>      refPicList,</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>              acMvPred[3],</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;  <span class="keywordtype">int</span>             iRefIdxPred,</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>              acMv[3],</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;  uint32_t&amp;       ruiBits,</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp;     ruiCost,</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  <span class="keywordtype">int</span>&amp;            mvpIdx,</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a>&amp; aamvpi,</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;  <span class="keywordtype">bool</span>            bBi)</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;{</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;  <span class="keywordflow">if</span>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">BCW</a> &amp;&amp; cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a> != <a class="code" href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">BCW_DEFAULT</a> &amp;&amp; !bBi &amp;&amp; <a class="code" href="classvvenc_1_1InterSearch.html#a2b416c27fd70dc219f0bdc256a640fb3">xReadBufferedAffineUniMv</a>( cu, refPicList, iRefIdxPred, acMvPred, acMv, ruiBits, ruiCost, mvpIdx, aamvpi ) )</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;  {</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  }</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160; </div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;  <span class="keywordtype">int</span> bestMvpIdx = mvpIdx;</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> width = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">width</a>;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> height = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">height</a>;</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160; </div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* refPic = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>(refPicList, iRefIdxPred);</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160; </div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  <span class="comment">// Set Origin YUV: pcYuv</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>*   pBuf = &amp;origBuf;</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;  <span class="keywordtype">double</span>        fWeight = 1.0;</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160; </div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>  origBufTmpCnst;</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;  <span class="keyword">enum</span> <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8">DFunc</a> distFunc = (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">disableSATDForRd</a>) ? <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4f3ad87be4ac3fc12e60590dda8bf974">DF_SAD</a> : <a class="code" href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8ac99f51755fff111dd7d5448a23cdd996">DF_HAD</a>;</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160; </div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;  <span class="comment">// if Bi, set to ( 2 * Org - ListX )</span></div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;  <span class="keywordflow">if</span> (bBi)</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;  {</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>  origBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>(cu);</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;    <span class="comment">// NOTE: Other buf contains predicted signal from another direction</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> otherBuf = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[1 - (int)refPicList].getCompactBuf( cu );</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;    origBufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#ae234f3d4d1911a5f0e1b61a5425c320f">copyFrom</a>(origBuf);</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;    origBufTmp.<a class="code" href="structvvenc_1_1UnitBuf.html#af907ad3e49a30f4c2990626baf9bde6a">removeHighFreq</a>(otherBuf, <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_bClipForBiPredMeEnabled, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>);</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160; </div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;    origBufTmpCnst = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>(cu);</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;    pBuf           = &amp;origBufTmpCnst;</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;    fWeight        = <a class="code" href="classvvenc_1_1InterSearch.html#a38fa18d30e9c51ef390aa273da0f2cc5">xGetMEDistortionWeight</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">BcwIdx</a>, refPicList);</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;  }</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160; </div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;  <span class="comment">// pred YUV</span></div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>  predBuf = <a class="code" href="classvvenc_1_1InterSearch.html#a88ad68fee052acec3e700138dcf00516">m_tmpAffiStorage</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>(cu);</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160; </div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;  <span class="comment">// Set start Mv position, use input mv as started search mv</span></div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvTemp[3];</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;  ::memcpy(acMvTemp, acMv, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;  <span class="comment">// Set delta mv</span></div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;  <span class="comment">// malloc buffer</span></div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;  <span class="keywordtype">int</span> iParaNum = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> ? 7 : 5;</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;  <span class="keywordtype">int</span> affineParaNum = iParaNum - 1;</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;  <span class="keywordtype">int</span> mvNum = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> ? 3 : 2;</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;  <span class="keywordtype">double</span> **pdEqualCoeff;</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;  pdEqualCoeff = <span class="keyword">new</span> <span class="keywordtype">double</span> *[iParaNum];</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iParaNum; i++)</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;  {</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;    pdEqualCoeff[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[iParaNum];</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;  }</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160; </div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;  int64_t  i64EqualCoeff[7][7];</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>    *piError = <a class="code" href="classvvenc_1_1InterSearch.html#a0345a1771d19eb6e5d358993984cebbc">m_tmpAffiError</a>;</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;  <span class="keywordtype">int</span>    *pdDerivate[2];</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;  pdDerivate[0] = <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[0];</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;  pdDerivate[1] = <a class="code" href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">m_tmpAffiDeri</a>[1];</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160; </div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiCostBest = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;  uint32_t uiBitsBest = 0;</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160; </div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;  <span class="comment">// do motion compensation with origin mv</span></div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160; </div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(acMvTemp[0], cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(acMvTemp[1], cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>)</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;  {</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;    <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(acMvTemp[2], cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;  }</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160; </div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;  acMvTemp[0].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;  acMvTemp[1].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>)</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;  {</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;    acMvTemp[2].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;  }</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;  <a class="code" href="classvvenc_1_1InterPredInterpolation.html#aed661f58d6fe05e1522dfab76c0d27ec">xPredAffineBlk</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, refPic, acMvTemp, predBuf, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>], refPicList);</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160; </div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;  <span class="comment">// get error</span></div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;  uiCostBest = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a>], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, distFunc);</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160; </div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;  <span class="comment">// get cost with mv</span></div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;  uiBitsBest = ruiBits;</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) xx uiBitsBest=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiBitsBest);</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;  uiBitsBest += <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, acMvTemp, acMvPred);</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) yy uiBitsBest=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiBitsBest);</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;  uiCostBest = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>)(floor(fWeight * (<span class="keywordtype">double</span>)uiCostBest) + (double)<a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(uiBitsBest));</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160; </div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) uiBitsBest=%d, uiCostBest=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiBitsBest, uiCostBest);</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160; </div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;  ::memcpy(acMv, acMvTemp, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160; </div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> bufStride = pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>().stride;</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> predBufStride = predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>().stride;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a> prevIterMv[7][3];</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;  <span class="keywordtype">int</span> iIterTime;</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>)</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;  {</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;    iIterTime = bBi ? 3 : 4;</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;  }</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;  {</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;    iIterTime = bBi ? 3 : 5;</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;  }</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160; </div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;  <span class="keywordflow">if</span> (!cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a05daae41965e8cfa9df1a18006da2ec7">AffineType</a>)<span class="comment">// getUseAffineType())</span></div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;  {</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;    iIterTime = bBi ? 5 : 7;</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;  }</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160; </div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter&lt;iIterTime; iter++)    <span class="comment">// iterate loop</span></div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;  {</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;    memcpy(prevIterMv[iter], acMvTemp, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;<span class="comment">    /*********************************************************************************</span></div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;<span class="comment">    *                         use gradient to update mv</span></div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;<span class="comment">    *********************************************************************************/</span></div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;    <span class="comment">// get Error Matrix</span></div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* pOrg = pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>().buf;</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;    <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* pPred = predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>().buf;</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j&lt; height; j++)</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;    {</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt; width; i++)</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;      {</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;        piError[i + j * width] = pOrg[i] - pPred[i];</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;      }</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;      pOrg += bufStride;</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;      pPred += predBufStride;</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;    }</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160; </div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;    <span class="comment">// sobel x direction</span></div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;    <span class="comment">// -1 0 1</span></div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;    <span class="comment">// -2 0 2</span></div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;    <span class="comment">// -1 0 1</span></div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;    pPred = predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>().buf;</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;    <a class="code" href="classvvenc_1_1AffineGradientSearch.html#a28ffcc0a61c32e339528825ba8871206">m_HorizontalSobelFilter</a>(pPred, predBufStride, pdDerivate[0], width, width, height);</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160; </div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;    <span class="comment">// sobel y direction</span></div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;    <span class="comment">// -1 -2 -1</span></div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;    <span class="comment">//  0  0  0</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;    <span class="comment">//  1  2  1</span></div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;    <a class="code" href="classvvenc_1_1AffineGradientSearch.html#a1348839faf036935e68d5551a90950d2">m_VerticalSobelFilter</a>(pPred, predBufStride, pdDerivate[1], width, width, height);</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160; </div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;    <span class="comment">// solve delta x and y</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; iParaNum; row++)</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;    {</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;      memset(&amp;i64EqualCoeff[row][0], 0, iParaNum * <span class="keyword">sizeof</span>(int64_t));</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;    }</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160; </div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;    <a class="code" href="classvvenc_1_1AffineGradientSearch.html#ae467de2f8e90186206425fa113ea5ab1">m_EqualCoeffComputer</a>(piError, width, pdDerivate, width, i64EqualCoeff, width, height</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;      , (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>)</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;    );</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160; </div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; iParaNum; row++)</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;    {</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iParaNum; i++)</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;      {</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;        pdEqualCoeff[row][i] = (double)i64EqualCoeff[row][i];</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;      }</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;    }</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160; </div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;    <span class="keywordtype">double</span> dAffinePara[6];</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;    <span class="keywordtype">double</span> dDeltaMv[6];</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acDeltaMv[3];</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160; </div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;    <a class="code" href="namespacevvenc.html#addfbcd7236d485fdef78287e1c6693d6">solveEqual</a>(pdEqualCoeff, affineParaNum, dAffinePara);</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160; </div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;    <span class="comment">// convert to delta mv</span></div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;    dDeltaMv[0] = dAffinePara[0];</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;    dDeltaMv[2] = dAffinePara[2];</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> extParams = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a>;</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;    <span class="keywordflow">if</span> (extParams)</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;    {</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;      dDeltaMv[1] = dAffinePara[1] * width + dAffinePara[0];</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;      dDeltaMv[3] = dAffinePara[3] * width + dAffinePara[2];</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;      dDeltaMv[4] = dAffinePara[4] * height + dAffinePara[0];</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;      dDeltaMv[5] = dAffinePara[5] * height + dAffinePara[2];</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;    }</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;    {</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;      dDeltaMv[1] = dAffinePara[1] * width + dAffinePara[0];</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;      dDeltaMv[3] = -dAffinePara[3] * width + dAffinePara[2];</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;    }</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160; </div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> normShiftTab[3] = { <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a7592137366a3f94e0b3844698e6c1483">MV_PRECISION_SIXTEENTH</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a> };</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> stepShiftTab[3] = { <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a7592137366a3f94e0b3844698e6c1483">MV_PRECISION_SIXTEENTH</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a> };</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> multiShift = 1 &lt;&lt; normShiftTab[cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>];</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mvShift = stepShiftTab[cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>];</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160; </div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;    acDeltaMv[0] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>((<span class="keywordtype">int</span>)(dDeltaMv[0] * multiShift + <a class="code" href="CommonDef_8h.html#a8c5ff70b6b28cd0157c50a22406f92c4">SIGN</a>(dDeltaMv[0]) * 0.5) &lt;&lt; mvShift, (<span class="keywordtype">int</span>)(dDeltaMv[2] * multiShift + <a class="code" href="CommonDef_8h.html#a8c5ff70b6b28cd0157c50a22406f92c4">SIGN</a>(dDeltaMv[2]) * 0.5) &lt;&lt; mvShift);</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;    acDeltaMv[1] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>((<span class="keywordtype">int</span>)(dDeltaMv[1] * multiShift + <a class="code" href="CommonDef_8h.html#a8c5ff70b6b28cd0157c50a22406f92c4">SIGN</a>(dDeltaMv[1]) * 0.5) &lt;&lt; mvShift, (<span class="keywordtype">int</span>)(dDeltaMv[3] * multiShift + <a class="code" href="CommonDef_8h.html#a8c5ff70b6b28cd0157c50a22406f92c4">SIGN</a>(dDeltaMv[3]) * 0.5) &lt;&lt; mvShift);</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;    <span class="keywordflow">if</span> (extParams)</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;    {</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;      acDeltaMv[2] = <a class="code" href="classvvenc_1_1Mv.html">Mv</a>((<span class="keywordtype">int</span>)(dDeltaMv[4] * multiShift + <a class="code" href="CommonDef_8h.html#a8c5ff70b6b28cd0157c50a22406f92c4">SIGN</a>(dDeltaMv[4]) * 0.5) &lt;&lt; mvShift, (<span class="keywordtype">int</span>)(dDeltaMv[5] * multiShift + <a class="code" href="CommonDef_8h.html#a8c5ff70b6b28cd0157c50a22406f92c4">SIGN</a>(dDeltaMv[5]) * 0.5) &lt;&lt; mvShift);</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;    }</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;    <span class="keywordtype">bool</span> bAllZero = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mvNum; i++)</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;    {</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> deltaMv = acDeltaMv[i];</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 2)</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;      {</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;        deltaMv.<a class="code" href="classvvenc_1_1Mv.html#a4a247be2cddc2ceb84fb7c8bc43f2795">roundToPrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8ada802e2dfc785fb5a033528db1f7ca5c">MV_PRECISION_HALF</a>);</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;      }</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;      <span class="keywordflow">if</span> (deltaMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> != 0 || deltaMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> != 0)</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;      {</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;        bAllZero = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;      }</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;      bAllZero = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;    }</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160; </div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;    <span class="keywordflow">if</span> (bAllZero)</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160; </div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;    <span class="comment">// do motion compensation with updated mv</span></div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mvNum; i++)</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;    {</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;      acMvTemp[i] += acDeltaMv[i];</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;      acMvTemp[i].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> = Clip3(<a class="code" href="namespacevvenc.html#acd213f383247cfa7c43daf6a33d279ea">MV_MIN</a>, <a class="code" href="namespacevvenc.html#aa5c47604d0ab475cfa89c25a1fafb84c">MV_MAX</a>, acMvTemp[i].hor);</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;      acMvTemp[i].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> = Clip3(<a class="code" href="namespacevvenc.html#acd213f383247cfa7c43daf6a33d279ea">MV_MIN</a>, <a class="code" href="namespacevvenc.html#aa5c47604d0ab475cfa89c25a1fafb84c">MV_MAX</a>, acMvTemp[i].ver);</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;      acMvTemp[i].<a class="code" href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">roundAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160; </div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;      <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(acMvTemp[i], cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;    }</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160; </div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#aed661f58d6fe05e1522dfab76c0d27ec">xPredAffineBlk</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, refPic, acMvTemp, predBuf, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>], refPicList);</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160; </div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;    <span class="comment">// get error</span></div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiCostTemp = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a>], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, distFunc);</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;    <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) uiCostTemp=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiCostTemp);</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160; </div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;    <span class="comment">// get cost with mv</span></div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;    uint32_t uiBitsTemp = ruiBits;</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;    uiBitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, acMvTemp, acMvPred);</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;    uiCostTemp = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>)(floor(fWeight * (<span class="keywordtype">double</span>)uiCostTemp) + (double)<a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(uiBitsTemp));</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160; </div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;    <span class="comment">// store best cost and mv</span></div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;    <span class="keywordflow">if</span> (uiCostTemp &lt; uiCostBest)</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;    {</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;      uiCostBest = uiCostTemp;</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;      uiBitsBest = uiBitsTemp;</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;      memcpy(acMv, acMvTemp, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;      mvpIdx = bestMvpIdx;</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;    }</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_Affine &gt; 1)</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;    {</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;    }</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;  }</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160; </div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;  <span class="keyword">auto</span> checkCPMVRdCost = [&amp;](<a class="code" href="classvvenc_1_1Mv.html">Mv</a> ctrlPtMv[3])</div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;  {</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;    <a class="code" href="classvvenc_1_1InterPredInterpolation.html#aed661f58d6fe05e1522dfab76c0d27ec">xPredAffineBlk</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, refPic, ctrlPtMv, predBuf, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>], refPicList);</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;    <span class="comment">// get error</span></div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> costTemp = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a>], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, distFunc);</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;    <span class="comment">// get cost with mv</span></div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;    uint32_t bitsTemp = ruiBits;</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;    bitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, ctrlPtMv, acMvPred);</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;    costTemp = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>)(floor(fWeight * (<span class="keywordtype">double</span>)costTemp) + (double)<a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(bitsTemp));</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;    <span class="comment">// store best cost and mv</span></div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;    <span class="keywordflow">if</span> (costTemp &lt; uiCostBest)</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;    {</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;      uiCostBest = costTemp;</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;      uiBitsBest = bitsTemp;</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;      ::memcpy(acMv, ctrlPtMv, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;    }</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;  };</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160; </div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;  <span class="keyword">const</span> uint32_t mvShiftTable[3] = { <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">MV_PRECISION_QUARTER</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a> - <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a> };</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;  <span class="keyword">const</span> uint32_t mvShift = mvShiftTable[cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>];</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;  <span class="keywordflow">if</span> (uiCostBest &lt;= <a class="code" href="namespacevvenc.html#ab2835348084b72a4c2d2f703829adf0b">AFFINE_ME_LIST_MVP_TH</a>*<a class="code" href="classvvenc_1_1InterSearch.html#a74a51773f987d540dd4d4dd02399c06a">m_hevcCost</a>)</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;  {</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvPredTmp[3] = { acMvPred[0], acMvPred[1], acMvPred[2] };</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvME[3];</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;    ::memcpy(mvME, acMv, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> dMv = mvME[0] - mvPredTmp[0];</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160; </div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; mvNum; j++)</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;    {</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;      <span class="keywordflow">if</span> ((!j &amp;&amp; mvME[j] != mvPredTmp[j]) || (j &amp;&amp; mvME[j] != (mvPredTmp[j] + dMv)))</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;      {</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;        ::memcpy(acMvTemp, mvME, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;        acMvTemp[j] = mvPredTmp[j];</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160; </div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;        <span class="keywordflow">if</span> (j)</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;          acMvTemp[j] += dMv;</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160; </div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;        checkCPMVRdCost(acMvTemp);</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;      }</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;    }</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160; </div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;    <span class="comment">//keep the rotation/zoom;</span></div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;    <span class="keywordflow">if</span> (mvME[0] != mvPredTmp[0])</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;    {</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;      ::memcpy(acMvTemp, mvME, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; mvNum; i++)</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;      {</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;        acMvTemp[i] -= dMv;</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;      }</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;      acMvTemp[0] = mvPredTmp[0];</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160; </div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;      checkCPMVRdCost(acMvTemp);</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;    }</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160; </div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;    <span class="comment">//keep the translation;</span></div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;    <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> == <a class="code" href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">AFFINEMODEL_6PARAM</a> &amp;&amp; mvME[1] != (mvPredTmp[1] + dMv) &amp;&amp; mvME[2] != (mvPredTmp[2] + dMv))</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;    {</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;      ::memcpy(acMvTemp, mvME, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160; </div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;      acMvTemp[1] = mvPredTmp[1] + dMv;</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;      acMvTemp[2] = mvPredTmp[2] + dMv;</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160; </div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;      checkCPMVRdCost(acMvTemp);</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;    }</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160; </div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;    <span class="comment">// 8 nearest neighbor search</span></div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;    <span class="keywordtype">int</span> testPos[8][2] = { { -1, 0 },{ 0, -1 },{ 0, 1 },{ 1, 0 },{ -1, -1 },{ -1, 1 },{ 1, 1 },{ 1, -1 } };</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> maxSearchRound = 3;</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160; </div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rnd = 0; rnd &lt; maxSearchRound; rnd++)</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;    {</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;      <span class="keywordtype">bool</span> modelChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;      <span class="comment">//search the model parameters with finear granularity;</span></div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; mvNum; j++)</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;      {</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;        <span class="keywordtype">bool</span> loopChange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; 2; iter++)</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;        {</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;          <span class="keywordflow">if</span> (iter == 1 &amp;&amp; !loopChange)</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;          {</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;          }</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;          <a class="code" href="classvvenc_1_1Mv.html">Mv</a> centerMv[3];</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;          memcpy(centerMv, acMv, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;          memcpy(acMvTemp, acMv, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160; </div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = ((iter == 0) ? 0 : 4); i &lt; ((iter == 0) ? 4 : 8); i++)</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;          {</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;            acMvTemp[j].<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(centerMv[j].hor + (testPos[i][0] &lt;&lt; mvShift), centerMv[j].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> + (testPos[i][1] &lt;&lt; mvShift));</div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;            <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(acMvTemp[j], cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>);</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;            <a class="code" href="classvvenc_1_1InterPredInterpolation.html#aed661f58d6fe05e1522dfab76c0d27ec">xPredAffineBlk</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cu, refPic, acMvTemp, predBuf, <span class="keyword">false</span>, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>], refPicList);</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160; </div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;            <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> costTemp = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">getDistPart</a>(predBuf.<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>(), cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">CH_L</a>], <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, distFunc);</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;            uint32_t bitsTemp = ruiBits;</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;            bitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">xCalcAffineMVBits</a>(cu, acMvTemp, acMvPred);</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;            costTemp = (<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>)(floor(fWeight * (<span class="keywordtype">double</span>)costTemp) + (double)<a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">getCost</a>(bitsTemp));</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160; </div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;            <span class="keywordflow">if</span> (costTemp &lt; uiCostBest)</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;            {</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;              uiCostBest = costTemp;</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;              uiBitsBest = bitsTemp;</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;              ::memcpy(acMv, acMvTemp, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>) * 3);</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;              modelChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;              loopChange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;            }</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;          }</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;        }</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;      }</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160; </div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;      <span class="keywordflow">if</span> (!modelChange)</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;      {</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;      }</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;    }</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;  }</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;  acMvPred[0] = aamvpi.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[mvpIdx];</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;  acMvPred[1] = aamvpi.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[mvpIdx];</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;  acMvPred[2] = aamvpi.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[mvpIdx];</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160; </div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;  <span class="comment">// free buffer</span></div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;iParaNum; i++)</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;    <span class="keyword">delete</span>[]pdEqualCoeff[i];</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;  <span class="keyword">delete</span>[]pdEqualCoeff;</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160; </div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;  ruiBits = uiBitsBest;</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;  ruiCost = uiCostBest;</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) uiBitsBest=%d, uiCostBest=%d\n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), uiBitsBest, uiCostBest);</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;}</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160; </div>
<div class="line"><a name="l05914"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a1c8d4c0817299ee000cd3a3679a6d52d"> 5914</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a1c8d4c0817299ee000cd3a3679a6d52d">InterSearch::xEstimateAffineAMVP</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a>&amp; affineAMVPInfo, <a class="code" href="structvvenc_1_1UnitBuf.html">CPelUnitBuf</a>&amp; origBuf, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a> refPicList, <span class="keywordtype">int</span> iRefIdx, <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvPred[3], <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; distBiP)</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;{</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>         bestMvLT, bestMvRT, bestMvLB;</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;  <span class="keywordtype">int</span>        iBestIdx = 0;</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiBestCost = <a class="code" href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">MAX_DISTORTION</a>;</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160; </div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;  <span class="comment">// Fill the MV Candidates</span></div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;  <a class="code" href="namespacevvenc_1_1CU.html#ad2843a8f1e804927a642166b2bdd4c88">CU::fillAffineMvpCand</a>(cu, refPicList, iRefIdx, affineAMVPInfo);</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> == 0, <span class="stringliteral">&quot;Assertion failed.&quot;</span>);</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160; </div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBuf = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>( cu );</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160; </div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;  <span class="keywordtype">bool</span> stop_check = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;  <span class="keywordflow">if</span> (affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[0] == affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[1])</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;  {</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;    <span class="keywordflow">if</span> ((affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[0] == affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[1]) &amp;&amp; (affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[0] == affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[1]))</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;    {</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;      stop_check = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;    }</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;  }</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160; </div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;  <span class="comment">// initialize Mvp index &amp; Mvp</span></div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;  iBestIdx = 0;</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>; i++)</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;  {</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;    <span class="keywordflow">if</span> (i &amp;&amp; stop_check)</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;    {</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;    }</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv[3] = { affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[i], affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[i], affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[i] };</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160; </div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> uiTmpCost = <a class="code" href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9">xGetAffineTemplateCost</a>(cu, origBuf, predBuf, mv, i, <a class="code" href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">AMVP_MAX_NUM_CANDS</a>, refPicList, iRefIdx);</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160; </div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;    <span class="keywordflow">if</span> (uiBestCost &gt; uiTmpCost)</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;    {</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;      uiBestCost = uiTmpCost;</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;      bestMvLT = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>[i];</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;      bestMvRT = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>[i];</div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;      bestMvLB = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>[i];</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;      iBestIdx = i;</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;      distBiP  = uiTmpCost;</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;    }</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;  }</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160; </div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;  <span class="comment">// Setting Best MVP</span></div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;  acMvPred[0] = bestMvLT;</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;  acMvPred[1] = bestMvRT;</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;  acMvPred[2] = bestMvLB;</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160; </div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[refPicList] = iBestIdx;</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">mvpNum</a>[refPicList] = affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>;</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot;#estAffi=%d \n&quot;</span>, affineAMVPInfo.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>);</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;}</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160; </div>
<div class="line"><a name="l05968"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d"> 5968</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">InterSearch::xCopyAffineAMVPInfo</a>(<a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a>&amp; src, <a class="code" href="structvvenc_1_1AffineAMVPInfo.html">AffineAMVPInfo</a>&amp; dst)</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;{</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;  dst.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a> = src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>;</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;  <a class="code" href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a>(g_trace_ctx, D_COMMON, <span class="stringliteral">&quot; (%d) #copyAffi=%d \n&quot;</span>, <a class="code" href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a>(g_trace_ctx, D_COMMON), src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>);</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;  ::memcpy(dst.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>, src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">mvCandLT</a>, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>)*src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>);</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;  ::memcpy(dst.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>, src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">mvCandRT</a>, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>)*src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>);</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;  ::memcpy(dst.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>, src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">mvCandLB</a>, <span class="keyword">sizeof</span>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>)*src.<a class="code" href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">numCand</a>);</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;}</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160; </div>
<div class="line"><a name="l05977"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de"> 5977</a></span>&#160;uint32_t <a class="code" href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">InterSearch::xCalcAffineMVBits</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvTemp[3], <a class="code" href="classvvenc_1_1Mv.html">Mv</a> acMvPred[3])</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;{</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;  <span class="keywordtype">int</span> mvNum = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">affineType</a> ? 3 : 2;</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;  uint32_t bitsTemp = 0;</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160; </div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> verIdx = 0; verIdx &lt; mvNum; verIdx++)</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;  {</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> pred = verIdx == 0 ? acMvPred[verIdx] : acMvPred[verIdx] + acMvTemp[0] - acMvPred[0];</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;    pred.<a class="code" href="classvvenc_1_1Mv.html#adff6f41d923245a695197e0b0623a2ab">changeAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>(pred);</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mv = acMvTemp[verIdx];</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;    mv.<a class="code" href="classvvenc_1_1Mv.html#adff6f41d923245a695197e0b0623a2ab">changeAffinePrecInternal2Amvr</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a>);</div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160; </div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;    bitsTemp += <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>(mv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, mv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0);</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;  }</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160; </div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;  <span class="keywordflow">return</span> bitsTemp;</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;}</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160; </div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160; </div>
<div class="line"><a name="l05999"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#adb2189fa0855c297a7c6ac48658f28ff"> 5999</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#adb2189fa0855c297a7c6ac48658f28ff">InterSearch::setSearchRange</a>( <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Slice.html">Slice</a>* slice, <span class="keyword">const</span> <a class="code" href="TypeDef_8h.html#ace15b38db4c343877cb8fc77e0155236">VVEncCfg</a>&amp; encCfg )</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;{</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;  <span class="keywordflow">if</span>( !encCfg.m_bUseASR || slice-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae712c51e5029cc6e18d4272f9df547cf">isIRAP</a>() )</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;  {</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;  }</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160; </div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;  <span class="keywordtype">int</span> iCurrPOC = slice-&gt;<a class="code" href="classvvenc_1_1Slice.html#af1fa96a850f404aded578d3e29dedbcb">poc</a>;</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;  <span class="keywordtype">int</span> iRefPOC;</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;  <span class="keywordtype">int</span> iGOPSize = encCfg.m_GOPSize;</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;  <span class="keywordtype">int</span> iOffset = (iGOPSize &gt;&gt; 1);</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;  <span class="keywordtype">int</span> iMaxSR = encCfg.m_SearchRange;</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;  <span class="keywordtype">int</span> iNumPredDir = slice-&gt;<a class="code" href="classvvenc_1_1Slice.html#a530d6092c6fac441ddd03762efdf5c2f">isInterP</a>() ? 1 : 2;</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160; </div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iDir = 0; iDir &lt; iNumPredDir; iDir++)</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;  {</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;    <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">RefPicList</a>  e = ( iDir ? <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">REF_PIC_LIST_1</a> : <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a> );</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iRefIdx = 0; iRefIdx &lt; slice-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[e]; iRefIdx++)</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;    {</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;      iRefPOC = slice-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">getRefPic</a>(e, iRefIdx)-&gt;<a class="code" href="structvvenc_1_1Picture.html#abf1a8b43357468a369a08f71ff4bdd88">getPOC</a>();</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;      <span class="keywordtype">int</span> newSearchRange = Clip3(encCfg.m_minSearchWindow, iMaxSR, (iMaxSR*<a class="code" href="namespacevvenc.html#a79ffec64f50a98cf339212235d605a1b">ADAPT_SR_SCALE</a>*abs(iCurrPOC - iRefPOC)+iOffset)/iGOPSize);</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#acfac1ad8a7754b33c46766fe254b7b97">m_aaiAdaptSR</a>[iDir][iRefIdx] = newSearchRange;</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;    }</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;  }</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;}</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160; </div>
<div class="line"><a name="l06025"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a136356f1d8568f4d1717dbf3f38fef30"> 6025</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#a136356f1d8568f4d1717dbf3f38fef30">InterSearch::xIBCSearchMVCandUpdate</a>(<a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  sad, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>* sadBestCand, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* cMVCand)</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;{</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;  <span class="keywordtype">int</span> j = <a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a> - 1;</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160; </div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;  <span class="keywordflow">if</span> (sad &lt; sadBestCand[<a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a> - 1])</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;  {</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = <a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a> - 1; t &gt;= 0; t--)</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;    {</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;      <span class="keywordflow">if</span> (sad &lt; sadBestCand[t])</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;        j = t;</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;    }</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160; </div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = <a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a> - 1; k &gt; j; k--)</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;    {</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;      sadBestCand[k] = sadBestCand[k - 1];</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160; </div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;      cMVCand[k].<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(cMVCand[k - 1].hor, cMVCand[k - 1].ver);</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;    }</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;    sadBestCand[j] = sad;</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;    cMVCand[j].<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(x, y);</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;  }</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;}</div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160; </div>
<div class="line"><a name="l06048"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#a2bbe3d87d2037bae43740148ba4b8f46"> 6048</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classvvenc_1_1InterSearch.html#a2bbe3d87d2037bae43740148ba4b8f46">InterSearch::xIBCSearchMVChromaRefine</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu,</div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;  <span class="keywordtype">int</span>         roiWidth,</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;  <span class="keywordtype">int</span>         roiHeight,</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;  <span class="keywordtype">int</span>         cuPelX,</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;  <span class="keywordtype">int</span>         cuPelY,</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>* sadBestCand,</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* cMVCand</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160; </div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;)</div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;{</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;  <span class="keywordflow">if</span> ((!<a class="code" href="namespacevvenc.html#ae73f6f2b632c978d0661ed7c8d50a685">isChromaEnabled</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a>)) || (!cu.<a class="code" href="structvvenc_1_1UnitArea.html#a5a0489d44d1a78cf7f669e16016b424c">Cb</a>().<a class="code" href="structvvenc_1_1CompArea.html#a315419f26d3c59fa143b49b90a019049">valid</a>()))</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;  {</div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;  }</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160; </div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;  <span class="keywordtype">int</span> bestCandIdx = 0;</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  sadBest = std::numeric_limits&lt;Distortion&gt;::max();</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  tempSad;</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160; </div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* pRef;</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;  <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* pOrg;</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;  <span class="keywordtype">int</span> refStride, orgStride;</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;  <span class="keywordtype">int</span> width, height;</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160; </div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;  <span class="keywordtype">int</span> picWidth = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#acbabe433162be7f154b9577ad7c5d369">picWidthInLumaSamples</a>;</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;  <span class="keywordtype">int</span> picHeight = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a629ec9ecf9a6f29222d0e149bf1573c2">picHeightInLumaSamples</a>;</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160; </div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;  <a class="code" href="structvvenc_1_1UnitArea.html">UnitArea</a> allCompBlocks(cu.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a>, (<a class="code" href="structvvenc_1_1Area.html">Area</a>)cu.<a class="code" href="structvvenc_1_1UnitArea.html#aea60229328e71a0629d212abf764ae45">block</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>));</div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cand = 0; cand &lt; <a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a>; cand++)</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;  {</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;    <span class="keywordflow">if</span> (sadBestCand[cand] == std::numeric_limits&lt;Distortion&gt;::max())</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;    {</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;    }</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160; </div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;    <span class="keywordflow">if</span> ((!cMVCand[cand].hor) &amp;&amp; (!cMVCand[cand].ver))</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160; </div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;    <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>)(cuPelY + cMVCand[cand].ver + roiHeight) &gt;= picHeight) || ((cuPelY + cMVCand[cand].ver) &lt; 0))</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160; </div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;    <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>)(cuPelX + cMVCand[cand].hor + roiWidth) &gt;= picWidth) || ((cuPelX + cMVCand[cand].hor) &lt; 0))</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160; </div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;    tempSad = sadBestCand[cand];</div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160; </div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[0][0] = cMVCand[cand];</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[0][0].<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>);</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">interDir</a> = 1;</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[0] = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">numRefIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>]; <span class="comment">// last idx in the list</span></div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160; </div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> predBufTmp = <a class="code" href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">m_tmpPredStorage</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>].<a class="code" href="structvvenc_1_1PelStorage.html#a152d389c7524c627fd78f149e531c54d">getBuf</a>(<a class="code" href="structvvenc_1_1UnitAreaRelative.html">UnitAreaRelative</a>(cu, cu));</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;    <a class="code" href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">motionCompensation</a>(cu, predBufTmp, <a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>);</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160; </div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ch = <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">COMP_Cb</a>; ch &lt; <a class="code" href="namespacevvenc.html#a9003964e78e9d46fb169c59874f7c4a8">getNumberValidComponents</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#af671e643fcbb19af8b0cf8aa94657716">chromaFormatIdc</a>); ch++)</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;    {</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;      width = roiWidth &gt;&gt; <a class="code" href="namespacevvenc.html#a2a4814950acdf4a610adacb0f7417d8d">getComponentScaleX</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch), cu.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a>);</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;      height = roiHeight &gt;&gt; <a class="code" href="namespacevvenc.html#aa6703e40dff9faf6b5655472e130a512">getComponentScaleY</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch), cu.<a class="code" href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">chromaFormat</a>);</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160; </div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;      <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> origBuf = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>(allCompBlocks);</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;      <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>* pBuf = &amp;origBuf;</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;      <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>  tmpPattern = pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a59fa1e9c0d0dafd04140d8e96323587f">get</a>(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch));</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;      pOrg = (<a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>*)tmpPattern.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>;</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160; </div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;      <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* refPic = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#aa53b89271f07f77f17af4ad8b79f9a4f">pic</a>;</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> refBuf = refPic-&gt;getRecoBuf(allCompBlocks.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch)]);</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;      pRef = (<a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>*)refBuf.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>;</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160; </div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;      refStride = refBuf.stride;</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;      orgStride = tmpPattern.<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160; </div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;      <span class="comment">//ComponentID compID = (ComponentID)ch;</span></div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;      <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>* pBufRef = &amp;predBufTmp;</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;      <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>  tmpPatternRef = pBufRef-&gt;get(<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">ComponentID</a>(ch));</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;      pRef = (<a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>*)tmpPatternRef.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>;</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;      refStride = tmpPatternRef.stride;</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160; </div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160; </div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;      for (<span class="keywordtype">int</span> row = 0; row &lt; height; row++)</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;      {</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; width; col++)</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;        {</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;          tempSad += ((abs(pRef[col] - pOrg[col])) &gt;&gt; (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">bitDepths</a>[<a class="code" href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a6b0616d0bcb1e796289f0f100bc9131a">CH_C</a>] - 8));</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;        }</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;        pRef += refStride;</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;        pOrg += orgStride;</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;      }</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;    }</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160; </div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;    <span class="keywordflow">if</span> (tempSad &lt; sadBest)</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;    {</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;      sadBest = tempSad;</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;      bestCandIdx = cand;</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;    }</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;  }</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160; </div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;  <span class="keywordflow">return</span> bestCandIdx;</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;}</div>
<div class="line"><a name="l06146"></a><span class="lineno"><a class="line" href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805"> 6146</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805">xMergeCandLists</a>(<a class="code" href="classvvenc_1_1Mv.html">Mv</a>* dst, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dn, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dstTotalLength, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* src, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sn)</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;{</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cand = 0; cand &lt; sn &amp;&amp; dn &lt; dstTotalLength; cand++)</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;  {</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;    <span class="keywordflow">if</span> (src[cand] == <a class="code" href="classvvenc_1_1Mv.html">Mv</a>())</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;    {</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;    }</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;    <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dn; j++)</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;    {</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;      <span class="keywordflow">if</span> (src[cand] == dst[j])</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;      {</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;        found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;      }</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;    }</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160; </div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;    <span class="keywordflow">if</span> (!found)</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;    {</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;      dst[dn] = src[cand];</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;      dn++;</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;    }</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;  }</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160; </div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;  <span class="keywordflow">return</span> dn;</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;}</div>
<div class="line"><a name="l06173"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ace6b0a8e41a7e3012e9dc21ccb253c68"> 6173</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#ace6b0a8e41a7e3012e9dc21ccb253c68">InterSearch::xIntraPatternSearchIBC</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a>&amp; cStruct, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMv, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* pcMvSrchRngLT, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* pcMvSrchRngRB, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* pcMvPred)</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;{</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   srchRngHorLeft = pcMvSrchRngLT-&gt;<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   srchRngHorRight = pcMvSrchRngRB-&gt;<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   srchRngVerTop = pcMvSrchRngLT-&gt;<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   srchRngVerBottom = pcMvSrchRngRB-&gt;<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160; </div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  lcuWidth = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#ad6facdc45aad9fcfdb48c5500a5c7e59">CTUSize</a>;</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   puPelOffsetX = 0;</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   puPelOffsetY = 0;</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   cuPelX = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a>;</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>   cuPelY = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a>;</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160; </div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;  <span class="keywordtype">int</span>          roiWidth = cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>();</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;  <span class="keywordtype">int</span>          roiHeight = cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>();</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160; </div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  sad;</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  sadBest = std::numeric_limits&lt;Distortion&gt;::max();</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;  <span class="keywordtype">int</span>         bestX = 0;</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;  <span class="keywordtype">int</span>         bestY = 0;</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160; </div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">Pel</a>* piRefSrch = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>; </div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160; </div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;  <span class="keywordtype">int</span>         bestCandIdx = 0;</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160; </div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>  sadBestCand[<a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a>];</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>          cMVCand[<a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a>];</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160; </div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>  useAmvr = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">AMVR</a>;</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160; </div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160; </div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cand = 0; cand &lt; <a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a>; cand++)</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;  {</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;    sadBestCand[cand] = std::numeric_limits&lt;Distortion&gt;::max();</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;    cMVCand[cand].<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(0, 0);</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;  }</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160; </div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a>);</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160; </div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> picWidth = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#acbabe433162be7f154b9577ad7c5d369">picWidthInLumaSamples</a>;</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> picHeight = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a629ec9ecf9a6f29222d0e149bf1573c2">picHeightInLumaSamples</a>;</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160; </div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160; </div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;  {</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">subShift</a> = 0;</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;    <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> tempSadBest = 0;</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160; </div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;    <span class="keywordtype">int</span> srLeft = srchRngHorLeft, srRight = srchRngHorRight, srTop = srchRngVerTop, srBottom = srchRngVerBottom;</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a> = 0;</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a> = <a class="code" href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805">xMergeCandLists</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a4db803e8138cb0bba7f2b6d67fd56031">m_acBVs</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a>, (2 * <a class="code" href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">IBC_NUM_CANDIDATES</a>), <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#a972312d0d37b92b2ae3c7e330eae4226">m_bvCands</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">currCnt</a>);</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160; </div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cMvPredEncOnly[<a class="code" href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">IBC_NUM_CANDIDATES</a>];</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;    <span class="keywordtype">int</span> nbPreds = 0;</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;    <a class="code" href="namespacevvenc_1_1CU.html#a8a0b480a254f4194e6bf088d1fa04c1a">CU::getIbcMVPsEncOnly</a>(cu, cMvPredEncOnly, nbPreds);</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a> = <a class="code" href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805">xMergeCandLists</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a4db803e8138cb0bba7f2b6d67fd56031">m_acBVs</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a>, (2 * <a class="code" href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">IBC_NUM_CANDIDATES</a>), cMvPredEncOnly, nbPreds);</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160; </div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cand = 0; cand &lt; <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a>; cand++)</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;    {</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;      <span class="keywordtype">int</span> xPred = <a class="code" href="classvvenc_1_1InterSearch.html#a4db803e8138cb0bba7f2b6d67fd56031">m_acBVs</a>[cand].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;      <span class="keywordtype">int</span> yPred = <a class="code" href="classvvenc_1_1InterSearch.html#a4db803e8138cb0bba7f2b6d67fd56031">m_acBVs</a>[cand].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160; </div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;      <span class="keywordflow">if</span> (!(xPred == 0 &amp;&amp; yPred == 0)</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;        &amp;&amp; !((yPred &lt; srTop) || (yPred &gt; srBottom))</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;        &amp;&amp; !((xPred &lt; srLeft) || (xPred &gt; srRight)))</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;      {</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;        <span class="keywordtype">bool</span> validCand = <a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">searchBvIBC</a>(cu, cuPelX, cuPelY, roiWidth, roiHeight, picWidth, picHeight, xPred, yPred, lcuWidth);</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160; </div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;        <span class="keywordflow">if</span> (validCand)</div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;        {</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;          sad = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(xPred, yPred, useAmvr);</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = piRefSrch + cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> * yPred + xPred;</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;          sad += <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160; </div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a136356f1d8568f4d1717dbf3f38fef30">xIBCSearchMVCandUpdate</a>(sad, xPred, yPred, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;        }</div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;      }</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;    }</div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160; </div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;    bestX = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;    bestY = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;    rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;    sadBest = sadBestCand[0];</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160; </div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> boundY = (0 - roiHeight - puPelOffsetY);</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = std::max(srchRngVerTop, 0 - cuPelY); y &lt;= boundY; ++y)</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;    {</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">searchBvIBC</a>(cu, cuPelX, cuPelY, roiWidth, roiHeight, picWidth, picHeight, 0, y, lcuWidth))</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;      {</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;      }</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160; </div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;      sad = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(0, y, useAmvr);</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = piRefSrch + cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> * y;</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;      sad += <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160; </div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a136356f1d8568f4d1717dbf3f38fef30">xIBCSearchMVCandUpdate</a>(sad, 0, y, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;      tempSadBest = sadBestCand[0];</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;      <span class="keywordflow">if</span> (sadBestCand[0] &lt;= 3)</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;      {</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;        bestX = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;        bestY = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;        sadBest = sadBestCand[0];</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;        rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;        ruiCost = sadBest;</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;        <span class="keywordflow">goto</span> end;</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;      }</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;    }</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160; </div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> boundX = std::max(srchRngHorLeft, -cuPelX);</div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0 - roiWidth - puPelOffsetX; x &gt;= boundX; --x)</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;    {</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">searchBvIBC</a>(cu, cuPelX, cuPelY, roiWidth, roiHeight, picWidth, picHeight, x, 0, lcuWidth))</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;      {</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;      }</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160; </div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;      sad = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(x, 0, useAmvr);</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = piRefSrch + x;</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;      sad += <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160; </div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160; </div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a136356f1d8568f4d1717dbf3f38fef30">xIBCSearchMVCandUpdate</a>(sad, x, 0, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;      tempSadBest = sadBestCand[0];</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;      <span class="keywordflow">if</span> (sadBestCand[0] &lt;= 3)</div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;      {</div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;        bestX = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;        bestY = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;        sadBest = sadBestCand[0];</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;        rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;        ruiCost = sadBest;</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;        <span class="keywordflow">goto</span> end;</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;      }</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;    }</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160; </div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;    bestX = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;    bestY = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;    sadBest = sadBestCand[0];</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;    <span class="keywordflow">if</span> ((!bestX &amp;&amp; !bestY) || (sadBest - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(bestX, bestY, useAmvr) &lt;= 32))</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;    {</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;      <span class="comment">//chroma refine</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;      bestCandIdx = <a class="code" href="classvvenc_1_1InterSearch.html#a2bbe3d87d2037bae43740148ba4b8f46">xIBCSearchMVChromaRefine</a>(cu, roiWidth, roiHeight, cuPelX, cuPelY, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;      bestX = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;      bestY = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;      sadBest = sadBestCand[bestCandIdx];</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;      rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;      ruiCost = sadBest;</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;      <span class="keywordflow">goto</span> end;</div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;    }</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160; </div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;    <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>() &lt; 16 &amp;&amp; cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>() &lt; 16)</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;    {</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;      <span class="keywordtype">int</span> stepS = 2;</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod &gt; 2)</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;      {</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod == 5)</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;        {</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;          stepS = 8;</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;        }</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>() &gt; 4) || (cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>() &gt; 4))</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;        {</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;          stepS = 4;</div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;        }</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;      }</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160; </div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> minCuLog2 = <a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_log2MinCodingBlockSize;</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> minCuMask = (1 &lt;&lt; minCuLog2) - 1;</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;      <span class="keywordtype">bool</span> lastDec = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160; </div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> searchStep = 0; searchStep &lt; 3; searchStep++)</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;      {</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;        <span class="keywordtype">int</span> delaySy = searchStep ? 1 : 0;</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;        <span class="keywordtype">int</span> delaySx = searchStep &gt; 1 ? 1 : 0;</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;        <span class="keywordtype">int</span> startY = (std::max(srchRngVerTop, -cuPelY) + delaySy);</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;        <span class="keywordtype">int</span> startX = (std::max(srchRngHorLeft, -cuPelX) + delaySx);</div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;        <span class="keywordtype">int</span> endY = srchRngVerBottom;</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;        <span class="keywordtype">int</span> endX = srchRngHorRight;</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160; </div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod &gt; 5)</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;        {</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;          startY = bestY - 4;</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;          endY = bestY + 4;</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;          startX = bestX - 4;</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;          endX = bestX + 4;</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;          stepS = 1;</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;          <span class="keywordflow">if</span> (searchStep)</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;          {</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;          }</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;        }</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160; </div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = startY; y &lt;= endY; y += stepS)</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;        {</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;          <span class="keywordflow">if</span> ((y == 0) || ((int)(cuPelY + y + roiHeight) &gt;= picHeight))</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;          <span class="keywordtype">bool</span> firstX = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;          <span class="keywordtype">int</span> stepSx = searchStep ? stepS : 1;</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = startX; x &lt;= endX; firstX = <span class="keyword">false</span>, x += stepSx)</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;          {</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;            <span class="keywordflow">if</span> ((x == 0) || ((int)(cuPelX + x + roiWidth) &gt;= picWidth))</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160; </div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;            <span class="keywordtype">bool</span> isSameAsLast = !firstX &amp;&amp; ((cuPelX + x) &amp; minCuMask) &gt; 1;</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;            <span class="keywordflow">if</span> (searchStep || (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod &gt; 5))</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;            {</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">searchBvIBC</a>(cu, cuPelX, cuPelY, roiWidth, roiHeight, picWidth, picHeight, x, y, lcuWidth))</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;              {</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;              }</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;            }</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((isSameAsLast &amp;&amp; !lastDec) || (!isSameAsLast &amp;&amp; !<a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">searchBvIBC</a>(cu, cuPelX, cuPelY, roiWidth, roiHeight, picWidth, picHeight, x, y, lcuWidth)))</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;            {</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;              lastDec = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;            }</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;            lastDec = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160; </div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;            sad = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(x, y, useAmvr);</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = piRefSrch + cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> * y + x;</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;            sad += <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160; </div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;            <a class="code" href="classvvenc_1_1InterSearch.html#a136356f1d8568f4d1717dbf3f38fef30">xIBCSearchMVCandUpdate</a>(sad, x, y, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160; </div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160; </div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;            <span class="keywordflow">if</span> (searchStep &amp;&amp; sadBestCand[0] &lt;= 5)</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;            {</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;              <span class="comment">//chroma refine &amp; return</span></div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;              bestCandIdx = <a class="code" href="classvvenc_1_1InterSearch.html#a2bbe3d87d2037bae43740148ba4b8f46">xIBCSearchMVChromaRefine</a>(cu, roiWidth, roiHeight, cuPelX, cuPelY, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;              bestX = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;              bestY = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;              sadBest = sadBestCand[bestCandIdx];</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;              rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;              ruiCost = sadBest;</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;              <span class="keywordflow">goto</span> end;</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;            }</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;          }</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;        }</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160; </div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;        <span class="keywordflow">if</span> ((searchStep &lt; 2) &amp;&amp; (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod &lt; 6))</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;        {</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod &gt; 2) &amp;&amp; (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod &lt; 5))</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;          {</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;            <span class="keywordflow">if</span> ((bestX == cMVCand[0].hor) &amp;&amp; (bestY == cMVCand[0].ver))</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;            {</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;              sadBest = sadBestCand[bestCandIdx];</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;              rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;              ruiCost = sadBest;</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;              <span class="keywordflow">goto</span> end;</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;            }</div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;          }</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;          bestX = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;          bestY = cMVCand[0].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;          sadBest = sadBestCand[0];</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160; </div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;          <span class="keywordtype">int</span> StopSearch = searchStep ? 32 : 16;</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;          <span class="keywordflow">if</span> ((searchStep &amp;&amp; (sadBest &gt;= tempSadBest)) || (sadBest - <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(bestX, bestY, useAmvr) &lt;= StopSearch))</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;          {</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;            <span class="comment">//chroma refine</span></div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;            bestCandIdx = <a class="code" href="classvvenc_1_1InterSearch.html#a2bbe3d87d2037bae43740148ba4b8f46">xIBCSearchMVChromaRefine</a>(cu, roiWidth, roiHeight, cuPelX, cuPelY, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160; </div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;            bestX = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;            bestY = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;            sadBest = sadBestCand[bestCandIdx];</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;            rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;            ruiCost = sadBest;</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;            <span class="keywordflow">goto</span> end;</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;          }</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;        }</div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;      }</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;    }</div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;  }</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160; </div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;  bestCandIdx = <a class="code" href="classvvenc_1_1InterSearch.html#a2bbe3d87d2037bae43740148ba4b8f46">xIBCSearchMVChromaRefine</a>(cu, roiWidth, roiHeight, cuPelX, cuPelY, sadBestCand, cMVCand);</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160; </div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;  bestX = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;  bestY = cMVCand[bestCandIdx].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;  sadBest = sadBestCand[bestCandIdx];</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;  rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(bestX, bestY);</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;  ruiCost = sadBest;</div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160; </div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;end:</div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a> = 0;</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a> = <a class="code" href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805">xMergeCandLists</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a4db803e8138cb0bba7f2b6d67fd56031">m_acBVs</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a>, (2 * <a class="code" href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">IBC_NUM_CANDIDATES</a>), <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#a972312d0d37b92b2ae3c7e330eae4226">m_bvCands</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">currCnt</a>);</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160; </div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">currCnt</a> = 0;</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">currCnt</a> = <a class="code" href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805">xMergeCandLists</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#a972312d0d37b92b2ae3c7e330eae4226">m_bvCands</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">currCnt</a>, <a class="code" href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">IBC_NUM_CANDIDATES</a>, cMVCand, <a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a>);</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">currCnt</a> = <a class="code" href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805">xMergeCandLists</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#a972312d0d37b92b2ae3c7e330eae4226">m_bvCands</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">m_defaultCachedBvs</a>-&gt;<a class="code" href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">currCnt</a>, <a class="code" href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">IBC_NUM_CANDIDATES</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a4db803e8138cb0bba7f2b6d67fd56031">m_acBVs</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">m_numBVs</a>);</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160; </div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cand = 0; cand &lt; <a class="code" href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">CHROMA_REFINEMENT_CANDIDATES</a>; cand++)</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;  {</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;    <span class="keywordflow">if</span> (cMVCand[cand].hor == 0 &amp;&amp; cMVCand[cand].ver == 0)</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;    {</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;    }</div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a4f79f54e78034e5a883a8db14dda02db">m_ctuRecord</a>[cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>()][cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>()].bvRecord[cMVCand[cand]] = sadBestCand[cand];</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;  }</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160; </div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;}</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160; </div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160; </div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160; </div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;<span class="comment">// based on xMotionEstimation</span></div>
<div class="line"><a name="l06475"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ad110b18cf976a78f734532554e21a187"> 6475</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#ad110b18cf976a78f734532554e21a187">InterSearch::xIBCEstimation</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>&amp; origBuf, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>* pcMvPred, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMv, <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a>&amp; ruiCost )</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;{</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iPicWidth = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#acbabe433162be7f154b9577ad7c5d369">picWidthInLumaSamples</a>;</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iPicHeight = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a629ec9ecf9a6f29222d0e149bf1573c2">picHeightInLumaSamples</a>;</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  lcuWidth = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#ad6facdc45aad9fcfdb48c5500a5c7e59">CTUSize</a>;</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>           cuPelX = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a>;</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>           cuPelY = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a>;</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;  <span class="keywordtype">int</span>                 iRoiWidth = cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>();</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;  <span class="keywordtype">int</span>                 iRoiHeight = cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>();</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160; </div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;  <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a>* pBuf = &amp;origBuf;</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160; </div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;  <span class="comment">//  Search key pattern initialization</span></div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;  <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>  tmpPattern = pBuf-&gt;<a class="code" href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">Y</a>();</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;  <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>* pcPatternKey = &amp;tmpPattern;</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;  <a class="code" href="structvvenc_1_1AreaBuf.html">PelBuf</a> tmpOrgLuma;</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;  <a class="code" href="classvvenc_1_1ReshapeData.html">ReshapeData</a>&amp; reshapeData = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">picture</a>-&gt;<a class="code" href="structvvenc_1_1Picture.html#a2487e6c4ee0e4106a128c09f68105170">reshapeData</a>;</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;  <span class="keywordflow">if</span> ((cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a75027878ba07c729f99e49e63d3495d9">lmcsEnabled</a> &amp;&amp; reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">getCTUFlag</a>()))</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;  {</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;    tmpOrgLuma = <a class="code" href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">m_tmpStorageLCU</a>.<a class="code" href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">getCompactBuf</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>());</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;    tmpOrgLuma.<a class="code" href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">rspSignal</a>(tmpPattern, reshapeData.<a class="code" href="classvvenc_1_1ReshapeData.html#aa5bb3b64b46c55daa973047310d70393">getInvLUT</a>());</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;    pcPatternKey = (<a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a>*)&amp;tmpOrgLuma;</div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;  }</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a> = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">clpRngs</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>];</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;  <a class="code" href="structvvenc_1_1Picture.html">Picture</a>* refPic = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#aa53b89271f07f77f17af4ad8b79f9a4f">pic</a>;</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1AreaBuf.html">CPelBuf</a> refBuf = refPic-&gt;<a class="code" href="structvvenc_1_1Picture.html#aee021e1a0b2774638746e6e9e76a5519">getRecoBuf</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">blocks</a>[<a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>]);</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160; </div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;  <a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">TZSearchStruct</a> cStruct; </div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a> = pcPatternKey;</div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> = refBuf.<a class="code" href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">stride</a>;</div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> = refBuf.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a>;</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == <a class="code" href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">IMV_HPEL</a>, <span class="stringliteral">&quot;IF_IBC&quot;</span>);</div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">imvShift</a> = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> &lt;&lt; 1;</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;  cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a> = 0; </div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160; </div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a904c3bb814a77ca8b36717aa757235f7">getMotionCostIBC</a>(0);</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a683c4efab3fe6050a8d58dd6a81a8793">setPredictorsIBC</a>(pcMvPred);</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160; </div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">setDistParam</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>, *cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">pcPatternKey</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a>, <a class="code" href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">m_lumaClpRng</a>.<a class="code" href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">bd</a>, <a class="code" href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">COMP_Y</a>, cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">subShiftMode</a>);</div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;  <span class="keywordtype">bool</span> buffered = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">m_pcEncCfg</a>-&gt;m_IBCFastMethod)<span class="comment">// IBC_FAST_METHOD_BUFFERBV</span></div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;  {</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;    ruiCost = <a class="code" href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">MAX_UINT</a>;</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;    std::unordered_map&lt;Mv, Distortion&gt;&amp; history = <a class="code" href="classvvenc_1_1InterSearch.html#a4f79f54e78034e5a883a8db14dda02db">m_ctuRecord</a>[cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>()][cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>()].bvRecord;</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;    <span class="keywordflow">for</span> (std::unordered_map&lt;Mv, Distortion&gt;::iterator p = history.begin(); p != history.end(); p++)</div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;    {</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;      <span class="keyword">const</span> <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; bv = p-&gt;first;</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160; </div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;      <span class="keywordtype">int</span> xBv = bv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;      <span class="keywordtype">int</span> yBv = bv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">searchBvIBC</a>(cu, cuPelX, cuPelY, iRoiWidth, iRoiHeight, iPicWidth, iPicHeight, xBv, yBv, lcuWidth))</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;      {</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;        buffered = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;        <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> sad = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(xBv, yBv, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">AMVR</a>);</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;        <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> * yBv + xBv;</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;        sad += <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;        <span class="keywordflow">if</span> (sad &lt; ruiCost)</div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;        {</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;          rcMv = bv;</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;          ruiCost = sad;</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;        }</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sad == ruiCost)</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;        {</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;          <span class="comment">// stabilise the search through the unordered list</span></div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;          <span class="keywordflow">if</span> (bv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &lt; rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a></div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;            || (bv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> == rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &amp;&amp; bv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &lt; rcMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>))</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;          {</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;            <span class="comment">// update the vector.</span></div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;            rcMv = bv;</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;          }</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;        }</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;      }</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;    }</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160; </div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;    <span class="keywordflow">if</span> (buffered)</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;    {</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;      <a class="code" href="classvvenc_1_1Mv.html">Mv</a> cMvPredEncOnly[<a class="code" href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">IBC_NUM_CANDIDATES</a>];</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;      <span class="keywordtype">int</span> nbPreds = 0;</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;      <a class="code" href="namespacevvenc_1_1CU.html#a8a0b480a254f4194e6bf088d1fa04c1a">CU::getIbcMVPsEncOnly</a>(cu, cMvPredEncOnly, nbPreds);</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160; </div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cand = 0; cand &lt; nbPreds; cand++)</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;      {</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;        <span class="keywordtype">int</span> xPred = cMvPredEncOnly[cand].<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>;</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;        <span class="keywordtype">int</span> yPred = cMvPredEncOnly[cand].<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>;</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160; </div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">searchBvIBC</a>(cu, cuPelX, cuPelY, iRoiWidth, iRoiHeight, iPicWidth, iPicHeight, xPred, yPred, lcuWidth))</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;        {</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;          <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> sad = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">getBvCostMultiplePredsIBC</a>(xPred, yPred, cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">AMVR</a>);</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">cur</a>.<a class="code" href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">buf</a> = cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">piRefY</a> + cStruct.<a class="code" href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">iRefStride</a> * yPred + xPred;</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;          sad += <a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>.<a class="code" href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">distFunc</a>(<a class="code" href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">m_cDistParam</a>);</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;          <span class="keywordflow">if</span> (sad &lt; ruiCost)</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;          {</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;            rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(xPred, yPred);</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;            ruiCost = sad;</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;          }</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sad == ruiCost)</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;          {</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;            <span class="comment">// stabilise the search through the unordered list</span></div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;            <span class="keywordflow">if</span> (xPred &lt; rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a></div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;              || (xPred == rcMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &amp;&amp; yPred &lt; rcMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>))</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;            {</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;              <span class="comment">// update the vector.</span></div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;              rcMv.<a class="code" href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">set</a>(xPred, yPred);</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;            }</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;          }</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;          <a class="code" href="classvvenc_1_1InterSearch.html#a4f79f54e78034e5a883a8db14dda02db">m_ctuRecord</a>[cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>()][cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>()].bvRecord[<a class="code" href="classvvenc_1_1Mv.html">Mv</a>(xPred, yPred)] = sad;</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;        }</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;      }</div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;    }</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;  }</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160; </div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;  <span class="keywordflow">if</span> (!buffered)</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;  {</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a>        cMvSrchRngLT;</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a>        cMvSrchRngRB;</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160; </div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;    <span class="comment">// assume that intra BV is integer-pel precision</span></div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ab9dff1babd6605466544eab335cbf1e1">xSetIntraSearchRangeIBC</a>(cu, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">lwidth</a>(), cu.<a class="code" href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">lheight</a>(), cMvSrchRngLT, cMvSrchRngRB);</div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160; </div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;    <span class="comment">//  Do integer search</span></div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ace6b0a8e41a7e3012e9dc21ccb253c68">xIntraPatternSearchIBC</a>(cu, cStruct, rcMv, ruiCost, &amp;cMvSrchRngLT, &amp;cMvSrchRngRB, pcMvPred);</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;  }</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;}</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;<span class="comment">// based on xSetSearchRange</span></div>
<div class="line"><a name="l06600"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#ab9dff1babd6605466544eab335cbf1e1"> 6600</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classvvenc_1_1InterSearch.html#ab9dff1babd6605466544eab335cbf1e1">InterSearch::xSetIntraSearchRangeIBC</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <span class="keywordtype">int</span> iRoiWidth, <span class="keywordtype">int</span> iRoiHeight, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvSrchRngLT, <a class="code" href="classvvenc_1_1Mv.html">Mv</a>&amp; rcMvSrchRngRB)</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;{</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160; <span class="comment">// const SPS&amp; sps = *cu.cs-&gt;sps;</span></div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160; </div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;  <span class="keywordtype">int</span> srLeft, srRight, srTop, srBottom;</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160; </div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> cuPelX = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a>;</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> cuPelY = cu.<a class="code" href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">Y</a>().<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a>;</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160; </div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> lcuWidth = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">slice</a>-&gt;<a class="code" href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#ad6facdc45aad9fcfdb48c5500a5c7e59">CTUSize</a>;</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ctuSizeLog2 = <a class="code" href="namespacevvenc.html#a1c67fbd69415ae8f053fbe313e4a5cda">floorLog2</a>(lcuWidth);</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;  <span class="keywordtype">int</span> numLeftCTUs = (1 &lt;&lt; ((7 - ctuSizeLog2) &lt;&lt; 1)) - ((ctuSizeLog2 &lt; 7) ? 1 : 0);</div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160; </div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;  srLeft = -(numLeftCTUs * lcuWidth + (cuPelX % lcuWidth));</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;  srTop = -(cuPelY % lcuWidth);</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160; </div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;  srRight = lcuWidth - (cuPelX % lcuWidth) - iRoiWidth;</div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;  srBottom = lcuWidth - (cuPelY % lcuWidth) - iRoiHeight;</div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160; </div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;  rcMvSrchRngLT.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>=srLeft;</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;  rcMvSrchRngLT.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>=srTop;</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;  rcMvSrchRngRB.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>=srRight;</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;  rcMvSrchRngRB.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>=srBottom;</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160; </div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;  rcMvSrchRngLT &lt;&lt;= 2;</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;  rcMvSrchRngRB &lt;&lt;= 2;</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;  <span class="keywordtype">bool</span> temp = <a class="code" href="classvvenc_1_1InterSearch.html#a19b4deebe4b22090dcf016202d2b4f2f">m_clipMvInSubPic</a>;</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a19b4deebe4b22090dcf016202d2b4f2f">m_clipMvInSubPic</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(rcMvSrchRngLT,cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(),cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>, *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a19b4deebe4b22090dcf016202d2b4f2f">m_clipMvInSubPic</a>);</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;  <a class="code" href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">clipMv</a>(rcMvSrchRngRB, cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>(),cu.<a class="code" href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">lumaSize</a>(), *cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">pcv</a>, * cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>, <a class="code" href="classvvenc_1_1InterSearch.html#a19b4deebe4b22090dcf016202d2b4f2f">m_clipMvInSubPic</a>);</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a19b4deebe4b22090dcf016202d2b4f2f">m_clipMvInSubPic</a> = temp;</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;  rcMvSrchRngLT &gt;&gt;= 2;</div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;  rcMvSrchRngRB &gt;&gt;= 2;</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;}</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160; </div>
<div class="line"><a name="l06635"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aa391293054038b0549cc65f918625083"> 6635</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classvvenc_1_1InterSearch.html#aa391293054038b0549cc65f918625083">InterSearch::predIBCSearch</a>(<a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <a class="code" href="classvvenc_1_1Partitioner.html">Partitioner</a>&amp; partitioner)</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;{</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvSrchRngLT;</div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>           cMvSrchRngRB;</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;  cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> = 2;</div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a> amvpInfo4Pel;</div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;  <a class="code" href="namespacevvenc_1_1CU.html#a62402c36368db2049cf01d988d38521f">CU::fillIBCMvpCand</a>(cu, amvpInfo4Pel);</div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160; </div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;  cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> = 0;<span class="comment">// (Int)cu.cs-&gt;sps-&gt;getUseIMV(); // set as IMV=0 initially</span></div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;  <a class="code" href="classvvenc_1_1Mv.html">Mv</a>    cMv, cMvPred[2];</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;  <a class="code" href="structvvenc_1_1AMVPInfo.html">AMVPInfo</a> amvpInfo;</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;  <a class="code" href="namespacevvenc_1_1CU.html#a62402c36368db2049cf01d988d38521f">CU::fillIBCMvpCand</a>(cu, amvpInfo);</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;  <span class="comment">// store in full pel accuracy, shift before use in search</span></div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;  cMvPred[0] = amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[0];</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;  cMvPred[0].<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>);</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;  cMvPred[1] = amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[1];</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;  cMvPred[1].<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>);</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160; </div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;  <span class="keywordtype">int</span> iBvpNum = 2;</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;  <span class="keywordtype">int</span> bvpIdxBest = 0;</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;  cMv.<a class="code" href="classvvenc_1_1Mv.html#a47affd1a10b589811fc4828c1a2e0c6d">setZero</a>();</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;  <a class="code" href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">Distortion</a> cost = 0;</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#aae6a5c38493d414d2cdba9518d91e20e">maxNumIBCMergeCand</a> == 1)</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;  {</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;    iBvpNum = 1;</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;    cMvPred[1] = cMvPred[0];</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;  }</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160; </div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;  <span class="keywordflow">if</span> (cMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> == 0 &amp;&amp; cMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> == 0)</div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;  {</div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;    <span class="comment">// if hash search does not work or is not enabled</span></div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;    <a class="code" href="structvvenc_1_1UnitBuf.html">PelUnitBuf</a> origBuf = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">getOrgBuf</a>(cu);</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#ad110b18cf976a78f734532554e21a187">xIBCEstimation</a>(cu, origBuf, cMvPred, cMv, cost );</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;  }</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160; </div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;  <span class="keywordflow">if</span> (cMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> == 0 &amp;&amp; cMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> == 0)</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;  {</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;  }</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bitsBVPBest, bitsBVPTemp;</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;  bitsBVPBest = <a class="code" href="namespacevvenc.html#a4521994cc996921f223544e09d194ab9">MAX_INT</a>;</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;  <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">setCostScale</a>(0);</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160; </div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bvpIdxTemp = 0; bvpIdxTemp &lt; iBvpNum; bvpIdxTemp++)</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;  {</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;    <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>(cMvPred[bvpIdxTemp]);</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160; </div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;    bitsBVPTemp = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>(cMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a>, cMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a>, 0);</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160; </div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;    <span class="keywordflow">if</span> (bitsBVPTemp &lt; bitsBVPBest)</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;    {</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;      bitsBVPBest = bitsBVPTemp;</div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;      bvpIdxBest = bvpIdxTemp;</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160; </div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">AMVR</a> &amp;&amp; cMv != cMvPred[bvpIdxTemp])</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> = 1; <span class="comment">// set as full-pel</span></div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> = 0; <span class="comment">// set as fractional-pel</span></div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160; </div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;    }</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160; </div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bitsBVPQP = <a class="code" href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">MAX_UINT</a>;</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160; </div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160; </div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;    <a class="code" href="classvvenc_1_1Mv.html">Mv</a> mvPredQuadPel;</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;    <span class="keywordflow">if</span> ((cMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> % 4 == 0) &amp;&amp; (cMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> % 4 == 0) &amp;&amp; (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">AMVR</a>))</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;    {</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;      mvPredQuadPel = amvpInfo4Pel.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[bvpIdxTemp];<span class="comment">// cMvPred[bvpIdxTemp];</span></div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160; </div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;      mvPredQuadPel.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a0515f94079bb68ffa3cece37a4777779">MV_PRECISION_4PEL</a>);</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160; </div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;      <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">setPredictor</a>(mvPredQuadPel);</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160; </div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;      bitsBVPQP = <a class="code" href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">m_pcRdCost</a>-&gt;<a class="code" href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">getBitsOfVectorWithPredictor</a>(cMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> &gt;&gt; 2, cMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> &gt;&gt; 2, 0);</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160; </div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;    }</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;    mvPredQuadPel.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a0515f94079bb68ffa3cece37a4777779">MV_PRECISION_4PEL</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>);</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;    <span class="keywordflow">if</span> (bitsBVPQP &lt; bitsBVPBest &amp;&amp; cMv != mvPredQuadPel)</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;    {</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;      bitsBVPBest = bitsBVPQP;</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;      bvpIdxBest = bvpIdxTemp;</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160; </div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;      <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">AMVR</a>)</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;        cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> = 2; <span class="comment">// set as quad-pel</span></div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;    }</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160; </div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;  }</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160; </div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a7a4c28f2fe75d240c7d78c25d9357a73">bv</a> = cMv; <span class="comment">// bv is always at integer accuracy</span></div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;  cMv.<a class="code" href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">changePrecision</a>(<a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">MV_PRECISION_INT</a>, <a class="code" href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">MV_PRECISION_INTERNAL</a>);</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">mv</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMv; <span class="comment">// store in fractional pel accuracy</span></div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160; </div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">mvpIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = bvpIdxBest;</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160; </div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 2 &amp;&amp; cMv != amvpInfo4Pel.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[bvpIdxBest])</div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMv - amvpInfo4Pel.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[bvpIdxBest];</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;    cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] = cMv - amvpInfo.<a class="code" href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">mvCand</a>[bvpIdxBest];</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160; </div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] == <a class="code" href="classvvenc_1_1Mv.html">Mv</a>(0, 0))</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;    cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> = 0;</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> == 2)</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;    assert((cMv.<a class="code" href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">hor</a> % 16 == 0) &amp;&amp; (cMv.<a class="code" href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">ver</a> % 16 == 0));</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;  <span class="keywordflow">if</span> (cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">sps</a>-&gt;<a class="code" href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">AMVR</a>)</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;    assert(cu.<a class="code" href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">imv</a> &gt; 0 || cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">mvd</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>][0] == <a class="code" href="classvvenc_1_1Mv.html">Mv</a>());</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160; </div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;  cu.<a class="code" href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">refIdx</a>[<a class="code" href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">REF_PIC_LIST_0</a>] = <a class="code" href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">MAX_NUM_REF</a>;</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160; </div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;}</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160; </div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160; </div>
<div class="line"><a name="l06749"></a><span class="lineno"><a class="line" href="namespacevvenc.html#a159e0290b97daf4943ec29343199e1f3"> 6749</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacevvenc.html#a159e0290b97daf4943ec29343199e1f3">isYPartBefore</a>( <a class="code" href="namespacevvenc.html#a27e39e4771fc2c2035bd65e57ca85ead">SplitSeries</a> series, <span class="keyword">const</span> <span class="keywordtype">int</span> ctuSizeLog2, <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Position.html">Position</a>&amp; refPos, <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Position.html">Position</a>&amp; pos )</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;{</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> refCtuX = refPos.<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> &gt;&gt; ctuSizeLog2;</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> refCtuY = refPos.<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> &gt;&gt; ctuSizeLog2;</div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> posCtuX = pos.<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> &gt;&gt; ctuSizeLog2;</div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> posCtuY = pos.<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> &gt;&gt; ctuSizeLog2;</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160; </div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;  <a class="code" href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a>( refCtuX != posCtuX || refCtuY != posCtuY, <span class="stringliteral">&quot;This method can only be applied for positions within the same CTU&quot;</span> );</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160; </div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ctuMask = ( 1 &lt;&lt; ctuSizeLog2 ) - 1;</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160; </div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> refX = refPos.<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> &amp; ctuMask;</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> refY = refPos.<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> &amp; ctuMask;</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> posX = pos.<a class="code" href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">x</a> &amp; ctuMask;</div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> posY = pos.<a class="code" href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">y</a> &amp; ctuMask;</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160; </div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;  <span class="keywordtype">int</span> x = 0, y = 0, w = 1 &lt;&lt; ctuSizeLog2, h = 1 &lt;&lt; ctuSizeLog2;</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;  </div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;  <span class="keywordflow">while</span>( <span class="keyword">true</span> )</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;  {</div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;    <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691da">PartSplit</a> <a class="code" href="namespacevvenc.html#a466828c7ddb3e821834ec05c44dc09de">split</a> = <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691da">PartSplit</a>( series &amp; <a class="code" href="namespacevvenc.html#aa405f6119ac5e6b7a6499dc7ca22b57a">SPLIT_MASK</a> );</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160; </div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="namespacevvenc.html#a466828c7ddb3e821834ec05c44dc09de">split</a> )</div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;    {</div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daa5f271ee24260631e632460583d28a51e">CU_QUAD_SPLIT</a>:</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;      w &gt;&gt;= 1;</div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;      <span class="keywordflow">if</span>( posX &gt;= x + w ) x += w;</div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daaeea769e763d6528084529497fffd3c64">CU_HORZ_SPLIT</a>:</div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;      h &gt;&gt;= 1;</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;      <span class="keywordflow">if</span>( posY &gt;= y + h ) y += h;</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160; </div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daaa486793146c0647069205824697ef8fe">CU_VERT_SPLIT</a>:</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;      w &gt;&gt;= 1;</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;      <span class="keywordflow">if</span>( posX &gt;= x + w ) x += w;</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;      <span class="keywordflow">goto</span> checkXonly;</div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160; </div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daaa4913c5d007af4f59d31efc38ee8fc1c">CU_TRIH_SPLIT</a>:</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;      h &gt;&gt;= 2;</div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;      <span class="keywordflow">if</span>( posY &gt;= y + h ) { y += h; h &lt;&lt;= 1; }</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;      <span class="keywordflow">if</span>( posY &gt;= y + h ) { y += h; h &gt;&gt;= 1; }</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160; </div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daa9ec1b74592ecc43bd20e8ae7bfb04192">CU_TRIV_SPLIT</a>:</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;      w &gt;&gt;= 2;</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;      <span class="keywordflow">if</span>( posX &gt;= x + w ) { x += w; w &lt;&lt;= 1; }</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;      <span class="keywordflow">if</span>( posX &gt;= x + w ) { x += w; w &gt;&gt;= 1; }</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;      <span class="keywordflow">goto</span> checkXonly;</div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160; </div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;    }</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160; </div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;    <span class="keywordflow">if</span>( refY &gt;= y + h ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( refY &lt; y ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160; </div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;checkXonly:</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;    <span class="keywordflow">if</span>( refX &gt;= x + w ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( refX &lt; x ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160; </div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;    series &gt;&gt;= <a class="code" href="namespacevvenc.html#a1e827ff1a9f566d6697b680ee5d6b2a3">SPLIT_DMULT</a>; <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;  }</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160; </div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;}</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160; </div>
<div class="line"><a name="l06817"></a><span class="lineno"><a class="line" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc"> 6817</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">InterSearch::searchBvIBC</a>(<span class="keyword">const</span> <a class="code" href="structvvenc_1_1CodingUnit.html">CodingUnit</a>&amp; cu, <span class="keywordtype">int</span> xPos, <span class="keywordtype">int</span> yPos, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <span class="keywordtype">int</span> picWidth, <span class="keywordtype">int</span> picHeight, <span class="keywordtype">int</span> xBv, <span class="keywordtype">int</span> yBv, <span class="keywordtype">int</span> ctuSize)<span class="keyword"> const</span></div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ctuSizeLog2 = <a class="code" href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">Log2</a>(ctuSize);</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160; </div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;  <span class="keywordtype">int</span> refRightX  = xPos + xBv + width  - 1;</div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;  <span class="keywordtype">int</span> refBottomY = yPos + yBv + height - 1;</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160; </div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;  <span class="keywordtype">int</span> refLeftX = xPos + xBv;</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;  <span class="keywordtype">int</span> refTopY  = yPos + yBv;</div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160; </div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;  <span class="keywordflow">if</span> ((xPos + xBv) &lt; 0)</div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;  {</div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;  }</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;  <span class="keywordflow">if</span> (refRightX &gt;= picWidth)</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;  {</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;  }</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160; </div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;  <span class="keywordflow">if</span> ((yPos + yBv) &lt; 0)</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;  {</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;  }</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;  <span class="keywordflow">if</span> (refBottomY &gt;= picHeight)</div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;  {</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;  }</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;  <span class="keywordflow">if</span> ((xBv + width) &gt; 0 &amp;&amp; (yBv + height) &gt; 0)</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;  {</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;  }</div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160; </div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;  <span class="comment">// Don&#39;t search the above CTU row</span></div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;  <span class="keywordflow">if</span> (refTopY &gt;&gt; ctuSizeLog2 &lt; yPos &gt;&gt; ctuSizeLog2)</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160; </div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;  <span class="comment">// Don&#39;t search the below CTU row</span></div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;  <span class="keywordflow">if</span> (refBottomY &gt;&gt; ctuSizeLog2 &gt; yPos &gt;&gt; ctuSizeLog2)</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;  {</div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;  }</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160; </div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;  <span class="keywordtype">unsigned</span> curTileIdx = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a1098ca84e973da53b10489faf6221d6d">getTileIdx</a>(cu.<a class="code" href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">lumaPos</a>());</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;  <span class="keywordtype">unsigned</span> refTileIdx = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a1098ca84e973da53b10489faf6221d6d">getTileIdx</a>(<a class="code" href="structvvenc_1_1Position.html">Position</a>(refLeftX, refTopY));</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;  <span class="keywordflow">if</span> (curTileIdx != refTileIdx)</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;  {</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;  }</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;  refTileIdx = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a1098ca84e973da53b10489faf6221d6d">getTileIdx</a>(<a class="code" href="structvvenc_1_1Position.html">Position</a>(refLeftX, refBottomY));</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;  <span class="keywordflow">if</span> (curTileIdx != refTileIdx)</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;  {</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;  }</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;  refTileIdx = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a1098ca84e973da53b10489faf6221d6d">getTileIdx</a>(<a class="code" href="structvvenc_1_1Position.html">Position</a>(refRightX, refTopY));</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;  <span class="keywordflow">if</span> (curTileIdx != refTileIdx)</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;  {</div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;  }</div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;  refTileIdx = cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">cs</a>-&gt;<a class="code" href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">pps</a>-&gt;<a class="code" href="structvvenc_1_1PPS.html#a1098ca84e973da53b10489faf6221d6d">getTileIdx</a>(<a class="code" href="structvvenc_1_1Position.html">Position</a>(refRightX, refBottomY));</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;  <span class="keywordflow">if</span> (curTileIdx != refTileIdx)</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;  {</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;  }</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160; </div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Position.html">Position</a> cuPos{ xPos, yPos };</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160; </div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;  <span class="comment">//int numLeftCTUs = (1 &lt;&lt; ((7 - ctuSizeLog2) &lt;&lt; 1)) - ((ctuSizeLog2 &lt; 7) ? 1 : 0);</span></div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> numLeftCTUsLUT[3] = { 15, 3, 1 };</div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160; </div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;  <span class="comment">// in the same CTU line</span></div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> numLeftCTUs = numLeftCTUsLUT[ctuSizeLog2 - 5];</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160; </div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;  <span class="keywordflow">if</span>( ( refRightX &gt;&gt; ctuSizeLog2 &lt;= xPos &gt;&gt; ctuSizeLog2 ) &amp;&amp; ( refLeftX &gt;&gt; ctuSizeLog2 &gt;= ( xPos &gt;&gt; ctuSizeLog2 ) - numLeftCTUs ) )</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;  {</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;    <span class="comment">// in the same CTU, or left CTU</span></div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;    <span class="comment">// if part of ref block is in the left CTU, some area can be referred from the not-yet updated local CTU buffer</span></div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;    <span class="keywordflow">if</span>( ( ctuSizeLog2 == 7 ) &amp;&amp; ( ( refLeftX &gt;&gt; ctuSizeLog2 ) == ( ( xPos &gt;&gt; ctuSizeLog2 ) - 1 ) ) )</div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;    {</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;      <span class="comment">// ref block&#39;s collocated block in current CTU</span></div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;      <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Position.html">Position</a> refPosCol64x64{ ( refLeftX + ctuSize ) &amp; ~63, refTopY &amp; ~63 };</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;      <span class="keywordflow">if</span>( refPosCol64x64 == <a class="code" href="structvvenc_1_1Position.html">Position</a>{ xPos &amp; ~63, yPos &amp; ~63 } )</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160; </div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;      <span class="comment">//CodingUnit* curef = cu.cs-&gt;getCU(refPosCol64x64, CH_L, cu.treeType);</span></div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;      <span class="comment">//bool isDecomp = curef &amp;&amp; ((cu.cs != curef-&gt;cs) || cu.idx &lt; curef-&gt;idx);</span></div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;      <span class="keywordtype">bool</span> isDecomp = <a class="code" href="namespacevvenc.html#a159e0290b97daf4943ec29343199e1f3">isYPartBefore</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a7aef6ebf57f7f26bfc2dd7200b134e69">splitSeries</a>, ctuSizeLog2, cuPos, refPosCol64x64 );</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;      <span class="keywordflow">if</span>( isDecomp )</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;      {</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;      }</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;    }</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;  }</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160; </div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;  <span class="comment">// in the same CTU, or valid area from left CTU. Check if the reference block is already coded</span></div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;  <span class="keyword">const</span> <a class="code" href="structvvenc_1_1Position.html">Position</a> refPosBR{ refRightX, refBottomY };</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;  <span class="comment">//CodingUnit* curef = cu.cs-&gt;getCU(refPosBR, CH_L, cu.treeType);</span></div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;  <span class="comment">//bool isDecomp = curef &amp;&amp; ((cu.cs != curef-&gt;cs) || cu.idx &lt; curef-&gt;idx);</span></div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;  <span class="keywordtype">bool</span> isDecomp = ( ( refPosBR.x &gt;&gt; ctuSizeLog2 ) &lt; ( cuPos.x &gt;&gt; ctuSizeLog2 ) ) || ( refRightX &lt; xPos &amp;&amp; refBottomY &lt; yPos ) || <a class="code" href="namespacevvenc.html#a159e0290b97daf4943ec29343199e1f3">isYPartBefore</a>( cu.<a class="code" href="structvvenc_1_1CodingUnit.html#a7aef6ebf57f7f26bfc2dd7200b134e69">splitSeries</a>, ctuSizeLog2, cuPos, refPosBR );</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160; </div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;  <span class="keywordflow">return</span> isDecomp;</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;}</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160; </div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;} <span class="comment">// namespace vvenc</span></div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160; </div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a871ad2a0f6e481e30b56323a3a5d124c"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a871ad2a0f6e481e30b56323a3a5d124c">vvenc::RdCost::getBvCostMultiplePredsIBC</a></div><div class="ttdeci">Distortion getBvCostMultiplePredsIBC(int x, int y, bool useIMV)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8cpp_source.html#l01981">RdCost.cpp:1981</a></div></div>
<div class="ttc" id="adtrace__next_8h_html_a40fa8e4bb6064294484bdd1ac543d4a2"><div class="ttname"><a href="dtrace__next_8h.html#a40fa8e4bb6064294484bdd1ac543d4a2">DTRACE</a></div><div class="ttdeci">#define DTRACE(ctx, channel,...)</div><div class="ttdef"><b>Definition:</b> <a href="dtrace__next_8h_source.html#l00280">dtrace_next.h:280</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af3b8fe3c3850ac884f854414f26c76b2"><div class="ttname"><a href="namespacevvenc.html#af3b8fe3c3850ac884f854414f26c76b2">vvenc::MAX_DOUBLE</a></div><div class="ttdeci">static const double MAX_DOUBLE</div><div class="ttdoc">max. value of double-type value</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00187">CommonDef.h:187</a></div></div>
<div class="ttc" id="astructvvenc_1_1PelStorage_html_a152d389c7524c627fd78f149e531c54d"><div class="ttname"><a href="structvvenc_1_1PelStorage.html#a152d389c7524c627fd78f149e531c54d">vvenc::PelStorage::getBuf</a></div><div class="ttdeci">PelBuf getBuf(const CompArea &amp;blk)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8cpp_source.html#l00997">Buffer.cpp:997</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_ab6f276082172be43a6041212071e377b"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#ab6f276082172be43a6041212071e377b">vvenc::TransformUnit::depth</a></div><div class="ttdeci">uint8_t depth</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00410">Unit.h:410</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TempCtx_html"><div class="ttname"><a href="classvvenc_1_1TempCtx.html">vvenc::TempCtx</a></div><div class="ttdef"><b>Definition:</b> <a href="Contexts_8h_source.html#l00385">Contexts.h:385</a></div></div>
<div class="ttc" id="aclassvvenc_1_1AffineGradientSearch_html_a1348839faf036935e68d5551a90950d2"><div class="ttname"><a href="classvvenc_1_1AffineGradientSearch.html#a1348839faf036935e68d5551a90950d2">vvenc::AffineGradientSearch::m_VerticalSobelFilter</a></div><div class="ttdeci">void(* m_VerticalSobelFilter)(Pel *const pPred, const int predStride, int *const pDerivate, const int derivateBufStride, const int width, const int height)</div><div class="ttdef"><b>Definition:</b> <a href="AffineGradientSearch_8h_source.html#l00064">AffineGradientSearch.h:64</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88a7be139e95d2f0c3a60ecc5c654609f18"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7be139e95d2f0c3a60ecc5c654609f18">vvenc::SBT_VER_H0</a></div><div class="ttdeci">@ SBT_VER_H0</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00295">TypeDef.h:295</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_a09cfeacdc2b818e48bc3fc71b59ea829"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#a09cfeacdc2b818e48bc3fc71b59ea829">vvenc::CABACWriter::cu_residual</a></div><div class="ttdeci">void cu_residual(const CodingUnit &amp;cu, Partitioner &amp;pm, CUCtx &amp;cuCtx)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l01229">CABACWriter.cpp:1229</a></div></div>
<div class="ttc" id="aclassvvenc_1_1QpParam_html"><div class="ttname"><a href="classvvenc_1_1QpParam.html">vvenc::QpParam</a></div><div class="ttdoc">QP struct.</div><div class="ttdef"><b>Definition:</b> <a href="Quant_8h_source.html#l00089">Quant.h:89</a></div></div>
<div class="ttc" id="aclassvvenc_1_1DistParam_html_aa8a6f3a3091d3ec0bda883c1a8caa41f"><div class="ttname"><a href="classvvenc_1_1DistParam.html#aa8a6f3a3091d3ec0bda883c1a8caa41f">vvenc::DistParam::subShift</a></div><div class="ttdeci">int subShift</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00088">RdCost.h:88</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_a203f0c223afe9c39dc6f904ba6357e58"><div class="ttname"><a href="structvvenc_1_1SPS.html#a203f0c223afe9c39dc6f904ba6357e58">vvenc::SPS::AMVR</a></div><div class="ttdeci">bool AMVR</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00790">Slice.h:790</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html_aa75cb739cc3a76b68078e6696558b79d"><div class="ttname"><a href="classvvenc_1_1TrQuant.html#aa75cb739cc3a76b68078e6696558b79d">vvenc::TrQuant::transformNxN</a></div><div class="ttdeci">void transformNxN(TransformUnit &amp;tu, const ComponentID compID, const QpParam &amp;cQP, TCoeff &amp;uiAbsSum, const Ctx &amp;ctx, const bool loadTr=false)</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8cpp_source.html#l00654">TrQuant.cpp:654</a></div></div>
<div class="ttc" id="aTypeDef_8h_html_ace15b38db4c343877cb8fc77e0155236"><div class="ttname"><a href="TypeDef_8h.html#ace15b38db4c343877cb8fc77e0155236">VVEncCfg</a></div><div class="ttdeci">struct vvenc_config VVEncCfg</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00066">TypeDef.h:66</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1SearchRange_html"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1SearchRange.html">vvenc::InterSearch::SearchRange</a></div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00446">InterSearch.h:446</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a7cc71bf11f858c29047e8e66e244d1bc"><div class="ttname"><a href="namespacevvenc.html#a7cc71bf11f858c29047e8e66e244d1bc">vvenc::MIN_CU_LOG2</a></div><div class="ttdeci">static const int MIN_CU_LOG2</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00369">CommonDef.h:369</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_a6c1e157224f4eb1ed388d13bedcbad27"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#a6c1e157224f4eb1ed388d13bedcbad27">vvenc::Partitioner::chType</a></div><div class="ttdeci">ChannelType chType</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00144">UnitPartitioner.h:144</a></div></div>
<div class="ttc" id="astructvvenc_1_1CompStorage_html_ab1e81cc503ec0bbb39b0302881cea9e0"><div class="ttname"><a href="structvvenc_1_1CompStorage.html#ab1e81cc503ec0bbb39b0302881cea9e0">vvenc::CompStorage::create</a></div><div class="ttdeci">void create(const Size &amp;size)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00965">Buffer.h:965</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CS_html_a740c9fbc8b40bc5bfd3a11aeefcf13bb"><div class="ttname"><a href="namespacevvenc_1_1CS.html#a740c9fbc8b40bc5bfd3a11aeefcf13bb">vvenc::CS::isDualITree</a></div><div class="ttdeci">bool isDualITree(const CodingStructure &amp;cs)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l00071">UnitTools.cpp:71</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a3b688da19bcfb0ff8a8f92f82132d5da"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a3b688da19bcfb0ff8a8f92f82132d5da">vvenc::InterSearch::skipSbtByRDCost</a></div><div class="ttdeci">uint8_t skipSbtByRDCost(int width, int height, int mtDepth, uint8_t sbtIdx, uint8_t sbtPos, double bestCost, Distortion distSbtOff, double costSbtOff, bool rootCbfSbtOff)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l03637">InterSearch.cpp:3637</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_adbbe87f880e5fcea67153030935e047a"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#adbbe87f880e5fcea67153030935e047a">vvenc::UnitArea::chromaPos</a></div><div class="ttdeci">const Position &amp; chromaPos() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00239">Unit.h:239</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_af1fa78f94bcedbacf8bd882ce5da43f7"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#af1fa78f94bcedbacf8bd882ce5da43f7">vvenc::UnitArea::lumaSize</a></div><div class="ttdeci">const Size &amp; lumaSize() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00237">Unit.h:237</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a74a51773f987d540dd4d4dd02399c06a"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a74a51773f987d540dd4d4dd02399c06a">vvenc::InterSearch::m_hevcCost</a></div><div class="ttdeci">Distortion m_hevcCost</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00379">InterSearch.h:379</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a6b2d6efc65c5ae913296de1f6068f68b"><div class="ttname"><a href="namespacevvenc.html#a6b2d6efc65c5ae913296de1f6068f68b">vvenc::MAX_CU_SIZE</a></div><div class="ttdeci">static const int MAX_CU_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00368">CommonDef.h:368</a></div></div>
<div class="ttc" id="aclassvvenc_1_1ReshapeData_html"><div class="ttname"><a href="classvvenc_1_1ReshapeData.html">vvenc::ReshapeData</a></div><div class="ttdef"><b>Definition:</b> <a href="Reshape_8h_source.html#l00066">Reshape.h:66</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a9c5ed9f5c6203e9ceea129849c68dc87"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a9c5ed9f5c6203e9ceea129849c68dc87">vvenc::InterSearch::m_defaultCachedBvs</a></div><div class="ttdeci">IbcBvCand * m_defaultCachedBvs</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00355">InterSearch.h:355</a></div></div>
<div class="ttc" id="astructvvenc_1_1BlkUniMvInfoBuffer_html_aea97ceaa3309a46ee618f9028dd52ade"><div class="ttname"><a href="structvvenc_1_1BlkUniMvInfoBuffer.html#aea97ceaa3309a46ee618f9028dd52ade">vvenc::BlkUniMvInfoBuffer::insertUniMvCands</a></div><div class="ttdeci">void insertUniMvCands(const Area &amp;blkArea, const Mv *cMvTemp)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00108">InterSearch.h:108</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_a7aef6ebf57f7f26bfc2dd7200b134e69"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#a7aef6ebf57f7f26bfc2dd7200b134e69">vvenc::CodingUnit::splitSeries</a></div><div class="ttdeci">SplitSeries splitSeries</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00349">Unit.h:349</a></div></div>
<div class="ttc" id="anamespacevvenc_html_adea48f6d363ff5bbe0929be6e484d805"><div class="ttname"><a href="namespacevvenc.html#adea48f6d363ff5bbe0929be6e484d805">vvenc::xMergeCandLists</a></div><div class="ttdeci">static unsigned int xMergeCandLists(Mv *dst, unsigned int dn, unsigned int dstTotalLength, Mv *src, unsigned int sn)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06146">InterSearch.cpp:6146</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_afa470f8b1c0f3cb28395539dfa4bc4cc"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#afa470f8b1c0f3cb28395539dfa4bc4cc">vvenc::InterSearch::m_sbtRdoOrder</a></div><div class="ttdeci">uint8_t m_sbtRdoOrder[NUMBER_SBT_MODE]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00391">InterSearch.h:391</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a771848baeb6a36ee61ee9bc83ededc64"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a771848baeb6a36ee61ee9bc83ededc64">vvenc::InterSearch::xGetTemplateCost</a></div><div class="ttdeci">Distortion xGetTemplateCost(const CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, PelUnitBuf &amp;predBuf, Mv cMvCand, int iMVPIdx, int iMVPNum, RefPicList refPicList, int iRefIdx)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01939">InterSearch.cpp:1939</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineAMVPInfo_html"><div class="ttname"><a href="structvvenc_1_1AffineAMVPInfo.html">vvenc::AffineAMVPInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00072">MotionInfo.h:72</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a466828c7ddb3e821834ec05c44dc09de"><div class="ttname"><a href="namespacevvenc.html#a466828c7ddb3e821834ec05c44dc09de">vvenc::split</a></div><div class="ttdeci">static std::vector&lt; std::string &gt; &amp; split(const std::string &amp;s, char delim, std::vector&lt; std::string &gt; &amp;elems)</div><div class="ttdef"><b>Definition:</b> <a href="dtrace_8cpp_source.html#l00104">dtrace.cpp:104</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitBuf_html"><div class="ttname"><a href="structvvenc_1_1UnitBuf.html">vvenc::UnitBuf</a></div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00655">Buffer.h:655</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a412226c3b5b12371a91d1eb635a55dd8"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a412226c3b5b12371a91d1eb635a55dd8">vvenc::BcwMotionParam::copyTo</a></div><div class="ttdeci">void copyTo(Mv &amp;rcMv, Distortion &amp;ruiDist, uint32_t uiRefList, uint32_t uiRefIdx)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00298">MotionInfo.h:298</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a72ff05263d9deacacf1be65a8a68157a"><div class="ttname"><a href="namespacevvenc.html#a72ff05263d9deacacf1be65a8a68157a">vvenc::Log2</a></div><div class="ttdeci">int Log2(uint32_t x)</div><div class="ttdef"><b>Definition:</b> <a href="Rom_8h_source.html#l00192">Rom.h:192</a></div></div>
<div class="ttc" id="astructvvenc_1_1ReuseUniMv_html_a1db6a10153263ac204e9a33874995064"><div class="ttname"><a href="structvvenc_1_1ReuseUniMv.html#a1db6a10153263ac204e9a33874995064">vvenc::ReuseUniMv::~ReuseUniMv</a></div><div class="ttdeci">~ReuseUniMv()</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00336">InterSearch.cpp:336</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html"><div class="ttname"><a href="structvvenc_1_1UnitArea.html">vvenc::UnitArea</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00191">Unit.h:191</a></div></div>
<div class="ttc" id="aclassvvenc_1_1DistParam_html_acae113ecd739d9c74b8ff82f4a131500"><div class="ttname"><a href="classvvenc_1_1DistParam.html#acae113ecd739d9c74b8ff82f4a131500">vvenc::DistParam::maximumDistortionForEarlyExit</a></div><div class="ttdeci">Distortion maximumDistortionForEarlyExit</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00091">RdCost.h:91</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a136356f1d8568f4d1717dbf3f38fef30"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a136356f1d8568f4d1717dbf3f38fef30">vvenc::InterSearch::xIBCSearchMVCandUpdate</a></div><div class="ttdeci">void xIBCSearchMVCandUpdate(Distortion uiSad, int x, int y, Distortion *uiSadBestCand, Mv *cMVCand)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06025">InterSearch.cpp:6025</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_a33ccc64f705e98a484194f765d797721"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#a33ccc64f705e98a484194f765d797721">vvenc::UnitArea::lwidth</a></div><div class="ttdeci">const SizeType lwidth() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00245">Unit.h:245</a></div></div>
<div class="ttc" id="astructvvenc_1_1Size_html"><div class="ttname"><a href="structvvenc_1_1Size.html">vvenc::Size</a></div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00080">Common.h:80</a></div></div>
<div class="ttc" id="aclassvvenc_1_1AffineGradientSearch_html_a28ffcc0a61c32e339528825ba8871206"><div class="ttname"><a href="classvvenc_1_1AffineGradientSearch.html#a28ffcc0a61c32e339528825ba8871206">vvenc::AffineGradientSearch::m_HorizontalSobelFilter</a></div><div class="ttdeci">void(* m_HorizontalSobelFilter)(Pel *const pPred, const int predStride, int *const pDerivate, const int derivateBufStride, const int width, const int height)</div><div class="ttdef"><b>Definition:</b> <a href="AffineGradientSearch_8h_source.html#l00063">AffineGradientSearch.h:63</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a7cf3acc655efbe44b86894c075acb23c"><div class="ttname"><a href="namespacevvenc.html#a7cf3acc655efbe44b86894c075acb23c">vvenc::MAX_NUM_REF_LIST_ADAPT_SR</a></div><div class="ttdeci">static const uint32_t MAX_NUM_REF_LIST_ADAPT_SR</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00074">InterSearch.h:74</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab71c686caef0807c59fec6468d277dd8ada802e2dfc785fb5a033528db1f7ca5c"><div class="ttname"><a href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8ada802e2dfc785fb5a033528db1f7ca5c">vvenc::MV_PRECISION_HALF</a></div><div class="ttdeci">@ MV_PRECISION_HALF</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00068">Mv.h:68</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_abd69038caf0e20410a0e13758ace1e67"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#abd69038caf0e20410a0e13758ace1e67">vvenc::InterSearch::getWeightIdxBits</a></div><div class="ttdeci">uint8_t getWeightIdxBits(uint8_t bcwIdx)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00438">InterSearch.h:438</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ae98c2fa56ca7cf3b3c994d78d3d1418b"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ae98c2fa56ca7cf3b3c994d78d3d1418b">vvenc::InterSearch::m_motionEstimationSearchMethod</a></div><div class="ttdeci">vvencMESearchMethod m_motionEstimationSearchMethod</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00369">InterSearch.h:369</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_a4460952d9337315fdfe063103cc7a794"><div class="ttname"><a href="structvvenc_1_1SPS.html#a4460952d9337315fdfe063103cc7a794">vvenc::SPS::SbtMvp</a></div><div class="ttdeci">bool SbtMvp</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00729">Slice.h:729</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_a83dedaccc39c9d31f3ef20ff7ccb4b4f"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#a83dedaccc39c9d31f3ef20ff7ccb4b4f">vvenc::CodingUnit::cs</a></div><div class="ttdeci">CodingStructure * cs</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00336">Unit.h:336</a></div></div>
<div class="ttc" id="aclassvvenc_1_1ReshapeData_html_ae4ed8d1a51a8c76e7c92769282c379e0"><div class="ttname"><a href="classvvenc_1_1ReshapeData.html#ae4ed8d1a51a8c76e7c92769282c379e0">vvenc::ReshapeData::calculateChromaAdjVpduNei</a></div><div class="ttdeci">int calculateChromaAdjVpduNei(const TransformUnit &amp;tu, const CompArea &amp;, const TreeType _treeType)</div><div class="ttdef"><b>Definition:</b> <a href="Reshape_8cpp_source.html#l00081">Reshape.cpp:81</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88a8c5c94eef555382fe4299f9a9842097d"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8c5c94eef555382fe4299f9a9842097d">vvenc::SBT_HOR_Q0</a></div><div class="ttdeci">@ SBT_HOR_Q0</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00301">TypeDef.h:301</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a892956403dbe9e537368527e54365c51"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a892956403dbe9e537368527e54365c51">vvenc::InterSearch::m_affineMotion</a></div><div class="ttdeci">EncAffineMotion m_affineMotion</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00380">InterSearch.h:380</a></div></div>
<div class="ttc" id="astructvvenc_1_1AMVPInfo_html_a711ec6926c7dd06a0e59636e89c648f9"><div class="ttname"><a href="structvvenc_1_1AMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">vvenc::AMVPInfo::numCand</a></div><div class="ttdeci">unsigned numCand</div><div class="ttdoc">number of motion vector predictor candidates</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00069">MotionInfo.h:69</a></div></div>
<div class="ttc" id="aCommonDef_8h_html_aa79686061aabdeab06e3a87c5059b97b"><div class="ttname"><a href="CommonDef_8h.html#aa79686061aabdeab06e3a87c5059b97b">GCC_WARNING_RESET</a></div><div class="ttdeci">#define GCC_WARNING_RESET</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00097">CommonDef.h:97</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_af154a86f0d3e7ac832d936f3e0fe31e7"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af154a86f0d3e7ac832d936f3e0fe31e7">vvenc::InterSearch::TZSearchStruct::iBestX</a></div><div class="ttdeci">int iBestX</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00460">InterSearch.h:460</a></div></div>
<div class="ttc" id="astructvvenc_1_1CUCtx_html"><div class="ttname"><a href="structvvenc_1_1CUCtx.html">vvenc::CUCtx</a></div><div class="ttdef"><b>Definition:</b> <a href="ContextModelling_8h_source.html#l00421">ContextModelling.h:421</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ac805e492b380b892650ee0b344b0f69e"><div class="ttname"><a href="namespacevvenc.html#ac805e492b380b892650ee0b344b0f69e">vvenc::MV_FRACTIONAL_BITS_INTERNAL</a></div><div class="ttdeci">static const int MV_FRACTIONAL_BITS_INTERNAL</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00332">CommonDef.h:332</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_af67498245b43d85d1afe6c053a4eb1b6"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#af67498245b43d85d1afe6c053a4eb1b6">vvenc::InterSearch::xGetBlkBits</a></div><div class="ttdeci">void xGetBlkBits(bool bPSlice, int iPartIdx, uint32_t uiLastMode, uint32_t uiBlkBit[3])</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01862">InterSearch.cpp:1862</a></div></div>
<div class="ttc" id="aclassvvenc_1_1EncModeCtrl_html"><div class="ttname"><a href="classvvenc_1_1EncModeCtrl.html">vvenc::EncModeCtrl</a></div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8h_source.html#l00342">EncModeCtrl.h:342</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1SearchRange_html_af93f4f37fc2ad9c37af4a715423b110c"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1SearchRange.html#af93f4f37fc2ad9c37af4a715423b110c">vvenc::InterSearch::SearchRange::top</a></div><div class="ttdeci">int top</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00450">InterSearch.h:450</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a508c08bc126bef2837ba572ad52a9892"><div class="ttname"><a href="classvvenc_1_1Slice.html#a508c08bc126bef2837ba572ad52a9892">vvenc::Slice::sliceQp</a></div><div class="ttdeci">int sliceQp</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01203">Slice.h:1203</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aedd99d503788bcd4561c14459655fdfc"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aedd99d503788bcd4561c14459655fdfc">vvenc::InterSearch::searchBvIBC</a></div><div class="ttdeci">bool searchBvIBC(const CodingUnit &amp;pu, int xPos, int yPos, int width, int height, int picWidth, int picHeight, int xBv, int yBv, int ctuSize) const</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06817">InterSearch.cpp:6817</a></div></div>
<div class="ttc" id="astructvvenc_1_1PelStorage_html_ae71ed6a359a035891f1e1b201ed99813"><div class="ttname"><a href="structvvenc_1_1PelStorage.html#ae71ed6a359a035891f1e1b201ed99813">vvenc::PelStorage::create</a></div><div class="ttdeci">void create(const UnitArea &amp;_unit)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8cpp_source.html#l00814">Buffer.cpp:814</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ab28e0caee71d21ed19f59303e11a1ef7"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ab28e0caee71d21ed19f59303e11a1ef7">vvenc::CodingStructure::releaseIntermediateData</a></div><div class="ttdeci">void releaseIntermediateData()</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l00139">CodingStructure.cpp:139</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_ac541e4f875501dce06e356504d2283cc"><div class="ttname"><a href="classvvenc_1_1Mv.html#ac541e4f875501dce06e356504d2283cc">vvenc::Mv::clipToStorageBitDepth</a></div><div class="ttdeci">void clipToStorageBitDepth()</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00269">Mv.h:269</a></div></div>
<div class="ttc" id="astructvvenc_1_1ReuseUniMv_html_af41b91ef5d3fd1bd030c6d57ed223d9c"><div class="ttname"><a href="structvvenc_1_1ReuseUniMv.html#af41b91ef5d3fd1bd030c6d57ed223d9c">vvenc::ReuseUniMv::resetReusedUniMvs</a></div><div class="ttdeci">void resetReusedUniMvs()</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00341">InterSearch.cpp:341</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CS_html_a3fb95e33195ec4a44e586f6f8480fa38"><div class="ttname"><a href="namespacevvenc_1_1CS.html#a3fb95e33195ec4a44e586f6f8480fa38">vvenc::CS::getArea</a></div><div class="ttdeci">UnitArea getArea(const CodingStructure &amp;cs, const UnitArea &amp;area, const ChannelType chType, const TreeType treeType)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l00076">UnitTools.cpp:76</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a468243d03af504bd2e985e3ab56691da"><div class="ttname"><a href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691da">vvenc::PartSplit</a></div><div class="ttdeci">PartSplit</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00070">UnitPartitioner.h:70</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a3adb61022e07cfeb1c5112be359930d4"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a3adb61022e07cfeb1c5112be359930d4">vvenc::InterSearch::xPatternSearchFracDIF</a></div><div class="ttdeci">void xPatternSearchFracDIF(const CodingUnit &amp;cu, RefPicList refPicList, int iRefIdx, TZSearchStruct &amp;cStruct, const Mv &amp;rcMvInt, Mv &amp;rcMvHalf, Mv &amp;rcMvQter, Distortion &amp;ruiCost)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02864">InterSearch.cpp:2864</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_ac0de654f5be7ffeb0a468a36a6f5f522"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#ac0de654f5be7ffeb0a468a36a6f5f522">vvenc::TransformUnit::cbf</a></div><div class="ttdeci">uint8_t cbf[MAX_NUM_TBLOCKS]</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00414">Unit.h:414</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_ab1d8dda7a67461e9a09ec2c7a414a129"><div class="ttname"><a href="classvvenc_1_1Mv.html#ab1d8dda7a67461e9a09ec2c7a414a129">vvenc::Mv::roundTransPrecInternal2Amvr</a></div><div class="ttdeci">void roundTransPrecInternal2Amvr(const int amvr)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00226">Mv.h:226</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineAMVPInfo_html_a711ec6926c7dd06a0e59636e89c648f9"><div class="ttname"><a href="structvvenc_1_1AffineAMVPInfo.html#a711ec6926c7dd06a0e59636e89c648f9">vvenc::AffineAMVPInfo::numCand</a></div><div class="ttdeci">unsigned numCand</div><div class="ttdoc">number of motion vector predictor candidates</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00077">MotionInfo.h:77</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af6fcdb72acb1320cf627e46450710f19"><div class="ttname"><a href="namespacevvenc.html#af6fcdb72acb1320cf627e46450710f19">vvenc::getAreaIdxNew</a></div><div class="ttdeci">static void getAreaIdxNew(const Area &amp;area, const PreCalcValues &amp;pcv, unsigned &amp;idx1, unsigned &amp;idx2, unsigned &amp;idx3, unsigned &amp;idx4)</div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8h_source.html#l00098">EncModeCtrl.h:98</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a320790f51783f66cf9f95a6a6ecd5b54"><div class="ttname"><a href="namespacevvenc.html#a320790f51783f66cf9f95a6a6ecd5b54">vvenc::g_miScaling</a></div><div class="ttdeci">const UnitScale g_miScaling(MIN_CU_LOG2, MIN_CU_LOG2)</div><div class="ttdef"><b>Definition:</b> <a href="Rom_8h_source.html#l00199">Rom.h:199</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a2df1dd5ac8070482b6042070f73cffa4"><div class="ttname"><a href="classvvenc_1_1Slice.html#a2df1dd5ac8070482b6042070f73cffa4">vvenc::Slice::isInterB</a></div><div class="ttdeci">bool isInterB() const</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01290">Slice.h:1290</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ac19dbe1a542fc0c0bc8a94fcc55907c8a4a5f003e50e352a3621b5dd637200e65"><div class="ttname"><a href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4a5f003e50e352a3621b5dd637200e65">vvenc::DF_SSE_WTD</a></div><div class="ttdeci">@ DF_SSE_WTD</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00399">TypeDef.h:399</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a684f4005176cc6580b29960d10514bcb"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a684f4005176cc6580b29960d10514bcb">vvenc::InterSearch::xCheckBestAffineMVP</a></div><div class="ttdeci">void xCheckBestAffineMVP(CodingUnit &amp;cu, AffineAMVPInfo &amp;affineAMVPInfo, RefPicList refPicList, Mv acMv[3], Mv acMvPred[3], int &amp;riMVPIdx, uint32_t &amp;ruiBits, Distortion &amp;ruiCost)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05469">InterSearch.cpp:5469</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_ac71f852bf800be16d8fad4f0024c78ad"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#ac71f852bf800be16d8fad4f0024c78ad">vvenc::Partitioner::currPartIdx</a></div><div class="ttdeci">const unsigned currPartIdx() const</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00156">UnitPartitioner.h:156</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_ade7e91ebda6f8dce573eac07a1278a6c"><div class="ttname"><a href="classvvenc_1_1RdCost.html#ade7e91ebda6f8dce573eac07a1278a6c">vvenc::RdCost::selectMotionLambda</a></div><div class="ttdeci">void selectMotionLambda()</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00167">RdCost.h:167</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a0add32f416fb3fc9393a688e7fb27c15"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a0add32f416fb3fc9393a688e7fb27c15">vvenc::InterSearch::xSymRefineMvSearch</a></div><div class="ttdeci">Distortion xSymRefineMvSearch(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, Mv &amp;rcMvCurPred, Mv &amp;rcMvTarPred, RefPicList refPicList, MvField &amp;rCurMvField, MvField &amp;rTarMvField, Distortion uiMinCost, int searchPattern, int nSearchStepShift, uint32_t uiMaxSearchRounds, int BcwIdx)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02943">InterSearch.cpp:2943</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html">vvenc::AreaBuf&lt; const Pel &gt;</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a1f0cc4c41acf6121c238f776a9ceb422"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a1f0cc4c41acf6121c238f776a9ceb422">vvenc::CodingStructure::getResiBuf</a></div><div class="ttdeci">PelBuf getResiBuf(const CompArea &amp;blk)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00270">CodingStructure.h:270</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ae3db8bd7af8828db0c0fdc98c13412e2"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ae3db8bd7af8828db0c0fdc98c13412e2">vvenc::CodingStructure::cost</a></div><div class="ttdeci">double cost</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00160">CodingStructure.h:160</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CacheBlkInfoCtrl_html_a9e6b9048415132cad893bff62bb8f315"><div class="ttname"><a href="classvvenc_1_1CacheBlkInfoCtrl.html#a9e6b9048415132cad893bff62bb8f315">vvenc::CacheBlkInfoCtrl::findBestSbt</a></div><div class="ttdeci">uint8_t findBestSbt(const UnitArea &amp;area, const uint32_t curPuSse)</div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8cpp_source.html#l00195">EncModeCtrl.cpp:195</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_a2e1dc15633648502db33304d40ba91df"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#a2e1dc15633648502db33304d40ba91df">vvenc::AreaBuf::bufAt</a></div><div class="ttdeci">T * bufAt(const int &amp;x, const int &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00174">Buffer.h:174</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_a2b627d3ab33f82adcd84ed75e56c8eee"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#a2b627d3ab33f82adcd84ed75e56c8eee">vvenc::CodingUnit::BcwIdx</a></div><div class="ttdeci">uint8_t BcwIdx</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00365">Unit.h:365</a></div></div>
<div class="ttc" id="astructvvenc_1_1EncAffineMotion_html_a4dbcc7261c9dd98be00f210d30864789"><div class="ttname"><a href="structvvenc_1_1EncAffineMotion.html#a4dbcc7261c9dd98be00f210d30864789">vvenc::EncAffineMotion::acMvAffine6Para</a></div><div class="ttdeci">Mv acMvAffine6Para[2][3]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00220">InterSearch.h:220</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_a34eddb3a879db373b6440a82c57b9fec"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#a34eddb3a879db373b6440a82c57b9fec">vvenc::InterPredictionData::ciip</a></div><div class="ttdeci">bool ciip</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00311">Unit.h:311</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a44ef45706c20f722aef32216629c45a3"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a44ef45706c20f722aef32216629c45a3">vvenc::InterSearch::xPatternRefinement</a></div><div class="ttdeci">Distortion xPatternRefinement(const CPelBuf *pcPatternKey, Mv baseRefMv, int iFrac, Mv &amp;rcMvFrac, bool bAllowUseOfHadamard, Distortion &amp;uiDistBest, int &amp;patternId, CPelBuf *pattern, bool useAltHpelIf)</div><div class="ttdoc">sub-function for motion vector refinement used in fractional-pel accuracy</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00815">InterSearch.cpp:815</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_ac4c9ebbb4c60ed66879bc0a40bda4b11"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#ac4c9ebbb4c60ed66879bc0a40bda4b11">vvenc::CodingUnit::imv</a></div><div class="ttdeci">uint8_t imv</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00361">Unit.h:361</a></div></div>
<div class="ttc" id="astructvvenc_1_1MvField_html_a9cb9df9920b8148137643c69f8310b54"><div class="ttname"><a href="structvvenc_1_1MvField.html#a9cb9df9920b8148137643c69f8310b54">vvenc::MvField::mv</a></div><div class="ttdeci">Mv mv</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00087">MotionInfo.h:87</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a0705c021d68ecb01bbf299f0aa4fe327"><div class="ttname"><a href="classvvenc_1_1Slice.html#a0705c021d68ecb01bbf299f0aa4fe327">vvenc::Slice::pps</a></div><div class="ttdeci">const PPS * pps</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01234">Slice.h:1234</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a788273bea30966f2f3088cc9d64f2f33"><div class="ttname"><a href="namespacevvenc.html#a788273bea30966f2f3088cc9d64f2f33">vvenc::Pel</a></div><div class="ttdeci">int16_t Pel</div><div class="ttdoc">pixel type</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00191">TypeDef.h:191</a></div></div>
<div class="ttc" id="astructvvenc_1_1BlkUniMvInfo_html"><div class="ttname"><a href="structvvenc_1_1BlkUniMvInfo.html">vvenc::BlkUniMvInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00092">InterSearch.h:92</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a7b69f3427bf39ba0ecfa86151461ec7d"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a7b69f3427bf39ba0ecfa86151461ec7d">vvenc::InterSearch::xCopyAffineAMVPInfo</a></div><div class="ttdeci">void xCopyAffineAMVPInfo(AffineAMVPInfo &amp;src, AffineAMVPInfo &amp;dst)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05968">InterSearch.cpp:5968</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineProfList_html_add4fcdf487f8ef726f83fcc91719350f"><div class="ttname"><a href="structvvenc_1_1AffineProfList.html#add4fcdf487f8ef726f83fcc91719350f">vvenc::AffineProfList::m_affMVListSize</a></div><div class="ttdeci">int m_affMVListSize</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00329">InterSearch.h:329</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_a11a11dea891ee137a4a756ba94caaed1"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#a11a11dea891ee137a4a756ba94caaed1">vvenc::Partitioner::currTrDepth</a></div><div class="ttdeci">unsigned currTrDepth</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00136">UnitPartitioner.h:136</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html_ac402a78434b540bc32cc370e4a69aace"><div class="ttname"><a href="classvvenc_1_1TrQuant.html#ac402a78434b540bc32cc370e4a69aace">vvenc::TrQuant::checktransformsNxN</a></div><div class="ttdeci">void checktransformsNxN(TransformUnit &amp;tu, std::vector&lt; TrMode &gt; *trModes, const int maxCand, const ComponentID compID=COMP_Y)</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8cpp_source.html#l00704">TrQuant.cpp:704</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_ad61aa9a273106df7421a4735424caa70"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#ad61aa9a273106df7421a4735424caa70">vvenc::TransformUnit::noResidual</a></div><div class="ttdeci">bool noResidual</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00411">Unit.h:411</a></div></div>
<div class="ttc" id="aMotionInfo_8h_html"><div class="ttname"><a href="MotionInfo_8h.html">MotionInfo.h</a></div><div class="ttdoc">motion information handling classes (header)</div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a23a6f1ead4939bc6154475ae86dda34b"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a23a6f1ead4939bc6154475ae86dda34b">vvenc::InterSearch::xEncodeInterResidualQT</a></div><div class="ttdeci">void xEncodeInterResidualQT(CodingStructure &amp;cs, Partitioner &amp;partitioner, const ComponentID compID)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l03348">InterSearch.cpp:3348</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a93cea48eb9dcfd661168dee82e41b384"><div class="ttname"><a href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384">vvenc::RefPicList</a></div><div class="ttdeci">RefPicList</div><div class="ttdoc">reference list index</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00353">TypeDef.h:353</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab4631bf16a955dfd7bae49c7f6a71c13"><div class="ttname"><a href="namespacevvenc.html#ab4631bf16a955dfd7bae49c7f6a71c13">vvenc::BCW_DEFAULT</a></div><div class="ttdeci">static const int BCW_DEFAULT</div><div class="ttdoc">Default weighting index representing for w=0.5.</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00413">CommonDef.h:413</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a977c89bc082dcea4f5b2976cd3401b1d"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a977c89bc082dcea4f5b2976cd3401b1d">vvenc::BcwMotionParam::isReadModeAffine</a></div><div class="ttdeci">bool isReadModeAffine(uint32_t uiRefList, uint32_t uiRefIdx, int bP4)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00288">MotionInfo.h:288</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_a4acf9d693cf1d941b426509c7b0ee4ae"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#a4acf9d693cf1d941b426509c7b0ee4ae">vvenc::InterPredictionData::mergeIdx</a></div><div class="ttdeci">uint8_t mergeIdx</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00314">Unit.h:314</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a1014955f8421b10b97bd219860e426d1"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a1014955f8421b10b97bd219860e426d1">vvenc::InterSearch::xSymMvdCheckBestMvp</a></div><div class="ttdeci">void xSymMvdCheckBestMvp(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, Mv curMv, RefPicList curRefList, AMVPInfo amvpInfo[2][MAX_REF_PICS], int32_t BcwIdx, Mv cMvPredSym[2], int32_t mvpIdxSym[2], Distortion &amp;bestCost, bool skip)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04622">InterSearch.cpp:4622</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitBuf_html_af907ad3e49a30f4c2990626baf9bde6a"><div class="ttname"><a href="structvvenc_1_1UnitBuf.html#af907ad3e49a30f4c2990626baf9bde6a">vvenc::UnitBuf::removeHighFreq</a></div><div class="ttdeci">void removeHighFreq(const UnitBuf&lt; const T &gt; &amp;other, const bool bClip, const ClpRngs &amp;clpRngs)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00873">Buffer.h:873</a></div></div>
<div class="ttc" id="anamespacevvenc_html"><div class="ttname"><a href="namespacevvenc.html">vvenc</a></div><div class="ttdef"><b>Definition:</b> <a href="AdaptiveLoopFilter_8cpp_source.html#l00064">AdaptiveLoopFilter.cpp:64</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_a88bb703eac6229fa13e371d365da83e9"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#a88bb703eac6229fa13e371d365da83e9">vvenc::CABACWriter::getEstFracBits</a></div><div class="ttdeci">uint64_t getEstFracBits() const</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8h_source.html#l00079">CABACWriter.h:79</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a4f79f54e78034e5a883a8db14dda02db"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a4f79f54e78034e5a883a8db14dda02db">vvenc::InterSearch::m_ctuRecord</a></div><div class="ttdeci">std::unordered_map&lt; Position, std::unordered_map&lt; Size, BlkRecord &gt; &gt; m_ctuRecord</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00356">InterSearch.h:356</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitBuf_html_a59fa1e9c0d0dafd04140d8e96323587f"><div class="ttname"><a href="structvvenc_1_1UnitBuf.html#a59fa1e9c0d0dafd04140d8e96323587f">vvenc::UnitBuf::get</a></div><div class="ttdeci">AreaBuf&lt; T &gt; &amp; get(const ComponentID comp)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00676">Buffer.h:676</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a0705c021d68ecb01bbf299f0aa4fe327"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a0705c021d68ecb01bbf299f0aa4fe327">vvenc::CodingStructure::pps</a></div><div class="ttdeci">const PPS * pps</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00106">CodingStructure.h:106</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ad78b260566db7787b860f3d09a32b591"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ad78b260566db7787b860f3d09a32b591">vvenc::InterSearch::m_modeCtrl</a></div><div class="ttdeci">EncModeCtrl * m_modeCtrl</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00346">InterSearch.h:346</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html"><div class="ttname"><a href="structvvenc_1_1SPS.html">vvenc::SPS</a></div><div class="ttdoc">SPS class.</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00664">Slice.h:664</a></div></div>
<div class="ttc" id="aclassvvenc_1_1DistParam_html_a8e49433c232922a8af6b1252e0919bab"><div class="ttname"><a href="classvvenc_1_1DistParam.html#a8e49433c232922a8af6b1252e0919bab">vvenc::DistParam::distFunc</a></div><div class="ttdeci">FpDistFunc distFunc</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00083">RdCost.h:83</a></div></div>
<div class="ttc" id="anamespacevvenc_html_addfbcd7236d485fdef78287e1c6693d6"><div class="ttname"><a href="namespacevvenc.html#addfbcd7236d485fdef78287e1c6693d6">vvenc::solveEqual</a></div><div class="ttdeci">void solveEqual(double **dEqualCoeff, int iOrder, double *dAffinePara)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05398">InterSearch.cpp:5398</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a19c81c236ede05b64eae8326f68aaa00"><div class="ttname"><a href="namespacevvenc.html#a19c81c236ede05b64eae8326f68aaa00">vvenc::Intermediate_Int</a></div><div class="ttdeci">int32_t Intermediate_Int</div><div class="ttdoc">used as intermediate value in calculations</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00196">TypeDef.h:196</a></div></div>
<div class="ttc" id="astructvvenc_1_1MvField_html_aea2c38f5f62debd5c97efd76faee25e5"><div class="ttname"><a href="structvvenc_1_1MvField.html#aea2c38f5f62debd5c97efd76faee25e5">vvenc::MvField::setMvField</a></div><div class="ttdeci">void setMvField(Mv const &amp;cMv, const int iRefIdx)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00093">MotionInfo.h:93</a></div></div>
<div class="ttc" id="astructvvenc_1_1ReuseUniMv_html_a9805ca709d89fc0992774813b59c5002"><div class="ttname"><a href="structvvenc_1_1ReuseUniMv.html#a9805ca709d89fc0992774813b59c5002">vvenc::ReuseUniMv::m_reusedUniMVs</a></div><div class="ttdeci">Mv * m_reusedUniMVs[6][6][32][32]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00335">InterSearch.h:335</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ac5289e15fcc41d93fc27a1efcde294d2"><div class="ttname"><a href="namespacevvenc.html#ac5289e15fcc41d93fc27a1efcde294d2">vvenc::isLuma</a></div><div class="ttdeci">static bool isLuma(const ComponentID id)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00776">CommonDef.h:776</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineMVInfo_html_a6150e0515f7202e2fb518f7206ed97dc"><div class="ttname"><a href="structvvenc_1_1AffineMVInfo.html#a6150e0515f7202e2fb518f7206ed97dc">vvenc::AffineMVInfo::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00214">InterSearch.h:214</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_a5807aec71a4db132719a28dc3f094714"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#a5807aec71a4db132719a28dc3f094714">vvenc::CodingUnit::treeType</a></div><div class="ttdeci">TreeType treeType</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00350">Unit.h:350</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88a8e9d0ea49be38a05b06f289bf0999806"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a8e9d0ea49be38a05b06f289bf0999806">vvenc::SBT_VER_Q1</a></div><div class="ttdeci">@ SBT_VER_Q1</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00300">TypeDef.h:300</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a9dba2390376b36d2a779733a99663842"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a9dba2390376b36d2a779733a99663842">vvenc::CU::isSepTree</a></div><div class="ttdeci">bool isSepTree(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8h_source.html#l00074">UnitTools.h:74</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_a29797796fb9219a304cfd3afbcc9788b"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#a29797796fb9219a304cfd3afbcc9788b">vvenc::TransformUnit::mtsIdx</a></div><div class="ttdeci">uint8_t mtsIdx[MAX_NUM_TBLOCKS]</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00413">Unit.h:413</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a79022b9c1d9d40b790a4c560e077609d"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a79022b9c1d9d40b790a4c560e077609d">vvenc::CU::setAllAffineMv</a></div><div class="ttdeci">void setAllAffineMv(CodingUnit &amp;cu, Mv affLT, Mv affRT, Mv affLB, RefPicList eRefList, bool clipCPMVs=false)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l02900">UnitTools.cpp:2900</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a44e382c87c7c2f4ac097f79b2c86fdfe"><div class="ttname"><a href="classvvenc_1_1Mv.html#a44e382c87c7c2f4ac097f79b2c86fdfe">vvenc::Mv::roundAffinePrecInternal2Amvr</a></div><div class="ttdeci">void roundAffinePrecInternal2Amvr(const int amvr)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00242">Mv.h:242</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a3c5f47d1cb0d7e4ef40d949ad2c12ba7"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a3c5f47d1cb0d7e4ef40d949ad2c12ba7">vvenc::BcwMotionParam::copyAffineMvFrom</a></div><div class="ttdeci">void copyAffineMvFrom(Mv(&amp;racAffineMvs)[3], Distortion uiDist, uint32_t uiRefList, uint32_t uiRefIdx, int bP4, const int mvpIdx)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00306">MotionInfo.h:306</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a4a247be2cddc2ceb84fb7c8bc43f2795"><div class="ttname"><a href="classvvenc_1_1Mv.html#a4a247be2cddc2ceb84fb7c8bc43f2795">vvenc::Mv::roundToPrecision</a></div><div class="ttdeci">void roundToPrecision(const MvPrecision &amp;src, const MvPrecision &amp;dst)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00209">Mv.h:209</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aa391293054038b0549cc65f918625083"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aa391293054038b0549cc65f918625083">vvenc::InterSearch::predIBCSearch</a></div><div class="ttdeci">bool predIBCSearch(CodingUnit &amp;cu, Partitioner &amp;partitioner)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06635">InterSearch.cpp:6635</a></div></div>
<div class="ttc" id="astructvvenc_1_1Size_html_a81ed27f96c08781589ca6ff77043a7b1"><div class="ttname"><a href="structvvenc_1_1Size.html#a81ed27f96c08781589ca6ff77043a7b1">vvenc::Size::width</a></div><div class="ttdeci">SizeType width</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00082">Common.h:82</a></div></div>
<div class="ttc" id="astructvvenc_1_1PicHeader_html_ab397bddbf3c96f9b0fe2d48b16f1b51b"><div class="ttname"><a href="structvvenc_1_1PicHeader.html#ab397bddbf3c96f9b0fe2d48b16f1b51b">vvenc::PicHeader::lmcsChromaResidualScale</a></div><div class="ttdeci">bool lmcsChromaResidualScale</div><div class="ttdoc">lmcs chroma residual scale flag</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01075">Slice.h:1075</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodedCUInfo_html_a0f3e473ce4f36b10586f0b99cf5a7039"><div class="ttname"><a href="structvvenc_1_1CodedCUInfo.html#a0f3e473ce4f36b10586f0b99cf5a7039">vvenc::CodedCUInfo::setMv</a></div><div class="ttdeci">void setMv(const RefPicList refPicList, const int iRefIdx, const Mv &amp;rMv)</div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8cpp_source.html#l00175">EncModeCtrl.cpp:175</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_acae32b49c8110d51785e4657b62fe218"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#acae32b49c8110d51785e4657b62fe218">vvenc::InterSearch::TZSearchStruct::zeroMV</a></div><div class="ttdeci">bool zeroMV</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00470">InterSearch.h:470</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a33d1666f1cc95252c96e39584255954eaba4c54773c9f75ca10798034f712cc5f"><div class="ttname"><a href="namespacevvenc.html#a33d1666f1cc95252c96e39584255954eaba4c54773c9f75ca10798034f712cc5f">vvenc::MODE_INTER</a></div><div class="ttdeci">@ MODE_INTER</div><div class="ttdoc">inter-prediction mode</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00345">TypeDef.h:345</a></div></div>
<div class="ttc" id="astructvvenc_1_1PelStorage_html_a114bf71d73b0b822dc0d52fd1650ad9b"><div class="ttname"><a href="structvvenc_1_1PelStorage.html#a114bf71d73b0b822dc0d52fd1650ad9b">vvenc::PelStorage::getCompactBuf</a></div><div class="ttdeci">PelUnitBuf getCompactBuf(const UnitArea &amp;unit)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8cpp_source.html#l01067">Buffer.cpp:1067</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_aea60229328e71a0629d212abf764ae45"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#aea60229328e71a0629d212abf764ae45">vvenc::UnitArea::block</a></div><div class="ttdeci">CompArea &amp; block(const ComponentID comp)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00210">Unit.h:210</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_ac6a8561b7d9b7867c09f54438aad305a"><div class="ttname"><a href="classvvenc_1_1RdCost.html#ac6a8561b7d9b7867c09f54438aad305a">vvenc::RdCost::getChromaWeight</a></div><div class="ttdeci">double getChromaWeight()</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00155">RdCost.h:155</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a86e63267f0b87eb319b151d10ad84e0f"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a86e63267f0b87eb319b151d10ad84e0f">vvenc::CodingStructure::picHeader</a></div><div class="ttdeci">PicHeader * picHeader</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00107">CodingStructure.h:107</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ac1fb6d2f0f24ad434b770a78ba00d30a"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ac1fb6d2f0f24ad434b770a78ba00d30a">vvenc::CodingStructure::getCU</a></div><div class="ttdeci">const CodingUnit * getCU(const Position &amp;pos, const ChannelType _chType, const TreeType _treeType) const</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l00190">CodingStructure.cpp:190</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_aa6f3e16df807424717e8e8e307c7b629"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#aa6f3e16df807424717e8e8e307c7b629">vvenc::UnitArea::chromaFormat</a></div><div class="ttdeci">ChromaFormat chromaFormat</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00193">Unit.h:193</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a468243d03af504bd2e985e3ab56691daaeea769e763d6528084529497fffd3c64"><div class="ttname"><a href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daaeea769e763d6528084529497fffd3c64">vvenc::CU_HORZ_SPLIT</a></div><div class="ttdeci">@ CU_HORZ_SPLIT</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00075">UnitPartitioner.h:75</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a683c4efab3fe6050a8d58dd6a81a8793"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a683c4efab3fe6050a8d58dd6a81a8793">vvenc::RdCost::setPredictorsIBC</a></div><div class="ttdeci">void setPredictorsIBC(Mv *pcMv)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00196">RdCost.h:196</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a2b416c27fd70dc219f0bdc256a640fb3"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a2b416c27fd70dc219f0bdc256a640fb3">vvenc::InterSearch::xReadBufferedAffineUniMv</a></div><div class="ttdeci">bool xReadBufferedAffineUniMv(CodingUnit &amp;cu, RefPicList eRefPicList, int32_t iRefIdx, Mv acMvPred[3], Mv acMv[3], uint32_t &amp;ruiBits, Distortion &amp;ruiCost, int &amp;mvpIdx, const AffineAMVPInfo &amp;aamvpi)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04595">InterSearch.cpp:4595</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a1fd8169f27a1727cf364b813be1c3f0f"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a1fd8169f27a1727cf364b813be1c3f0f">vvenc::BcwMotionParam::setReadMode</a></div><div class="ttdeci">void setReadMode(bool b, uint32_t uiRefList, uint32_t uiRefIdx)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00284">MotionInfo.h:284</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a27e39e4771fc2c2035bd65e57ca85ead"><div class="ttname"><a href="namespacevvenc.html#a27e39e4771fc2c2035bd65e57ca85ead">vvenc::SplitSeries</a></div><div class="ttdeci">uint64_t SplitSeries</div><div class="ttdoc">used to encoded the splits that caused a particular CU size</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00200">TypeDef.h:200</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_aecc8541b82940a6421844184bc417c09"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#aecc8541b82940a6421844184bc417c09">vvenc::UnitArea::blocks</a></div><div class="ttdeci">UnitBlocksType blocks</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00194">Unit.h:194</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59"><div class="ttname"><a href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a9eef8706f96e8b3511a2450e90075f59">vvenc::CH_L</a></div><div class="ttdeci">@ CH_L</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00217">TypeDef.h:217</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPrediction_html_a9ddbb02a220623fa10f87e6f751e77e6"><div class="ttname"><a href="classvvenc_1_1InterPrediction.html#a9ddbb02a220623fa10f87e6f751e77e6">vvenc::InterPrediction::m_currChromaFormat</a></div><div class="ttdeci">ChromaFormat m_currChromaFormat</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8h_source.html#l00155">InterPrediction.h:155</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ad77d144af5cd4d736ee529e3e74a7367"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ad77d144af5cd4d736ee529e3e74a7367">vvenc::CodingStructure::getRecoBuf</a></div><div class="ttdeci">PelBuf getRecoBuf(const CompArea &amp;blk)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00275">CodingStructure.h:275</a></div></div>
<div class="ttc" id="astructvvenc_1_1Picture_html"><div class="ttname"><a href="structvvenc_1_1Picture.html">vvenc::Picture</a></div><div class="ttdef"><b>Definition:</b> <a href="Picture_8h_source.html#l00143">Picture.h:143</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_af3b393634f7347dadafa6b2698fa0b45"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#af3b393634f7347dadafa6b2698fa0b45">vvenc::CodingStructure::getRspOrgBuf</a></div><div class="ttdeci">PelBuf getRspOrgBuf(const CompArea &amp;blk)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00285">CodingStructure.h:285</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_ad2843a8f1e804927a642166b2bdd4c88"><div class="ttname"><a href="namespacevvenc_1_1CU.html#ad2843a8f1e804927a642166b2bdd4c88">vvenc::CU::fillAffineMvpCand</a></div><div class="ttdeci">void fillAffineMvpCand(CodingUnit &amp;cu, const RefPicList refPicList, const int refIdx, AffineAMVPInfo &amp;affiAMVPInfo)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l01946">UnitTools.cpp:1946</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_a8606fae661fa10aaee9e2e9ee08f16ef"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#a8606fae661fa10aaee9e2e9ee08f16ef">vvenc::TransformUnit::cu</a></div><div class="ttdeci">CodingUnit * cu</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00406">Unit.h:406</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_ad036b5eb236ab3725436ece9cbf93e57"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#ad036b5eb236ab3725436ece9cbf93e57">vvenc::CodingUnit::affine</a></div><div class="ttdeci">bool affine</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00359">Unit.h:359</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a"><div class="ttname"><a href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa3b276b5937d942b2fe5cbfa69d5a016a">vvenc::COMP_Y</a></div><div class="ttdeci">@ COMP_Y</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00224">TypeDef.h:224</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a2d3ec636d347d8ea142e64ca27ceaad4"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a2d3ec636d347d8ea142e64ca27ceaad4">vvenc::CodingStructure::sps</a></div><div class="ttdeci">const SPS * sps</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00105">CodingStructure.h:105</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a8eb9b5b7e65483d0fdd92a3523e937e7"><div class="ttname"><a href="namespacevvenc.html#a8eb9b5b7e65483d0fdd92a3523e937e7">vvenc::SBT_NUM_RDO</a></div><div class="ttdeci">static const int SBT_NUM_RDO</div><div class="ttdoc">maximum number of SBT mode tried for a PU</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00490">CommonDef.h:490</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_accc987d46ab22f80f0a165f428e63451"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#accc987d46ab22f80f0a165f428e63451">vvenc::InterPredictionData::interDir</a></div><div class="ttdeci">uint8_t interDir</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00318">Unit.h:318</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_ae712c51e5029cc6e18d4272f9df547cf"><div class="ttname"><a href="classvvenc_1_1Slice.html#ae712c51e5029cc6e18d4272f9df547cf">vvenc::Slice::isIRAP</a></div><div class="ttdeci">bool isIRAP() const</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01284">Slice.h:1284</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_a1d7e220147dfc5222b5c0e380ee9e734"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#a1d7e220147dfc5222b5c0e380ee9e734">vvenc::CABACWriter::joint_cb_cr</a></div><div class="ttdeci">void joint_cb_cr(const TransformUnit &amp;tu, const int cbfMask)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l02230">CABACWriter.cpp:2230</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a3d559b877ba707a765a8152b4cb2ad59"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a3d559b877ba707a765a8152b4cb2ad59">vvenc::InterSearch::TZSearchStruct::useAltHpelIf</a></div><div class="ttdeci">bool useAltHpelIf</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00468">InterSearch.h:468</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html"><div class="ttname"><a href="classvvenc_1_1TrQuant.html">vvenc::TrQuant</a></div><div class="ttdoc">transform and quantization class</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8h_source.html#l00075">TrQuant.h:75</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a84e1cf4a0c33652ae707c15060de7817"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a84e1cf4a0c33652ae707c15060de7817">vvenc::InterSearch::m_cDistParam</a></div><div class="ttdeci">DistParam m_cDistParam</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00376">InterSearch.h:376</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html">vvenc::CodingStructure</a></div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00086">CodingStructure.h:86</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitBuf_html_a953720746c35b6e0479828e4017eff87"><div class="ttname"><a href="structvvenc_1_1UnitBuf.html#a953720746c35b6e0479828e4017eff87">vvenc::UnitBuf::Y</a></div><div class="ttdeci">AreaBuf&lt; T &gt; &amp; Y()</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00679">Buffer.h:679</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b"><div class="ttname"><a href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca3972746d958807ccb4270f71f94c8a3b">vvenc::MTS_DCT2_DCT2</a></div><div class="ttdeci">@ MTS_DCT2_DCT2</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00258">TypeDef.h:258</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a468243d03af504bd2e985e3ab56691daa5f271ee24260631e632460583d28a51e"><div class="ttname"><a href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daa5f271ee24260631e632460583d28a51e">vvenc::CU_QUAD_SPLIT</a></div><div class="ttdeci">@ CU_QUAD_SPLIT</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00073">UnitPartitioner.h:73</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_ab722b39b132601673d1dcd3547c2c01c"><div class="ttname"><a href="namespacevvenc_1_1CU.html#ab722b39b132601673d1dcd3547c2c01c">vvenc::CU::isIntra</a></div><div class="ttdeci">bool isIntra(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8h_source.html#l00079">UnitTools.h:79</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a0fe73397dafd172ff20c334c5e410663"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a0fe73397dafd172ff20c334c5e410663">vvenc::CodingStructure::traverseTUs</a></div><div class="ttdeci">TUTraverser traverseTUs(const UnitArea &amp;_unit, const ChannelType _chType)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l00543">CodingStructure.cpp:543</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ad33919387852da909ffb76eb0e777817"><div class="ttname"><a href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817">vvenc::EAffineModel</a></div><div class="ttdeci">EAffineModel</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00167">CommonDef.h:167</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af837675097d4327bced55e989582462d"><div class="ttname"><a href="namespacevvenc.html#af837675097d4327bced55e989582462d">vvenc::MAX_UCHAR</a></div><div class="ttdeci">static const uint8_t MAX_UCHAR</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00185">CommonDef.h:185</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a88ca8dd6d8b1535e6ba06c4d988c525b"><div class="ttname"><a href="classvvenc_1_1Mv.html#a88ca8dd6d8b1535e6ba06c4d988c525b">vvenc::Mv::ver</a></div><div class="ttdeci">int ver</div><div class="ttdoc">vertical component of motion vector</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00087">Mv.h:87</a></div></div>
<div class="ttc" id="aclassvvenc_1_1ReshapeData_html_ab39ba02b7f7b8d316d4ff7361a216ece"><div class="ttname"><a href="classvvenc_1_1ReshapeData.html#ab39ba02b7f7b8d316d4ff7361a216ece">vvenc::ReshapeData::getFwdLUT</a></div><div class="ttdeci">const Pel * getFwdLUT() const</div><div class="ttdef"><b>Definition:</b> <a href="Reshape_8h_source.html#l00096">Reshape.h:96</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aaef1d69143f174b210e402096fdec398"><div class="ttname"><a href="namespacevvenc.html#aaef1d69143f174b210e402096fdec398">vvenc::getNumberValidTBlocks</a></div><div class="ttdeci">static uint32_t getNumberValidTBlocks(const PreCalcValues &amp;pcv)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00330">CodingStructure.h:330</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPrediction_html_a5a356ccf97b9f7b33428f6650b6f9da5"><div class="ttname"><a href="classvvenc_1_1InterPrediction.html#a5a356ccf97b9f7b33428f6650b6f9da5">vvenc::InterPrediction::motionCompensation</a></div><div class="ttdeci">bool motionCompensation(CodingUnit &amp;cu, PelUnitBuf &amp;predBuf, const RefPicList refPicList=REF_PIC_LIST_X, PelUnitBuf *predBufDfltWght=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8cpp_source.html#l00468">InterPrediction.cpp:468</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1TU_html_a03a541a415d6446babf0d87c518dbc45"><div class="ttname"><a href="namespacevvenc_1_1TU.html#a03a541a415d6446babf0d87c518dbc45">vvenc::TU::getCbf</a></div><div class="ttdeci">bool getCbf(const TransformUnit &amp;tu, const ComponentID compID)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03565">UnitTools.cpp:3565</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_a698a46d463e05520421479a1ac78eb05"><div class="ttname"><a href="structvvenc_1_1SPS.html#a698a46d463e05520421479a1ac78eb05">vvenc::SPS::bitDepths</a></div><div class="ttdeci">BitDepths bitDepths</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00723">Slice.h:723</a></div></div>
<div class="ttc" id="adtrace__next_8h_html"><div class="ttname"><a href="dtrace__next_8h.html">dtrace_next.h</a></div><div class="ttdoc">DTrace support for next software.</div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ac0a8e9885f1c7c492a6949e06c15c834"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ac0a8e9885f1c7c492a6949e06c15c834">vvenc::CodingStructure::clearTUs</a></div><div class="ttdeci">void clearTUs(bool force=false)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l01053">CodingStructure.cpp:1053</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1SearchRange_html_ad8f5e19e19f12974c9713e920ec54331"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1SearchRange.html#ad8f5e19e19f12974c9713e920ec54331">vvenc::InterSearch::SearchRange::left</a></div><div class="ttdeci">int left</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00448">InterSearch.h:448</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a3949a9fccd6973d7b79db254c57f885a"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a3949a9fccd6973d7b79db254c57f885a">vvenc::RdCost::setPredictor</a></div><div class="ttdeci">void setPredictor(const Mv &amp;rcMv)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00168">RdCost.h:168</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_a06f0abb90ba59ce634a81d1b81af46b4"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#a06f0abb90ba59ce634a81d1b81af46b4">vvenc::TransformUnit::checkTuNoResidual</a></div><div class="ttdeci">void checkTuNoResidual(unsigned idx)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l00572">Unit.cpp:572</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_aced3784fdb696103af780e51233b938d"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#aced3784fdb696103af780e51233b938d">vvenc::CodingUnit::smvdMode</a></div><div class="ttdeci">uint8_t smvdMode</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00367">Unit.h:367</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_a0dadb78ffff3ac601aa8042a12d06d90"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#a0dadb78ffff3ac601aa8042a12d06d90">vvenc::CodingUnit::slice</a></div><div class="ttdeci">Slice * slice</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00337">Unit.h:337</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a468243d03af504bd2e985e3ab56691daa9ec1b74592ecc43bd20e8ae7bfb04192"><div class="ttname"><a href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daa9ec1b74592ecc43bd20e8ae7bfb04192">vvenc::CU_TRIV_SPLIT</a></div><div class="ttdeci">@ CU_TRIV_SPLIT</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00078">UnitPartitioner.h:78</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a159e0290b97daf4943ec29343199e1f3"><div class="ttname"><a href="namespacevvenc.html#a159e0290b97daf4943ec29343199e1f3">vvenc::isYPartBefore</a></div><div class="ttdeci">static bool isYPartBefore(SplitSeries series, const int ctuSizeLog2, const Position &amp;refPos, const Position &amp;pos)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06749">InterSearch.cpp:6749</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a59194d848c38a0c6efdf4ea064905120"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a59194d848c38a0c6efdf4ea064905120">vvenc::InterSearch::~InterSearch</a></div><div class="ttdeci">virtual ~InterSearch()</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00217">InterSearch.cpp:217</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a4521994cc996921f223544e09d194ab9"><div class="ttname"><a href="namespacevvenc.html#a4521994cc996921f223544e09d194ab9">vvenc::MAX_INT</a></div><div class="ttdeci">static const int MAX_INT</div><div class="ttdoc">max. value of signed 32-bit integer</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00183">CommonDef.h:183</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineProfList_html_a708dd38ca21b6001d06e0e7bd8f8ceca"><div class="ttname"><a href="structvvenc_1_1AffineProfList.html#a708dd38ca21b6001d06e0e7bd8f8ceca">vvenc::AffineProfList::m_affMVList</a></div><div class="ttdeci">AffineMVInfo * m_affMVList</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00327">InterSearch.h:327</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a33d1666f1cc95252c96e39584255954ea3771dff51788e6c0254bcf3e9e992602"><div class="ttname"><a href="namespacevvenc.html#a33d1666f1cc95252c96e39584255954ea3771dff51788e6c0254bcf3e9e992602">vvenc::MODE_IBC</a></div><div class="ttdeci">@ MODE_IBC</div><div class="ttdoc">ibc-prediction mode</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00347">TypeDef.h:347</a></div></div>
<div class="ttc" id="aRom_8h_html"><div class="ttname"><a href="Rom_8h.html">Rom.h</a></div><div class="ttdoc">global variables &amp; functions (header)</div></div>
<div class="ttc" id="anamespacevvenc_html_a28fa8a875cf8e2fac67b59efcab043b3"><div class="ttname"><a href="namespacevvenc.html#a28fa8a875cf8e2fac67b59efcab043b3">vvenc::toChannelType</a></div><div class="ttdeci">static ChannelType toChannelType(const ComponentID id)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00780">CommonDef.h:780</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodedCUInfo_html_a6a1848e81d42717020cec39b84c97662"><div class="ttname"><a href="structvvenc_1_1CodedCUInfo.html#a6a1848e81d42717020cec39b84c97662">vvenc::CodedCUInfo::getMv</a></div><div class="ttdeci">bool getMv(const RefPicList refPicList, const int iRefIdx, Mv &amp;rMv) const</div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8cpp_source.html#l00183">EncModeCtrl.cpp:183</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a9c686c694eaa5ea4e414cb623bde0139"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a9c686c694eaa5ea4e414cb623bde0139">vvenc::InterSearch::encodeResAndCalcRdInterCU</a></div><div class="ttdeci">void encodeResAndCalcRdInterCU(CodingStructure &amp;cs, Partitioner &amp;partitioner, const bool skipResidual)</div><div class="ttdoc">set ME search range</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04304">InterSearch.cpp:4304</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aa17b8a45afa5a9835b69acd2a4372fc0"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aa17b8a45afa5a9835b69acd2a4372fc0">vvenc::InterSearch::xMotionEstimation</a></div><div class="ttdeci">void xMotionEstimation(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, RefPicList refPicList, Mv &amp;rcMvPred, int iRefIdxPred, Mv &amp;rcMv, int &amp;riMVPIdx, uint32_t &amp;ruiBits, Distortion &amp;ruiCost, const AMVPInfo &amp;amvpInfo, bool bBi=false)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01965">InterSearch.cpp:1965</a></div></div>
<div class="ttc" id="astructvvenc_1_1EncAffineMotion_html_add89f792c489068f44461d536b5a62e7"><div class="ttname"><a href="structvvenc_1_1EncAffineMotion.html#add89f792c489068f44461d536b5a62e7">vvenc::EncAffineMotion::acMvAffine4Para</a></div><div class="ttdeci">Mv acMvAffine4Para[2][3]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00219">InterSearch.h:219</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a62402c36368db2049cf01d988d38521f"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a62402c36368db2049cf01d988d38521f">vvenc::CU::fillIBCMvpCand</a></div><div class="ttdeci">void fillIBCMvpCand(CodingUnit &amp;cu, AMVPInfo &amp;amvpInfo)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l01633">UnitTools.cpp:1633</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_aee5982fc05f357997165c49af206bd3f"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aee5982fc05f357997165c49af206bd3f">vvenc::InterSearch::TZSearchStruct::uiBestRound</a></div><div class="ttdeci">uint32_t uiBestRound</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00462">InterSearch.h:462</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af18de6ad34637ef1d5e26a867c9a3090a9fe3eb5d1e62f7f7c8480862c62952cd"><div class="ttname"><a href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a9fe3eb5d1e62f7f7c8480862c62952cd">vvenc::SBT_VER_QUAD</a></div><div class="ttdeci">@ SBT_VER_QUAD</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00280">TypeDef.h:280</a></div></div>
<div class="ttc" id="astructvvenc_1_1IbcBvCand_html"><div class="ttname"><a href="structvvenc_1_1IbcBvCand.html">vvenc::IbcBvCand</a></div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00236">MotionInfo.h:236</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineAMVPInfo_html_ac69f463823ccd1f2aedc11ec6da06840"><div class="ttname"><a href="structvvenc_1_1AffineAMVPInfo.html#ac69f463823ccd1f2aedc11ec6da06840">vvenc::AffineAMVPInfo::mvCandRT</a></div><div class="ttdeci">Mv mvCandRT[AMVP_MAX_NUM_CANDS_MEM]</div><div class="ttdoc">array of affine motion vector predictor candidates for right-top corner</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00075">MotionInfo.h:75</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af18de6ad34637ef1d5e26a867c9a3090a2e0ddb9e99d386c945eee355baa5ebff"><div class="ttname"><a href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a2e0ddb9e99d386c945eee355baa5ebff">vvenc::SBT_HOR_HALF</a></div><div class="ttdeci">@ SBT_HOR_HALF</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00279">TypeDef.h:279</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html_ae88b42646e4ac67be7437f88406d2285"><div class="ttname"><a href="classvvenc_1_1TrQuant.html#ae88b42646e4ac67be7437f88406d2285">vvenc::TrQuant::scaleLambda</a></div><div class="ttdeci">void scaleLambda(const double scale)</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8h_source.html#l00105">TrQuant.h:105</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ad63bfa3ac9511f55501c000f8dda5cd4"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ad63bfa3ac9511f55501c000f8dda5cd4">vvenc::InterSearch::xGetSymbolFracBitsInter</a></div><div class="ttdeci">uint64_t xGetSymbolFracBitsInter(CodingStructure &amp;cs, Partitioner &amp;partitioner)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04525">InterSearch.cpp:4525</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a19852e52eee8260a242359ede1e23084"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a19852e52eee8260a242359ede1e23084">vvenc::CodingStructure::addEmptyTUs</a></div><div class="ttdeci">void addEmptyTUs(Partitioner &amp;partitioner, CodingUnit *cu)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l00476">CodingStructure.cpp:476</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_ae1bbbd55def18448ddeabb935a7737b6"><div class="ttname"><a href="classvvenc_1_1Slice.html#ae1bbbd55def18448ddeabb935a7737b6">vvenc::Slice::numRefIdx</a></div><div class="ttdeci">int numRefIdx[NUM_REF_PIC_LIST_01]</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01215">Slice.h:1215</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a4d2693dc3415aea5989af195238f0981"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a4d2693dc3415aea5989af195238f0981">vvenc::InterSearch::xCopyAMVPInfo</a></div><div class="ttdeci">void xCopyAMVPInfo(AMVPInfo *pSrc, AMVPInfo *pDst)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01869">InterSearch.cpp:1869</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ab8a6995c17585382789cecac84fe4846"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ab8a6995c17585382789cecac84fe4846">vvenc::InterSearch::m_uniMotions</a></div><div class="ttdeci">BcwMotionParam m_uniMotions</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00394">InterSearch.h:394</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_af53c99ea0459bcfb52dcf7795770cedb"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#af53c99ea0459bcfb52dcf7795770cedb">vvenc::InterSearch::xGetSymCost</a></div><div class="ttdeci">Distortion xGetSymCost(const CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, RefPicList eCurRefPicList, const MvField &amp;cCurMvField, MvField &amp;cTarMvField, int BcwIdx)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02912">InterSearch.cpp:2912</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_a68128e69afc12c69e4236eca1b1dc803"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#a68128e69afc12c69e4236eca1b1dc803">vvenc::TransformUnit::chromaAdj</a></div><div class="ttdeci">int chromaAdj</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00409">Unit.h:409</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a7c89d15e3cd1f22016e3c0c3f506b9ca"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a7c89d15e3cd1f22016e3c0c3f506b9ca">vvenc::CU::isBipredRestriction</a></div><div class="ttdeci">bool isBipredRestriction(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l02211">UnitTools.cpp:2211</a></div></div>
<div class="ttc" id="astructvvenc_1_1PPS_html_a629ec9ecf9a6f29222d0e149bf1573c2"><div class="ttname"><a href="structvvenc_1_1PPS.html#a629ec9ecf9a6f29222d0e149bf1573c2">vvenc::PPS::picHeightInLumaSamples</a></div><div class="ttdeci">uint32_t picHeightInLumaSamples</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00929">Slice.h:929</a></div></div>
<div class="ttc" id="astructvvenc_1_1ClpRng_html"><div class="ttname"><a href="structvvenc_1_1ClpRng.html">vvenc::ClpRng</a></div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00558">CommonDef.h:558</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a8fa9cb2e57dd3bbe496fe276a1a44984"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a8fa9cb2e57dd3bbe496fe276a1a44984">vvenc::InterSearch::TZSearchStruct::subShiftMode</a></div><div class="ttdeci">int subShiftMode</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00466">InterSearch.h:466</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aaca07f8b20ac1f70e0ce73bc01c70c90"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aaca07f8b20ac1f70e0ce73bc01c70c90">vvenc::InterSearch::setCtuEncRsrc</a></div><div class="ttdeci">void setCtuEncRsrc(CABACWriter *cabacEstimator, CtxCache *ctxCache, ReuseUniMv *pReuseUniMv, BlkUniMvInfoBuffer *pBlkUniMvInfoBuffer, AffineProfList *pAffineProfList, IbcBvCand *pCachedBvs)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00307">InterSearch.cpp:307</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_ae418053da28e3f07a1ced285eee38c13"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#ae418053da28e3f07a1ced285eee38c13">vvenc::AreaBuf::reconstruct</a></div><div class="ttdeci">void reconstruct(const AreaBuf&lt; const T &gt; &amp;pred, const AreaBuf&lt; const T &gt; &amp;resi, const ClpRng &amp;clpRng)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00379">Buffer.h:379</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_a165820082d9eeb0308c4acc06f599284"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#a165820082d9eeb0308c4acc06f599284">vvenc::AreaBuf::scaleSignal</a></div><div class="ttdeci">void scaleSignal(const int scale, const bool dir, const ClpRng &amp;clpRng)</div></div>
<div class="ttc" id="aclassvvenc_1_1static__vector_html_a60304b65bf89363bcc3165d3cde67f86"><div class="ttname"><a href="classvvenc_1_1static__vector.html#a60304b65bf89363bcc3165d3cde67f86">vvenc::static_vector::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00758">TypeDef.h:758</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a0c699bdbc1a9429237559d7ef5559bdd">vvenc::NUMBER_SBT_MODE</a></div><div class="ttdeci">@ NUMBER_SBT_MODE</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00303">TypeDef.h:303</a></div></div>
<div class="ttc" id="astructvvenc_1_1CUCtx_html_af5ca41eb85bff40ec28a48c3b0860284"><div class="ttname"><a href="structvvenc_1_1CUCtx.html#af5ca41eb85bff40ec28a48c3b0860284">vvenc::CUCtx::isChromaQpAdjCoded</a></div><div class="ttdeci">bool isChromaQpAdjCoded</div><div class="ttdef"><b>Definition:</b> <a href="ContextModelling_8h_source.html#l00444">ContextModelling.h:444</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_ae103fd996569d9263bf3df7e19147ac0"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ae103fd996569d9263bf3df7e19147ac0">vvenc::InterSearch::TZSearchStruct::uiBestDistance</a></div><div class="ttdeci">uint32_t uiBestDistance</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00463">InterSearch.h:463</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a13b80290d7963cd27cc751f73020a798"><div class="ttname"><a href="classvvenc_1_1Mv.html#a13b80290d7963cd27cc751f73020a798">vvenc::Mv::getSymmvdMv</a></div><div class="ttdeci">Mv getSymmvdMv(const Mv &amp;curMvPred, const Mv &amp;tarMvPred)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00264">Mv.h:264</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_acc2b42675b2a7422042407b224435ac7"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#acc2b42675b2a7422042407b224435ac7">vvenc::CABACWriter::residual_coding</a></div><div class="ttdeci">void residual_coding(const TransformUnit &amp;tu, ComponentID compID, CUCtx *cuCtx=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l02245">CABACWriter.cpp:2245</a></div></div>
<div class="ttc" id="astructvvenc_1_1AMVPInfo_html_a5129d4725372149e5d4fdbaa4dc2a7e1"><div class="ttname"><a href="structvvenc_1_1AMVPInfo.html#a5129d4725372149e5d4fdbaa4dc2a7e1">vvenc::AMVPInfo::mvCand</a></div><div class="ttdeci">Mv mvCand[AMVP_MAX_NUM_CANDS_MEM]</div><div class="ttdoc">array of motion vector predictor candidates</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00068">MotionInfo.h:68</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f"><div class="ttname"><a href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384aa88066480c98761d3cc63fbcb164ac1f">vvenc::REF_PIC_LIST_1</a></div><div class="ttdeci">@ REF_PIC_LIST_1</div><div class="ttdoc">reference list 1</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00356">TypeDef.h:356</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_af1fa96a850f404aded578d3e29dedbcb"><div class="ttname"><a href="classvvenc_1_1Slice.html#af1fa96a850f404aded578d3e29dedbcb">vvenc::Slice::poc</a></div><div class="ttdeci">int poc</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01185">Slice.h:1185</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381"><div class="ttname"><a href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a10472d7c99a4ca4572bad38725b41381">vvenc::MV_PRECISION_INT</a></div><div class="ttdeci">@ MV_PRECISION_INT</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00067">Mv.h:67</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_a52609774fae02bf0caf55120ed83adc5"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#a52609774fae02bf0caf55120ed83adc5">vvenc::InterPredictionData::mcControl</a></div><div class="ttdeci">uint8_t mcControl</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00319">Unit.h:319</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a68106a08253d342623282a38b62c0fae"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a68106a08253d342623282a38b62c0fae">vvenc::InterSearch::xTZ8PointSquareSearch</a></div><div class="ttdeci">void xTZ8PointSquareSearch(TZSearchStruct &amp;rcStruct, const int iStartX, const int iStartY, const int iDist)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00561">InterSearch.cpp:561</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ace6b0a8e41a7e3012e9dc21ccb253c68"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ace6b0a8e41a7e3012e9dc21ccb253c68">vvenc::InterSearch::xIntraPatternSearchIBC</a></div><div class="ttdeci">void xIntraPatternSearchIBC(CodingUnit &amp;pu, TZSearchStruct &amp;cStruct, Mv &amp;rcMv, Distortion &amp;ruiCost, Mv *cMvSrchRngLT, Mv *cMvSrchRngRB, Mv *pcMvPred)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06173">InterSearch.cpp:6173</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a855fa44b8d0233bd0eee95e99883e667"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a855fa44b8d0233bd0eee95e99883e667">vvenc::InterSearch::loadGlobalUniMvs</a></div><div class="ttdeci">void loadGlobalUniMvs(const Area &amp;lumaArea, const PreCalcValues &amp;pcv)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00364">InterSearch.cpp:364</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_a34b3e020ef4d15f9b2442bfff37f19b8"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#a34b3e020ef4d15f9b2442bfff37f19b8">vvenc::AreaBuf::fill</a></div><div class="ttdeci">void fill(const T &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00288">Buffer.h:288</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_ac035b35d90e1d9ee57b109a0a3a29333"><div class="ttname"><a href="classvvenc_1_1RdCost.html#ac035b35d90e1d9ee57b109a0a3a29333">vvenc::RdCost::getBitsOfVectorWithPredictor</a></div><div class="ttdeci">uint32_t getBitsOfVectorWithPredictor(const int x, const int y, const unsigned imvShift)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00192">RdCost.h:192</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aec99234fd92e769ccc6d0e0f46cee0bb"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aec99234fd92e769ccc6d0e0f46cee0bb">vvenc::InterSearch::InterSearch</a></div><div class="ttdeci">InterSearch()</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00193">InterSearch.cpp:193</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_aae6a5c38493d414d2cdba9518d91e20e"><div class="ttname"><a href="structvvenc_1_1SPS.html#aae6a5c38493d414d2cdba9518d91e20e">vvenc::SPS::maxNumIBCMergeCand</a></div><div class="ttdeci">uint32_t maxNumIBCMergeCand</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00819">Slice.h:819</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_afabc33c7c4328921490982de50e35da0"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#afabc33c7c4328921490982de50e35da0">vvenc::InterSearch::m_pcEncCfg</a></div><div class="ttdeci">const VVEncCfg * m_pcEncCfg</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00360">InterSearch.h:360</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a554f238ef569ea05b99bbef4a0972ae1"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a554f238ef569ea05b99bbef4a0972ae1">vvenc::InterSearch::xCheckBestMVP</a></div><div class="ttdeci">void xCheckBestMVP(RefPicList refPicList, const Mv &amp;cMv, Mv &amp;rcMvPred, int &amp;riMVPIdx, AMVPInfo &amp;amvpInfo, uint32_t &amp;ruiBits, Distortion &amp;ruiCost, const uint8_t imv)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01878">InterSearch.cpp:1878</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_af2eecbd6936ec23d3bd8962fff7e65a7"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#af2eecbd6936ec23d3bd8962fff7e65a7">vvenc::InterSearch::m_CABACEstimator</a></div><div class="ttdeci">CABACWriter * m_CABACEstimator</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00374">InterSearch.h:374</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a0345a1771d19eb6e5d358993984cebbc"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a0345a1771d19eb6e5d358993984cebbc">vvenc::InterSearch::m_tmpAffiError</a></div><div class="ttdeci">Pel * m_tmpAffiError</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00382">InterSearch.h:382</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a615b0ae447d27969b70c4306f57dec7c"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a615b0ae447d27969b70c4306f57dec7c">vvenc::RdCost::setDistParam</a></div><div class="ttdeci">void setDistParam(DistParam &amp;rcDP, const CPelBuf &amp;org, const Pel *piRefY, int iRefStride, int bitDepth, ComponentID compID, int subShiftMode=0, bool useHadamard=false)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8cpp_source.html#l00141">RdCost.cpp:141</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ab9dff1babd6605466544eab335cbf1e1"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ab9dff1babd6605466544eab335cbf1e1">vvenc::InterSearch::xSetIntraSearchRangeIBC</a></div><div class="ttdeci">void xSetIntraSearchRangeIBC(CodingUnit &amp;pu, int iRoiWidth, int iRoiHeight, Mv &amp;rcMvSrchRngLT, Mv &amp;rcMvSrchRngRB)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06600">InterSearch.cpp:6600</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a2f2a8fb396fa1416e8a8ce3393fdcc93"><div class="ttname"><a href="namespacevvenc.html#a2f2a8fb396fa1416e8a8ce3393fdcc93">vvenc::getBcwWeight</a></div><div class="ttdeci">int8_t getBcwWeight(uint8_t bcwIdx, uint8_t uhRefFrmList)</div><div class="ttdef"><b>Definition:</b> <a href="Rom_8cpp_source.html#l00597">Rom.cpp:597</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a3b6992dd0d30d043f87cb65a22bceb38"><div class="ttname"><a href="classvvenc_1_1Slice.html#a3b6992dd0d30d043f87cb65a22bceb38">vvenc::Slice::checkLDC</a></div><div class="ttdeci">bool checkLDC</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01217">Slice.h:1217</a></div></div>
<div class="ttc" id="astructvvenc_1_1Picture_html_abf1a8b43357468a369a08f71ff4bdd88"><div class="ttname"><a href="structvvenc_1_1Picture.html#abf1a8b43357468a369a08f71ff4bdd88">vvenc::Picture::getPOC</a></div><div class="ttdeci">int getPOC() const</div><div class="ttdef"><b>Definition:</b> <a href="Picture_8h_source.html#l00157">Picture.h:157</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a75a83a0a00e270faf5de49d10aaa9463"><div class="ttname"><a href="classvvenc_1_1Slice.html#a75a83a0a00e270faf5de49d10aaa9463">vvenc::Slice::list1IdxToList0Idx</a></div><div class="ttdeci">int list1IdxToList0Idx[MAX_NUM_REF]</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01214">Slice.h:1214</a></div></div>
<div class="ttc" id="astructvvenc_1_1Picture_html_aee021e1a0b2774638746e6e9e76a5519"><div class="ttname"><a href="structvvenc_1_1Picture.html#aee021e1a0b2774638746e6e9e76a5519">vvenc::Picture::getRecoBuf</a></div><div class="ttdeci">PelBuf getRecoBuf(const ComponentID compID)</div><div class="ttdef"><b>Definition:</b> <a href="Picture_8h_source.html#l00166">Picture.h:166</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a47affd1a10b589811fc4828c1a2e0c6d"><div class="ttname"><a href="classvvenc_1_1Mv.html#a47affd1a10b589811fc4828c1a2e0c6d">vvenc::Mv::setZero</a></div><div class="ttdeci">void setZero()</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00101">Mv.h:101</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aa5c47604d0ab475cfa89c25a1fafb84c"><div class="ttname"><a href="namespacevvenc.html#aa5c47604d0ab475cfa89c25a1fafb84c">vvenc::MV_MAX</a></div><div class="ttdeci">static constexpr int MV_MAX</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00511">CommonDef.h:511</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab71c686caef0807c59fec6468d277dd8a0515f94079bb68ffa3cece37a4777779"><div class="ttname"><a href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a0515f94079bb68ffa3cece37a4777779">vvenc::MV_PRECISION_4PEL</a></div><div class="ttdeci">@ MV_PRECISION_4PEL</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00066">Mv.h:66</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_accb7b768fa738f821e3fe8d1ea23da9b"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#accb7b768fa738f821e3fe8d1ea23da9b">vvenc::InterPredictionData::mvpNum</a></div><div class="ttdeci">uint8_t mvpNum[NUM_REF_PIC_LIST_01]</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00325">Unit.h:325</a></div></div>
<div class="ttc" id="astructvvenc_1_1EncAffineMotion_html_ae020ae260f3c6c7459d1264c96f43306"><div class="ttname"><a href="structvvenc_1_1EncAffineMotion.html#ae020ae260f3c6c7459d1264c96f43306">vvenc::EncAffineMotion::affine4ParaRefIdx</a></div><div class="ttdeci">int16_t affine4ParaRefIdx[2]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00221">InterSearch.h:221</a></div></div>
<div class="ttc" id="adtrace__buffer_8h_html"><div class="ttname"><a href="dtrace__buffer_8h.html">dtrace_buffer.h</a></div><div class="ttdoc">Easy to use dtrace calls concerning buffers.</div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a6e865206f093a60bfa306a09653cc07c"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a6e865206f093a60bfa306a09653cc07c">vvenc::InterSearch::m_estMinDistSbt</a></div><div class="ttdeci">Distortion m_estMinDistSbt[NUMBER_SBT_MODE+1]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00390">InterSearch.h:390</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a225fcf6af87aa6be56d6d832e730c40f"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a225fcf6af87aa6be56d6d832e730c40f">vvenc::InterSearch::m_auiMVPIdxCost</a></div><div class="ttdeci">uint32_t m_auiMVPIdxCost[AMVP_MAX_NUM_CANDS+1][AMVP_MAX_NUM_CANDS+1]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00389">InterSearch.h:389</a></div></div>
<div class="ttc" id="astructvvenc_1_1CompArea_html_a315419f26d3c59fa143b49b90a019049"><div class="ttname"><a href="structvvenc_1_1CompArea.html#a315419f26d3c59fa143b49b90a019049">vvenc::CompArea::valid</a></div><div class="ttdeci">bool valid() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00160">Unit.h:160</a></div></div>
<div class="ttc" id="astructvvenc_1_1CompStorage_html"><div class="ttname"><a href="structvvenc_1_1CompStorage.html">vvenc::CompStorage</a></div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00960">Buffer.h:960</a></div></div>
<div class="ttc" id="astructvvenc_1_1EncAffineMotion_html_a84a2b6bad76fa5b695fcf78c3a0e2b91"><div class="ttname"><a href="structvvenc_1_1EncAffineMotion.html#a84a2b6bad76fa5b695fcf78c3a0e2b91">vvenc::EncAffineMotion::affine6ParaAvail</a></div><div class="ttdeci">bool affine6ParaAvail</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00224">InterSearch.h:224</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1TU_html_a9d70f74b18f30374e529c6cfc3c5ab73"><div class="ttname"><a href="namespacevvenc_1_1TU.html#a9d70f74b18f30374e529c6cfc3c5ab73">vvenc::TU::getCbfAtDepth</a></div><div class="ttdeci">bool getCbfAtDepth(const TransformUnit &amp;tu, const ComponentID compID, const unsigned depth)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03570">UnitTools.cpp:3570</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a053ff437868fc90a5f56a4cc8a715ccb"><div class="ttname"><a href="namespacevvenc.html#a053ff437868fc90a5f56a4cc8a715ccb">vvenc::CSCALE_FP_PREC</a></div><div class="ttdeci">static const int CSCALE_FP_PREC</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00521">CommonDef.h:521</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_a7d54121d05bf25e1dcf3127b87ed43e8"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#a7d54121d05bf25e1dcf3127b87ed43e8">vvenc::Partitioner::splitCurrArea</a></div><div class="ttdeci">void splitCurrArea(const PartSplit split, const CodingStructure &amp;cs)</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8cpp_source.html#l00291">UnitPartitioner.cpp:291</a></div></div>
<div class="ttc" id="astructvvenc_1_1EncAffineMotion_html_adbc53a4a7c528639f9a617b825031205"><div class="ttname"><a href="structvvenc_1_1EncAffineMotion.html#adbc53a4a7c528639f9a617b825031205">vvenc::EncAffineMotion::affine4ParaAvail</a></div><div class="ttdeci">bool affine4ParaAvail</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00223">InterSearch.h:223</a></div></div>
<div class="ttc" id="aCommonDef_8h_html_a8c5ff70b6b28cd0157c50a22406f92c4"><div class="ttname"><a href="CommonDef_8h.html#a8c5ff70b6b28cd0157c50a22406f92c4">SIGN</a></div><div class="ttdeci">#define SIGN(x)</div><div class="ttdoc">TRACE_ENABLE_ITT.</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00853">CommonDef.h:853</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_af4f690b408420e00b346d153a1e92241"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#af4f690b408420e00b346d153a1e92241">vvenc::InterSearch::m_iSearchRange</a></div><div class="ttdeci">int m_iSearchRange</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00367">InterSearch.h:367</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html">vvenc::InterSearch::TZSearchStruct</a></div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00454">InterSearch.h:454</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a9e6b286fba70f2939620587a433bd651"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a9e6b286fba70f2939620587a433bd651">vvenc::InterSearch::m_pTempPel</a></div><div class="ttdeci">Pel * m_pTempPel</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00386">InterSearch.h:386</a></div></div>
<div class="ttc" id="aReshape_8h_html"><div class="ttname"><a href="Reshape_8h.html">Reshape.h</a></div><div class="ttdoc">reshaping header and class (header)</div></div>
<div class="ttc" id="anamespacevvenc_html_af483359f17deab82472b16da461a9a0fa555c470c9fade36f4bc57231923c0517"><div class="ttname"><a href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa555c470c9fade36f4bc57231923c0517">vvenc::MAX_NUM_TBLOCKS</a></div><div class="ttdeci">@ MAX_NUM_TBLOCKS</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00229">TypeDef.h:229</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_af4fc20e5d676250d96c09bcd2ef2a6b0"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#af4fc20e5d676250d96c09bcd2ef2a6b0">vvenc::UnitArea::Y</a></div><div class="ttdeci">CompArea &amp; Y()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00203">Unit.h:203</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af483359f17deab82472b16da461a9a0f"><div class="ttname"><a href="namespacevvenc.html#af483359f17deab82472b16da461a9a0f">vvenc::ComponentID</a></div><div class="ttdeci">ComponentID</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00222">TypeDef.h:222</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af2648f21b6c0719f45e956a186b081ac"><div class="ttname"><a href="namespacevvenc.html#af2648f21b6c0719f45e956a186b081ac">vvenc::s_acMvRefineH</a></div><div class="ttdeci">static const Mv s_acMvRefineH[9]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00072">InterSearch.cpp:72</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a4fbc68d90894a76141760cf4b61c21ba"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a4fbc68d90894a76141760cf4b61c21ba">vvenc::InterSearch::xExtDIFUpSamplingH</a></div><div class="ttdeci">void xExtDIFUpSamplingH(CPelBuf *pcPattern, bool useAltHpelIf)</div><div class="ttdoc">Generate half-sample interpolated block.</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l03089">InterSearch.cpp:3089</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a1c67fbd69415ae8f053fbe313e4a5cda"><div class="ttname"><a href="namespacevvenc.html#a1c67fbd69415ae8f053fbe313e4a5cda">vvenc::floorLog2</a></div><div class="ttdeci">static int floorLog2(uint32_t x)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00725">CommonDef.h:725</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterpolationFilter_html_ae92df0a722bbb5aba3537e9c93da511d"><div class="ttname"><a href="classvvenc_1_1InterpolationFilter.html#ae92df0a722bbb5aba3537e9c93da511d">vvenc::InterpolationFilter::filterHor</a></div><div class="ttdeci">void filterHor(const ClpRng &amp;clpRng, Pel const *src, int srcStride, Pel *dst, int dstStride, int width, int height, bool isLast, TFilterCoeff const *coeff, bool biMCForDMVR)</div><div class="ttdoc">Filter a block of samples (horizontal)</div><div class="ttdef"><b>Definition:</b> <a href="InterpolationFilter_8cpp_source.html#l00506">InterpolationFilter.cpp:506</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ae80bf796e6ed92eba168735a7b4c40fb"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ae80bf796e6ed92eba168735a7b4c40fb">vvenc::InterSearch::xTZSearch</a></div><div class="ttdeci">void xTZSearch(const CodingUnit &amp;cu, RefPicList refPicList, int iRefIdxPred, TZSearchStruct &amp;cStruct, Mv &amp;rcMv, Distortion &amp;ruiSAD, const Mv *const pIntegerMv2Nx2NPred, const bool bExtendedSettings, const bool bFastSettings=false)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02262">InterSearch.cpp:2262</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab468e59029337a4c548edaebf1254ae3a0be33e739219b0a4aeb18a73315f38e4"><div class="ttname"><a href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a0be33e739219b0a4aeb18a73315f38e4">vvenc::IMV_OFF</a></div><div class="ttdeci">@ IMV_OFF</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00516">TypeDef.h:516</a></div></div>
<div class="ttc" id="astructvvenc_1_1CUCtx_html_a6596d42054bcbcb99840f2c76dc68861"><div class="ttname"><a href="structvvenc_1_1CUCtx.html#a6596d42054bcbcb99840f2c76dc68861">vvenc::CUCtx::isDQPCoded</a></div><div class="ttdeci">bool isDQPCoded</div><div class="ttdef"><b>Definition:</b> <a href="ContextModelling_8h_source.html#l00443">ContextModelling.h:443</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a53890dc1d8786e787c63cd6c053979ac"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a53890dc1d8786e787c63cd6c053979ac">vvenc::InterSearch::xTZSearchSelective</a></div><div class="ttdeci">void xTZSearchSelective(const CodingUnit &amp;cu, RefPicList refPicList, int iRefIdxPred, TZSearchStruct &amp;cStruct, Mv &amp;rcMv, Distortion &amp;ruiSAD, const Mv *const pIntegerMv2Nx2NPred)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02592">InterSearch.cpp:2592</a></div></div>
<div class="ttc" id="aTypeDef_8h_html_a1644a589f6466e6ce533230a841fc96a"><div class="ttname"><a href="TypeDef_8h.html#a1644a589f6466e6ce533230a841fc96a">CHROMA_400</a></div><div class="ttdeci">#define CHROMA_400</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00209">TypeDef.h:209</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aa6703e40dff9faf6b5655472e130a512"><div class="ttname"><a href="namespacevvenc.html#aa6703e40dff9faf6b5655472e130a512">vvenc::getComponentScaleY</a></div><div class="ttdeci">static uint32_t getComponentScaleY(const ComponentID id, const ChromaFormat fmt)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00784">CommonDef.h:784</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_af671e643fcbb19af8b0cf8aa94657716"><div class="ttname"><a href="structvvenc_1_1SPS.html#af671e643fcbb19af8b0cf8aa94657716">vvenc::SPS::chromaFormatIdc</a></div><div class="ttdeci">ChromaFormat chromaFormatIdc</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00676">Slice.h:676</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e"><div class="ttname"><a href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8afd17f2d8f948b7b845eb447f54e7205e">vvenc::MV_PRECISION_INTERNAL</a></div><div class="ttdeci">@ MV_PRECISION_INTERNAL</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00071">Mv.h:71</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_adc15ecb13505785bb69c278578c79980"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#adc15ecb13505785bb69c278578c79980">vvenc::InterSearch::m_CtxCache</a></div><div class="ttdeci">CtxCache * m_CtxCache</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00375">InterSearch.h:375</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aaf0e8d4b41cf6b7db38417dc981feb7f"><div class="ttname"><a href="namespacevvenc.html#aaf0e8d4b41cf6b7db38417dc981feb7f">vvenc::MV_FRACTIONAL_BITS_DIFF</a></div><div class="ttdeci">static const int MV_FRACTIONAL_BITS_DIFF</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00334">CommonDef.h:334</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a805805c10672bc0477d70e8bd97646ec"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a805805c10672bc0477d70e8bd97646ec">vvenc::RdCost::getCostOfVectorWithPredictor</a></div><div class="ttdeci">Distortion getCostOfVectorWithPredictor(const int x, const int y, const unsigned imvShift)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00191">RdCost.h:191</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_ae2792dbfd34372253b7997e43f635d51"><div class="ttname"><a href="classvvenc_1_1Mv.html#ae2792dbfd34372253b7997e43f635d51">vvenc::Mv::changeTransPrecInternal2Amvr</a></div><div class="ttdeci">void changeTransPrecInternal2Amvr(const int amvr)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00216">Mv.h:216</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a19a96edeeb9d37072c4ce9f862d19ba8a6b0616d0bcb1e796289f0f100bc9131a"><div class="ttname"><a href="namespacevvenc.html#a19a96edeeb9d37072c4ce9f862d19ba8a6b0616d0bcb1e796289f0f100bc9131a">vvenc::CH_C</a></div><div class="ttdeci">@ CH_C</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00218">TypeDef.h:218</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a02fccf54ebd41fd6bc9712be1d326cba"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a02fccf54ebd41fd6bc9712be1d326cba">vvenc::InterSearch::getEstDistSbt</a></div><div class="ttdeci">Distortion getEstDistSbt(uint8_t sbtMode) const</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00428">InterSearch.h:428</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_ae599e53f303dfb53f417ba15c0b57669"><div class="ttname"><a href="classvvenc_1_1Slice.html#ae599e53f303dfb53f417ba15c0b57669">vvenc::Slice::getRefPic</a></div><div class="ttdeci">const Picture * getRefPic(RefPicList e, int iRefIdx) const</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01278">Slice.h:1278</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a7ef728d3e31f6b319e88d2f023ef92cf"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a7ef728d3e31f6b319e88d2f023ef92cf">vvenc::InterSearch::xTZ2PointSearch</a></div><div class="ttdeci">void xTZ2PointSearch(TZSearchStruct &amp;rcStruct)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00497">InterSearch.cpp:497</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c"><div class="ttname"><a href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8af3a8dee7f255daa5a6805e2cd900374c">vvenc::MV_PRECISION_QUARTER</a></div><div class="ttdeci">@ MV_PRECISION_QUARTER</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00069">Mv.h:69</a></div></div>
<div class="ttc" id="astructvvenc_1_1IbcBvCand_html_aa9b65fb28d86ed6edf7c5f3daf1db538"><div class="ttname"><a href="structvvenc_1_1IbcBvCand.html#aa9b65fb28d86ed6edf7c5f3daf1db538">vvenc::IbcBvCand::currCnt</a></div><div class="ttdeci">int currCnt</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00239">MotionInfo.h:239</a></div></div>
<div class="ttc" id="astructvvenc_1_1EncAffineMotion_html_a226ab6f3b39d18c621dc1d39bf320225"><div class="ttname"><a href="structvvenc_1_1EncAffineMotion.html#a226ab6f3b39d18c621dc1d39bf320225">vvenc::EncAffineMotion::affine6ParaRefIdx</a></div><div class="ttdeci">int16_t affine6ParaRefIdx[2]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00222">InterSearch.h:222</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineAMVPInfo_html_aea75421d319b2a5d705f052e289e77c7"><div class="ttname"><a href="structvvenc_1_1AffineAMVPInfo.html#aea75421d319b2a5d705f052e289e77c7">vvenc::AffineAMVPInfo::mvCandLB</a></div><div class="ttdeci">Mv mvCandLB[AMVP_MAX_NUM_CANDS_MEM]</div><div class="ttdoc">array of affine motion vector predictor candidates for left-bottom corner</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00076">MotionInfo.h:76</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a8c0a668a25b6180c50283588b195fec8"><div class="ttname"><a href="classvvenc_1_1Slice.html#a8c0a668a25b6180c50283588b195fec8">vvenc::Slice::symRefIdx</a></div><div class="ttdeci">int symRefIdx[2]</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01220">Slice.h:1220</a></div></div>
<div class="ttc" id="astructvvenc_1_1Position_html_a9685e0c777668f378eb6fa531933ac6a"><div class="ttname"><a href="structvvenc_1_1Position.html#a9685e0c777668f378eb6fa531933ac6a">vvenc::Position::x</a></div><div class="ttdeci">PosType x</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00063">Common.h:63</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_a83e839c5cb54dcf94ae015bdfd54d81d"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#a83e839c5cb54dcf94ae015bdfd54d81d">vvenc::CABACWriter::pred_mode</a></div><div class="ttdeci">void pred_mode(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l00732">CABACWriter.cpp:732</a></div></div>
<div class="ttc" id="astructvvenc_1_1BlkUniMvInfo_html_a25405e0363e78f4d7b1670ff1710a892"><div class="ttname"><a href="structvvenc_1_1BlkUniMvInfo.html#a25405e0363e78f4d7b1670ff1710a892">vvenc::BlkUniMvInfo::uniMvs</a></div><div class="ttdeci">Mv uniMvs[2][MAX_REF_PICS]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00094">InterSearch.h:94</a></div></div>
<div class="ttc" id="astructvvenc_1_1Area_html"><div class="ttname"><a href="structvvenc_1_1Area.html">vvenc::Area</a></div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00093">Common.h:93</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_a2bc169c2fadbbc0c70db9d4da9e7317c"><div class="ttname"><a href="structvvenc_1_1SPS.html#a2bc169c2fadbbc0c70db9d4da9e7317c">vvenc::SPS::BCW</a></div><div class="ttdeci">bool BCW</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00802">Slice.h:802</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88acdce76d79a2b0b6baf7f5dedd429113c"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88acdce76d79a2b0b6baf7f5dedd429113c">vvenc::SBT_HOR_H0</a></div><div class="ttdeci">@ SBT_HOR_H0</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00297">TypeDef.h:297</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_a1c28c8c7e23b8c3d0d6d90c702a4f597"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#a1c28c8c7e23b8c3d0d6d90c702a4f597">vvenc::AreaBuf::copyFrom</a></div><div class="ttdeci">void copyFrom(const AreaBuf&lt; const T &gt; &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00351">Buffer.h:351</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a88ad68fee052acec3e700138dcf00516"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a88ad68fee052acec3e700138dcf00516">vvenc::InterSearch::m_tmpAffiStorage</a></div><div class="ttdeci">PelStorage m_tmpAffiStorage</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00381">InterSearch.h:381</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodedCUInfo_html"><div class="ttname"><a href="structvvenc_1_1CodedCUInfo.html">vvenc::CodedCUInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8h_source.html#l00255">EncModeCtrl.h:255</a></div></div>
<div class="ttc" id="astructvvenc_1_1ComprCUCtx_html_a30e123e780f79dac12bb4780e98c02ff"><div class="ttname"><a href="structvvenc_1_1ComprCUCtx.html#a30e123e780f79dac12bb4780e98c02ff">vvenc::ComprCUCtx::bestCU</a></div><div class="ttdeci">CodingUnit * bestCU</div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8h_source.html#l00217">EncModeCtrl.h:217</a></div></div>
<div class="ttc" id="astructvvenc_1_1ReuseUniMv_html"><div class="ttname"><a href="structvvenc_1_1ReuseUniMv.html">vvenc::ReuseUniMv</a></div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00333">InterSearch.h:333</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a79ffec64f50a98cf339212235d605a1b"><div class="ttname"><a href="namespacevvenc.html#a79ffec64f50a98cf339212235d605a1b">vvenc::ADAPT_SR_SCALE</a></div><div class="ttdeci">static const int ADAPT_SR_SCALE</div><div class="ttdoc">division factor for adaptive search range</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00208">CommonDef.h:208</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a25a0bd912f0348713119cf2ff215ef07"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a25a0bd912f0348713119cf2ff215ef07">vvenc::InterSearch::m_subPuMiBuf</a></div><div class="ttdeci">MotionInfo m_subPuMiBuf[(MAX_CU_SIZE *MAX_CU_SIZE) &gt;&gt;(MIN_CU_LOG2&lt;&lt; 1)]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00384">InterSearch.h:384</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_aabe23cfd3b80fb6e658934877ae02b30"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#aabe23cfd3b80fb6e658934877ae02b30">vvenc::InterSearch::TZSearchStruct::piRefY</a></div><div class="ttdeci">const Pel * piRefY</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00458">InterSearch.h:458</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a79bbecad33262eecb8522cc540c421ac"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a79bbecad33262eecb8522cc540c421ac">vvenc::InterSearch::xPatternSearchIntRefine</a></div><div class="ttdeci">void xPatternSearchIntRefine(CodingUnit &amp;cu, TZSearchStruct &amp;cStruct, Mv &amp;rcMv, Mv &amp;rcMvPred, int &amp;riMVPIdx, uint32_t &amp;uiBits, Distortion &amp;ruiCost, const AMVPInfo &amp;amvpInfo, double fWeight)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02766">InterSearch.cpp:2766</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af662770c8086fcf63f3f6122c33f2d60"><div class="ttname"><a href="namespacevvenc.html#af662770c8086fcf63f3f6122c33f2d60">vvenc::g_BcwWeightBase</a></div><div class="ttdeci">const int8_t g_BcwWeightBase</div><div class="ttdef"><b>Definition:</b> <a href="Rom_8cpp_source.html#l00590">Rom.cpp:590</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_ad7cb0149f12ab793334572948e1fc237"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#ad7cb0149f12ab793334572948e1fc237">vvenc::InterSearch::TZSearchStruct::iBestY</a></div><div class="ttdeci">int iBestY</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00461">InterSearch.h:461</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a1e827ff1a9f566d6697b680ee5d6b2a3"><div class="ttname"><a href="namespacevvenc.html#a1e827ff1a9f566d6697b680ee5d6b2a3">vvenc::SPLIT_DMULT</a></div><div class="ttdeci">static const SplitSeries SPLIT_DMULT</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00439">CommonDef.h:439</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a2d5859675f1d89520140269c4d1815a9"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a2d5859675f1d89520140269c4d1815a9">vvenc::BcwMotionParam::copyAffineMvTo</a></div><div class="ttdeci">void copyAffineMvTo(Mv acAffineMvs[3], Distortion &amp;ruiDist, uint32_t uiRefList, uint32_t uiRefIdx, int bP4, int &amp;mvpIdx)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00315">MotionInfo.h:315</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_a05daae41965e8cfa9df1a18006da2ec7"><div class="ttname"><a href="structvvenc_1_1SPS.html#a05daae41965e8cfa9df1a18006da2ec7">vvenc::SPS::AffineType</a></div><div class="ttdeci">bool AffineType</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00800">Slice.h:800</a></div></div>
<div class="ttc" id="aclassvvenc_1_1DistParam_html_a2a778981aa07ec37b20d3ca3ca0e4096"><div class="ttname"><a href="classvvenc_1_1DistParam.html#a2a778981aa07ec37b20d3ca3ca0e4096">vvenc::DistParam::cur</a></div><div class="ttdeci">CPelBuf cur</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00082">RdCost.h:82</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_ab683487edb1bfd2c8954ba559741298e"><div class="ttname"><a href="namespacevvenc_1_1CU.html#ab683487edb1bfd2c8954ba559741298e">vvenc::CU::targetSbtAllowed</a></div><div class="ttdeci">uint8_t targetSbtAllowed(uint8_t sbtIdx, uint8_t sbtAllowed)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8h_source.html#l00135">UnitTools.h:135</a></div></div>
<div class="ttc" id="astructvvenc_1_1AMVPInfo_html"><div class="ttname"><a href="structvvenc_1_1AMVPInfo.html">vvenc::AMVPInfo</a></div><div class="ttdoc">parameters for AMVP</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00066">MotionInfo.h:66</a></div></div>
<div class="ttc" id="astructvvenc_1_1Picture_html_a2487e6c4ee0e4106a128c09f68105170"><div class="ttname"><a href="structvvenc_1_1Picture.html#a2487e6c4ee0e4106a128c09f68105170">vvenc::Picture::reshapeData</a></div><div class="ttdeci">ReshapeData reshapeData</div><div class="ttdef"><b>Definition:</b> <a href="Picture_8h_source.html#l00211">Picture.h:211</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineMVInfo_html_a9c93477b825dac70b2339cc10442e6f0"><div class="ttname"><a href="structvvenc_1_1AffineMVInfo.html#a9c93477b825dac70b2339cc10442e6f0">vvenc::AffineMVInfo::affMVs</a></div><div class="ttdeci">Mv affMVs[2][MAX_REF_PICS][3]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00213">InterSearch.h:213</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ac98d000e44202cea8905a1bfc5f57f89"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ac98d000e44202cea8905a1bfc5f57f89">vvenc::InterSearch::m_AffineProfList</a></div><div class="ttdeci">AffineProfList * m_AffineProfList</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00401">InterSearch.h:401</a></div></div>
<div class="ttc" id="astructvvenc_1_1PelStorage_html_a3a80b6032f86a56bec74609034b3246f"><div class="ttname"><a href="structvvenc_1_1PelStorage.html#a3a80b6032f86a56bec74609034b3246f">vvenc::PelStorage::destroy</a></div><div class="ttdeci">void destroy()</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8cpp_source.html#l00973">Buffer.cpp:973</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitScale_html_af11a79fd0eb80cbdc41f3448eeb815cf"><div class="ttname"><a href="structvvenc_1_1UnitScale.html#af11a79fd0eb80cbdc41f3448eeb815cf">vvenc::UnitScale::scale</a></div><div class="ttdeci">Position scale(const Position &amp;pos) const</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00136">Common.h:136</a></div></div>
<div class="ttc" id="astructvvenc_1_1PicHeader_html_a75027878ba07c729f99e49e63d3495d9"><div class="ttname"><a href="structvvenc_1_1PicHeader.html#a75027878ba07c729f99e49e63d3495d9">vvenc::PicHeader::lmcsEnabled</a></div><div class="ttdeci">bool lmcsEnabled</div><div class="ttdoc">lmcs enabled flag</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01072">Slice.h:1072</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a75027878ba07c729f99e49e63d3495d9"><div class="ttname"><a href="classvvenc_1_1Slice.html#a75027878ba07c729f99e49e63d3495d9">vvenc::Slice::lmcsEnabled</a></div><div class="ttdeci">bool lmcsEnabled</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01205">Slice.h:1205</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_aa764a07618a4b6a317c48cc352d99111"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#aa764a07618a4b6a317c48cc352d99111">vvenc::InterPredictionData::regularMergeFlag</a></div><div class="ttdeci">bool regularMergeFlag</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00310">Unit.h:310</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html_a03afb3eb7f04ff2cb52376063d842a94"><div class="ttname"><a href="classvvenc_1_1TrQuant.html#a03afb3eb7f04ff2cb52376063d842a94">vvenc::TrQuant::selectLambda</a></div><div class="ttdeci">void selectLambda(const ComponentID compIdx)</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8h_source.html#l00103">TrQuant.h:103</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a09b3d26422ae3d4e4cb613c071d9b719"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a09b3d26422ae3d4e4cb613c071d9b719">vvenc::InterSearch::TZSearchStruct::inCtuSearch</a></div><div class="ttdeci">bool inCtuSearch</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00469">InterSearch.h:469</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ae73f6f2b632c978d0661ed7c8d50a685"><div class="ttname"><a href="namespacevvenc.html#ae73f6f2b632c978d0661ed7c8d50a685">vvenc::isChromaEnabled</a></div><div class="ttdeci">static bool isChromaEnabled(const ChromaFormat fmt)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00787">CommonDef.h:787</a></div></div>
<div class="ttc" id="aUnitTools_8h_html"><div class="ttname"><a href="UnitTools_8h.html">UnitTools.h</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a74b43514d85787c262e18084a20d61e1"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a74b43514d85787c262e18084a20d61e1">vvenc::InterSearch::xPredAffineInterSearch</a></div><div class="ttdeci">void xPredAffineInterSearch(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, int puIdx, uint32_t &amp;lastMode, Distortion &amp;affineCost, Mv hevcMv[2][MAX_REF_PICS], Mv mvAffine4Para[2][MAX_REF_PICS][3], int refIdx4Para[2], uint8_t BcwIdx=BCW_DEFAULT, bool enforceBcwPred=false, uint32_t BcwIdxBits=0)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04753">InterSearch.cpp:4753</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ae10e385d23d8c4126831cd7bd566bcbc"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ae10e385d23d8c4126831cd7bd566bcbc">vvenc::InterSearch::xCalcMinDistSbt</a></div><div class="ttdeci">void xCalcMinDistSbt(CodingStructure &amp;cs, const CodingUnit &amp;cu, const uint8_t sbtAllowed)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l03443">InterSearch.cpp:3443</a></div></div>
<div class="ttc" id="aTypeDef_8h_html_a70dfa957a71cae40f75782ea972c130e"><div class="ttname"><a href="TypeDef_8h.html#a70dfa957a71cae40f75782ea972c130e">ChromaFormat</a></div><div class="ttdeci">vvencChromaFormat ChromaFormat</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00068">TypeDef.h:68</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aa99f1bbf9afbf8a3b21bb9f306663b45"><div class="ttname"><a href="namespacevvenc.html#aa99f1bbf9afbf8a3b21bb9f306663b45">vvenc::MAX_IDX_ADAPT_SR</a></div><div class="ttdeci">static const uint32_t MAX_IDX_ADAPT_SR</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00075">InterSearch.h:75</a></div></div>
<div class="ttc" id="anamespacevvenc_html_abec647b6cf94dcd6aa9ce4d5fba1ee82"><div class="ttname"><a href="namespacevvenc.html#abec647b6cf94dcd6aa9ce4d5fba1ee82">vvenc::SCALE_BITS</a></div><div class="ttdeci">static constexpr int SCALE_BITS</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00381">CommonDef.h:381</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ad62ea957935587c4a14c133ba59d63ba"><div class="ttname"><a href="namespacevvenc.html#ad62ea957935587c4a14c133ba59d63ba">vvenc::TrMode</a></div><div class="ttdeci">std::pair&lt; int, bool &gt; TrMode</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8h_source.html#l00071">TrQuant.h:71</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_a06a3c4a69b5863a5c06aa2da13dd30f3"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#a06a3c4a69b5863a5c06aa2da13dd30f3">vvenc::CodingUnit::skip</a></div><div class="ttdeci">bool skip</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00353">Unit.h:353</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_a02fd73d861ef2e4aabb38c0c9ff82947"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#a02fd73d861ef2e4aabb38c0c9ff82947">vvenc::InterPredInterpolation::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8cpp_source.html#l00659">InterPrediction.cpp:659</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a10639af982cbc58394e930bae8f96d56"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a10639af982cbc58394e930bae8f96d56">vvenc::CU::getSbtTuSplit</a></div><div class="ttdeci">PartSplit getSbtTuSplit(const uint8_t sbtInfo)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03419">UnitTools.cpp:3419</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_afc3590e71c99e7ca3234f3e27442abc2"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#afc3590e71c99e7ca3234f3e27442abc2">vvenc::Partitioner::canSplit</a></div><div class="ttdeci">void canSplit(const CodingStructure &amp;cs, bool &amp;canNo, bool &amp;canQt, bool &amp;canBh, bool &amp;canBv, bool &amp;canTh, bool &amp;canTv)</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8cpp_source.html#l00411">UnitPartitioner.cpp:411</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html_ade34c28b491ba61af93501c1fd5abcd3"><div class="ttname"><a href="classvvenc_1_1TrQuant.html#ade34c28b491ba61af93501c1fd5abcd3">vvenc::TrQuant::invTransformNxN</a></div><div class="ttdeci">void invTransformNxN(TransformUnit &amp;tu, const ComponentID compID, PelBuf &amp;pResi, const QpParam &amp;cQPs)</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8cpp_source.html#l00263">TrQuant.cpp:263</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitBuf_html_ad90881994b2968bd1c48e4fb16723fd5"><div class="ttname"><a href="structvvenc_1_1UnitBuf.html#ad90881994b2968bd1c48e4fb16723fd5">vvenc::UnitBuf::Cb</a></div><div class="ttdeci">AreaBuf&lt; T &gt; &amp; Cb()</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00681">Buffer.h:681</a></div></div>
<div class="ttc" id="adtrace__next_8h_html_a7589e23a3a40dbdfacd05a1854f135ff"><div class="ttname"><a href="dtrace__next_8h.html#a7589e23a3a40dbdfacd05a1854f135ff">DTRACE_GET_COUNTER</a></div><div class="ttdeci">#define DTRACE_GET_COUNTER(ctx, channel)</div><div class="ttdef"><b>Definition:</b> <a href="dtrace__next_8h_source.html#l00289">dtrace_next.h:289</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineMVInfo_html_aac374e320caaadeca4874add33b62af2"><div class="ttname"><a href="structvvenc_1_1AffineMVInfo.html#aac374e320caaadeca4874add33b62af2">vvenc::AffineMVInfo::w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00214">InterSearch.h:214</a></div></div>
<div class="ttc" id="astructvvenc_1_1MergeCtx_html"><div class="ttname"><a href="structvvenc_1_1MergeCtx.html">vvenc::MergeCtx</a></div><div class="ttdef"><b>Definition:</b> <a href="ContextModelling_8h_source.html#l00453">ContextModelling.h:453</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af18de6ad34637ef1d5e26a867c9a3090afa1fb9ec8d0ac776c8feafb4d5bd404e"><div class="ttname"><a href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090afa1fb9ec8d0ac776c8feafb4d5bd404e">vvenc::SBT_VER_HALF</a></div><div class="ttdeci">@ SBT_VER_HALF</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00278">TypeDef.h:278</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18"><div class="ttname"><a href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a02dd0fe46fdd40822e75f94bcd350e18">vvenc::DF_SSE</a></div><div class="ttdeci">@ DF_SSE</div><div class="ttdoc">general size SSE</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00367">TypeDef.h:367</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a2a4814950acdf4a610adacb0f7417d8d"><div class="ttname"><a href="namespacevvenc.html#a2a4814950acdf4a610adacb0f7417d8d">vvenc::getComponentScaleX</a></div><div class="ttdeci">static uint32_t getComponentScaleX(const ComponentID id, const ChromaFormat fmt)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00783">CommonDef.h:783</a></div></div>
<div class="ttc" id="aCommonDef_8h_html"><div class="ttname"><a href="CommonDef_8h.html">CommonDef.h</a></div><div class="ttdoc">Defines version information, constants and small in-line functions.</div></div>
<div class="ttc" id="aPicture_8h_html"><div class="ttname"><a href="Picture_8h.html">Picture.h</a></div><div class="ttdoc">Description of a coded picture.</div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_ac7920a1ee068639dc3fb665b87aad9de"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#ac7920a1ee068639dc3fb665b87aad9de">vvenc::AreaBuf::subtract</a></div><div class="ttdeci">void subtract(const AreaBuf&lt; const T &gt; &amp;minuend, const AreaBuf&lt; const T &gt; &amp;subtrahend)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00361">Buffer.h:361</a></div></div>
<div class="ttc" id="aEncModeCtrl_8h_html"><div class="ttname"><a href="EncModeCtrl_8h.html">EncModeCtrl.h</a></div><div class="ttdoc">Encoder controller for trying out specific modes.</div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a8666fe6595b172b6d3d8539b6e794339"><div class="ttname"><a href="classvvenc_1_1Mv.html#a8666fe6595b172b6d3d8539b6e794339">vvenc::Mv::divideByPowerOf2</a></div><div class="ttdeci">void divideByPowerOf2(const int i)</div><div class="ttdoc">shift right with rounding</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00138">Mv.h:138</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_a2a0bdf02ccd646d7a674f3bb4fe7fd35"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#a2a0bdf02ccd646d7a674f3bb4fe7fd35">vvenc::InterPredictionData::mv</a></div><div class="ttdeci">Mv mv[NUM_REF_PIC_LIST_01][3]</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00327">Unit.h:327</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_af1517a1da99ed0821dec739003b62921"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#af1517a1da99ed0821dec739003b62921">vvenc::CABACWriter::mts_idx</a></div><div class="ttdeci">void mts_idx(const CodingUnit &amp;cu, CUCtx *cuCtx)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l02356">CABACWriter.cpp:2356</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineMVInfo_html"><div class="ttname"><a href="structvvenc_1_1AffineMVInfo.html">vvenc::AffineMVInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00211">InterSearch.h:211</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50"><div class="ttname"><a href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fa18e244a2f61070c3e5c30ace7e26fd50">vvenc::COMP_Cr</a></div><div class="ttdeci">@ COMP_Cr</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00226">TypeDef.h:226</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a9b174252bf74fcf61c66527b24e23d3e"><div class="ttname"><a href="classvvenc_1_1Mv.html#a9b174252bf74fcf61c66527b24e23d3e">vvenc::Mv::hor</a></div><div class="ttdeci">int hor</div><div class="ttdoc">horizontal component of motion vector</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00086">Mv.h:86</a></div></div>
<div class="ttc" id="aclassvvenc_1_1dynamic__cache_html"><div class="ttname"><a href="classvvenc_1_1dynamic__cache.html">vvenc::dynamic_cache&lt; Ctx &gt;</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a3690ee43ddf352cc2fa9fab4d65d8616"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a3690ee43ddf352cc2fa9fab4d65d8616">vvenc::InterSearch::xEstimateInterResidualQT</a></div><div class="ttdeci">void xEstimateInterResidualQT(CodingStructure &amp;cs, Partitioner &amp;partitioner, Distortion *puiZeroDist=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l03688">InterSearch.cpp:3688</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a8a0b480a254f4194e6bf088d1fa04c1a"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a8a0b480a254f4194e6bf088d1fa04c1a">vvenc::CU::getIbcMVPsEncOnly</a></div><div class="ttdeci">void getIbcMVPsEncOnly(CodingUnit &amp;cu, Mv *mvPred, int &amp;nbPred)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l01501">UnitTools.cpp:1501</a></div></div>
<div class="ttc" id="anamespacevvenc_html_acd213f383247cfa7c43daf6a33d279ea"><div class="ttname"><a href="namespacevvenc.html#acd213f383247cfa7c43daf6a33d279ea">vvenc::MV_MIN</a></div><div class="ttdeci">static constexpr int MV_MIN</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00512">CommonDef.h:512</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5"><div class="ttname"><a href="namespacevvenc.html#a61fd9453b5e83455031424e87f3907aca5194b367edb21b93d1b989a57b4a30e5">vvenc::MTS_SKIP</a></div><div class="ttdeci">@ MTS_SKIP</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00259">TypeDef.h:259</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a2277abb2f66824237e308581168c16b6"><div class="ttname"><a href="namespacevvenc.html#a2277abb2f66824237e308581168c16b6">vvenc::MotionBuf</a></div><div class="ttdeci">AreaBuf&lt; MotionInfo &gt; MotionBuf</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00195">Buffer.h:195</a></div></div>
<div class="ttc" id="aclassvvenc_1_1AffineGradientSearch_html_ae467de2f8e90186206425fa113ea5ab1"><div class="ttname"><a href="classvvenc_1_1AffineGradientSearch.html#ae467de2f8e90186206425fa113ea5ab1">vvenc::AffineGradientSearch::m_EqualCoeffComputer</a></div><div class="ttdeci">void(* m_EqualCoeffComputer)(Pel *pResidue, int residueStride, int **ppDerivate, int derivateBufStride, int64_t(*pEqualCoeff)[7], int width, int height, bool b6Param)</div><div class="ttdef"><b>Definition:</b> <a href="AffineGradientSearch_8h_source.html#l00065">AffineGradientSearch.h:65</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ab129abe12f06cef41d20e46b18c69d70"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ab129abe12f06cef41d20e46b18c69d70">vvenc::InterSearch::m_skipSbtAll</a></div><div class="ttdeci">bool m_skipSbtAll</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00392">InterSearch.h:392</a></div></div>
<div class="ttc" id="astructvvenc_1_1MvField_html_ada8362416d866ab4e32ffd86426bf45f"><div class="ttname"><a href="structvvenc_1_1MvField.html#ada8362416d866ab4e32ffd86426bf45f">vvenc::MvField::refIdx</a></div><div class="ttdeci">int16_t refIdx</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00088">MotionInfo.h:88</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html_a85398aca013c701f21594ab422bec5e7"><div class="ttname"><a href="classvvenc_1_1TrQuant.html#a85398aca013c701f21594ab422bec5e7">vvenc::TrQuant::selectICTCandidates</a></div><div class="ttdeci">std::vector&lt; int &gt; selectICTCandidates(const TransformUnit &amp;tu, CompStorage *resCb, CompStorage *resCr)</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8cpp_source.html#l00309">TrQuant.cpp:309</a></div></div>
<div class="ttc" id="astructvvenc_1_1BlkUniMvInfoBuffer_html_a1d103df528daad4fadc350178509dbd2"><div class="ttname"><a href="structvvenc_1_1BlkUniMvInfoBuffer.html#a1d103df528daad4fadc350178509dbd2">vvenc::BlkUniMvInfoBuffer::getBlkUniMvInfo</a></div><div class="ttdeci">const BlkUniMvInfo * getBlkUniMvInfo(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00105">InterSearch.h:105</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_af96f9b73b3e97111a195da4a3f210558"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#af96f9b73b3e97111a195da4a3f210558">vvenc::InterSearch::xExtDIFUpSamplingQ</a></div><div class="ttdeci">void xExtDIFUpSamplingQ(CPelBuf *pcPatternKey, Mv halfPelRef, int &amp;patternId)</div><div class="ttdoc">Generate quarter-sample interpolated blocks.</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l03147">InterSearch.cpp:3147</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88ac71acd764b4f5140f495e6d1d940fc51"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ac71acd764b4f5140f495e6d1d940fc51">vvenc::SBT_VER_Q0</a></div><div class="ttdeci">@ SBT_VER_Q0</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00299">TypeDef.h:299</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_adff6f41d923245a695197e0b0623a2ab"><div class="ttname"><a href="classvvenc_1_1Mv.html#adff6f41d923245a695197e0b0623a2ab">vvenc::Mv::changeAffinePrecInternal2Amvr</a></div><div class="ttdeci">void changeAffinePrecInternal2Amvr(const int amvr)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00232">Mv.h:232</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a33fcb1c5e4c723ee387b60e35fc8e0f4"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a33fcb1c5e4c723ee387b60e35fc8e0f4">vvenc::RdCost::getCost</a></div><div class="ttdeci">Distortion getCost(uint32_t b) const</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00170">RdCost.h:170</a></div></div>
<div class="ttc" id="astructvvenc_1_1Position_html_a4f5d13e73c7d4e9eae1aa12beac2fda8"><div class="ttname"><a href="structvvenc_1_1Position.html#a4f5d13e73c7d4e9eae1aa12beac2fda8">vvenc::Position::y</a></div><div class="ttdeci">PosType y</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00064">Common.h:64</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a752293b08128c71d8ab60b7073bfe108"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a752293b08128c71d8ab60b7073bfe108">vvenc::InterSearch::TZSearchStruct::ucPointNr</a></div><div class="ttdeci">uint8_t ucPointNr</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00465">InterSearch.h:465</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_ac7eaae99495c02b91aae61ef0201b027"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#ac7eaae99495c02b91aae61ef0201b027">vvenc::CodingUnit::predMode</a></div><div class="ttdeci">PredMode predMode</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00340">Unit.h:340</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ad7990d4385ff356abe84bcbfe3ce4281"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ad7990d4385ff356abe84bcbfe3ce4281">vvenc::InterSearch::m_pcTrQuant</a></div><div class="ttdeci">TrQuant * m_pcTrQuant</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00363">InterSearch.h:363</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_af8ab0abf3c227790756fd3ba52961df4"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#af8ab0abf3c227790756fd3ba52961df4">vvenc::InterSearch::TZSearchStruct::searchRange</a></div><div class="ttdeci">SearchRange searchRange</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00456">InterSearch.h:456</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_af1328a689e0e09c6c3b8fe514bfa2e07"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#af1328a689e0e09c6c3b8fe514bfa2e07">vvenc::InterSearch::getBestSbt</a></div><div class="ttdeci">void getBestSbt(CodingStructure *tempCS, CodingUnit *cu, uint8_t &amp;histBestSbt, Distortion &amp;curPuSse, uint8_t sbtAllowed, bool doPreAnalyzeResi, bool mtsAllowed)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00375">InterSearch.cpp:375</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_a959a14b1ba27b7cc28352007af5eafe7"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#a959a14b1ba27b7cc28352007af5eafe7">vvenc::Partitioner::exitCurrSplit</a></div><div class="ttdeci">void exitCurrSplit()</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8cpp_source.html#l00630">UnitPartitioner.cpp:630</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a38fa18d30e9c51ef390aa273da0f2cc5"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a38fa18d30e9c51ef390aa273da0f2cc5">vvenc::InterSearch::xGetMEDistortionWeight</a></div><div class="ttdeci">double xGetMEDistortionWeight(uint8_t BcwIdx, RefPicList refPicList)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04561">InterSearch.cpp:4561</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1TU_html_a4a1b594da27641480650e8bca1a752eb"><div class="ttname"><a href="namespacevvenc_1_1TU.html#a4a1b594da27641480650e8bca1a752eb">vvenc::TU::getICTMode</a></div><div class="ttdeci">int getICTMode(const TransformUnit &amp;tu, int jointCbCr=-1)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03599">UnitTools.cpp:3599</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a17767316ca808028dc71f1c9c379da44"><div class="ttname"><a href="namespacevvenc.html#a17767316ca808028dc71f1c9c379da44">vvenc::isChroma</a></div><div class="ttdeci">static bool isChroma(const ComponentID id)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00778">CommonDef.h:778</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab2835348084b72a4c2d2f703829adf0b"><div class="ttname"><a href="namespacevvenc.html#ab2835348084b72a4c2d2f703829adf0b">vvenc::AFFINE_ME_LIST_MVP_TH</a></div><div class="ttdeci">static const double AFFINE_ME_LIST_MVP_TH</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00176">CommonDef.h:176</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_a25209148715302298bf0df62aed7f801"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#a25209148715302298bf0df62aed7f801">vvenc::CABACWriter::merge_data</a></div><div class="ttdeci">void merge_data(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l01542">CABACWriter.cpp:1542</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineAMVPInfo_html_ab51b4184ab960a14e50b38c354c0f82b"><div class="ttname"><a href="structvvenc_1_1AffineAMVPInfo.html#ab51b4184ab960a14e50b38c354c0f82b">vvenc::AffineAMVPInfo::mvCandLT</a></div><div class="ttdeci">Mv mvCandLT[AMVP_MAX_NUM_CANDS_MEM]</div><div class="ttdoc">array of affine motion vector predictor candidates for left-top corner</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00074">MotionInfo.h:74</a></div></div>
<div class="ttc" id="astructvvenc_1_1IbcBvCand_html_a972312d0d37b92b2ae3c7e330eae4226"><div class="ttname"><a href="structvvenc_1_1IbcBvCand.html#a972312d0d37b92b2ae3c7e330eae4226">vvenc::IbcBvCand::m_bvCands</a></div><div class="ttdeci">Mv m_bvCands[IBC_NUM_CANDIDATES]</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00238">MotionInfo.h:238</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a5ff00740d73b2c0c0b6672b27205c001"><div class="ttname"><a href="namespacevvenc.html#a5ff00740d73b2c0c0b6672b27205c001">vvenc::Distortion</a></div><div class="ttdeci">uint64_t Distortion</div><div class="ttdoc">distortion measurement</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00203">TypeDef.h:203</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a888d11a292480cce2948f275a6f9d9f0"><div class="ttname"><a href="namespacevvenc.html#a888d11a292480cce2948f275a6f9d9f0">vvenc::AMVP_MAX_NUM_CANDS</a></div><div class="ttdeci">static const int AMVP_MAX_NUM_CANDS</div><div class="ttdoc">AMVP: advanced motion vector prediction - max number of final candidates.</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00201">CommonDef.h:201</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ad063c8e5c76d656b32fb2cf497999008"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ad063c8e5c76d656b32fb2cf497999008">vvenc::InterSearch::m_numBVs</a></div><div class="ttdeci">unsigned int m_numBVs</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00354">InterSearch.h:354</a></div></div>
<div class="ttc" id="astructvvenc_1_1MvField_html"><div class="ttname"><a href="structvvenc_1_1MvField.html">vvenc::MvField</a></div><div class="ttdoc">class for motion vector with reference index</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00085">MotionInfo.h:85</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_a9c8574e5da04a261981db4c362d46ade"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#a9c8574e5da04a261981db4c362d46ade">vvenc::TransformUnit::jointCbCr</a></div><div class="ttdeci">uint8_t jointCbCr</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00412">Unit.h:412</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html">vvenc::CABACWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8h_source.html#l00062">CABACWriter.h:62</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_a209a5181202adb6f81eb753d0cad3ccb"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#a209a5181202adb6f81eb753d0cad3ccb">vvenc::CABACWriter::resetBits</a></div><div class="ttdeci">void resetBits()</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8h_source.html#l00078">CABACWriter.h:78</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a1fd7ee960d76c3b7e2401b8d0e86b90d"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a1fd7ee960d76c3b7e2401b8d0e86b90d">vvenc::InterSearch::m_BlkUniMvInfoBuffer</a></div><div class="ttdeci">BlkUniMvInfoBuffer * m_BlkUniMvInfoBuffer</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00400">InterSearch.h:400</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a067e085429f9049d0c4b411fb8622147"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a067e085429f9049d0c4b411fb8622147">vvenc::InterSearch::m_motionEstimationSearchMethodSCC</a></div><div class="ttdeci">int m_motionEstimationSearchMethodSCC</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00370">InterSearch.h:370</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aa405f6119ac5e6b7a6499dc7ca22b57a"><div class="ttname"><a href="namespacevvenc.html#aa405f6119ac5e6b7a6499dc7ca22b57a">vvenc::SPLIT_MASK</a></div><div class="ttdeci">static const SplitSeries SPLIT_MASK</div><div class="ttdoc">= (1 &lt;&lt; SPLIT_BITS) - 1</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00440">CommonDef.h:440</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aad1274aed379d90a576a2fd338fc2353"><div class="ttname"><a href="namespacevvenc.html#aad1274aed379d90a576a2fd338fc2353">vvenc::MAX_NUM_REF</a></div><div class="ttdeci">static const int MAX_NUM_REF</div><div class="ttdoc">max. number of entries in picture reference list</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00195">CommonDef.h:195</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a20ad2ab1a41da1b47cf2a94655f06ee5"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a20ad2ab1a41da1b47cf2a94655f06ee5">vvenc::InterSearch::predInterSearch</a></div><div class="ttdeci">bool predInterSearch(CodingUnit &amp;cu, Partitioner &amp;partitioner, double &amp;bestCostInter)</div><div class="ttdoc">encoder estimation - inter prediction (non-skip)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01028">InterSearch.cpp:1028</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ae1b62ea8953effa1be0f1bea3865fbbb"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ae1b62ea8953effa1be0f1bea3865fbbb">vvenc::CodingStructure::getRspRecoBuf</a></div><div class="ttdeci">PelBuf getRspRecoBuf(const CompArea &amp;blk)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00288">CodingStructure.h:288</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a00c9c94645c657790e9edb01a94d592b"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a00c9c94645c657790e9edb01a94d592b">vvenc::RdCost::calcRdCost</a></div><div class="ttdeci">double calcRdCost(uint64_t fracBits, Distortion distortion, bool useUnadjustedLambda=true) const</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00156">RdCost.h:156</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_ac4519cfbb088d32c987e5a55a1edede9"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#ac4519cfbb088d32c987e5a55a1edede9">vvenc::CABACWriter::cu_skip_flag</a></div><div class="ttdeci">void cu_skip_flag(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l00692">CABACWriter.cpp:692</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a95d4cdaf8c61540ad5d8a6646df90fe7"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a95d4cdaf8c61540ad5d8a6646df90fe7">vvenc::InterSearch::xPatternSearchFast</a></div><div class="ttdeci">void xPatternSearchFast(const CodingUnit &amp;cu, RefPicList refPicList, int iRefIdxPred, TZSearchStruct &amp;cStruct, Mv &amp;rcMv, Distortion &amp;ruiSAD, const Mv *const pIntegerMv2Nx2NPred)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02209">InterSearch.cpp:2209</a></div></div>
<div class="ttc" id="aclassvvenc_1_1ReshapeData_html_aa5bb3b64b46c55daa973047310d70393"><div class="ttname"><a href="classvvenc_1_1ReshapeData.html#aa5bb3b64b46c55daa973047310d70393">vvenc::ReshapeData::getInvLUT</a></div><div class="ttdeci">const Pel * getInvLUT() const</div><div class="ttdef"><b>Definition:</b> <a href="Reshape_8h_source.html#l00097">Reshape.h:97</a></div></div>
<div class="ttc" id="astructvvenc_1_1PPS_html_a1098ca84e973da53b10489faf6221d6d"><div class="ttname"><a href="structvvenc_1_1PPS.html#a1098ca84e973da53b10489faf6221d6d">vvenc::PPS::getTileIdx</a></div><div class="ttdeci">uint32_t getTileIdx(const Position &amp;pos) const</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00966">Slice.h:966</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_a97b7311221af453c6fa6d051c6f45da0"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#a97b7311221af453c6fa6d051c6f45da0">vvenc::InterPredInterpolation::m_encOnly</a></div><div class="ttdeci">bool m_encOnly</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8h_source.html#l00082">InterPrediction.h:82</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html"><div class="ttname"><a href="classvvenc_1_1RdCost.html">vvenc::RdCost</a></div><div class="ttdoc">RD cost computation class.</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00111">RdCost.h:111</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_ad6facdc45aad9fcfdb48c5500a5c7e59"><div class="ttname"><a href="structvvenc_1_1SPS.html#ad6facdc45aad9fcfdb48c5500a5c7e59">vvenc::SPS::CTUSize</a></div><div class="ttdeci">unsigned CTUSize</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00700">Slice.h:700</a></div></div>
<div class="ttc" id="aclassvvenc_1_1DistParam_html_ae716301fedc5457b5fd5e1c937423cc6"><div class="ttname"><a href="classvvenc_1_1DistParam.html#ae716301fedc5457b5fd5e1c937423cc6">vvenc::DistParam::org</a></div><div class="ttdeci">CPelBuf org</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00081">RdCost.h:81</a></div></div>
<div class="ttc" id="aTypeDef_8h_html_a29d5c9e713ec90b037a5aaa3865ccfa9"><div class="ttname"><a href="TypeDef_8h.html#a29d5c9e713ec90b037a5aaa3865ccfa9">DISTORTION_PRECISION_ADJUSTMENT</a></div><div class="ttdeci">#define DISTORTION_PRECISION_ADJUSTMENT(x)</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00165">TypeDef.h:165</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_a5a0489d44d1a78cf7f669e16016b424c"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#a5a0489d44d1a78cf7f669e16016b424c">vvenc::UnitArea::Cb</a></div><div class="ttdeci">CompArea &amp; Cb()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00205">Unit.h:205</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a86e63267f0b87eb319b151d10ad84e0f"><div class="ttname"><a href="classvvenc_1_1Slice.html#a86e63267f0b87eb319b151d10ad84e0f">vvenc::Slice::picHeader</a></div><div class="ttdeci">PicHeader * picHeader</div><div class="ttdoc">pointer to picture header structure</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01236">Slice.h:1236</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aaf529386910fa2161fa63a3f71657e07"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aaf529386910fa2161fa63a3f71657e07">vvenc::InterSearch::xSymMotionEstimation</a></div><div class="ttdeci">void xSymMotionEstimation(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, Mv &amp;rcMvCurPred, Mv &amp;rcMvTarPred, RefPicList refPicList, MvField &amp;rCurMvField, MvField &amp;rTarMvField, Distortion &amp;ruiCost, int BcwIdx)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l03065">InterSearch.cpp:3065</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_acfac1ad8a7754b33c46766fe254b7b97"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#acfac1ad8a7754b33c46766fe254b7b97">vvenc::InterSearch::m_aaiAdaptSR</a></div><div class="ttdeci">int m_aaiAdaptSR[MAX_NUM_REF_LIST_ADAPT_SR][MAX_IDX_ADAPT_SR]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00371">InterSearch.h:371</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_aee2e01cdc5e162526871ee7c2fc49127"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#aee2e01cdc5e162526871ee7c2fc49127">vvenc::CodingUnit::sbtInfo</a></div><div class="ttdeci">uint8_t sbtInfo</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00362">Unit.h:362</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a3041ffe17dbda47017f7e074f714c544"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a3041ffe17dbda47017f7e074f714c544">vvenc::CU::isIBC</a></div><div class="ttdeci">bool isIBC(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8h_source.html#l00081">UnitTools.h:81</a></div></div>
<div class="ttc" id="astructvvenc_1_1Picture_html_ac2177ac5931e79008f369548ea5aa533"><div class="ttname"><a href="structvvenc_1_1Picture.html#ac2177ac5931e79008f369548ea5aa533">vvenc::Picture::useScTS</a></div><div class="ttdeci">bool useScTS</div><div class="ttdef"><b>Definition:</b> <a href="Picture_8h_source.html#l00250">Picture.h:250</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab83ea82b402e856995ef959d069a10cf"><div class="ttname"><a href="namespacevvenc.html#ab83ea82b402e856995ef959d069a10cf">vvenc::s_acMvRefineQ</a></div><div class="ttdeci">static const Mv s_acMvRefineQ[9]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00085">InterSearch.cpp:85</a></div></div>
<div class="ttc" id="aTimeProfiler_8h_html_a1f8b82dec98edb8bd913a4e0b9e32512"><div class="ttname"><a href="TimeProfiler_8h.html#a1f8b82dec98edb8bd913a4e0b9e32512">PROFILER_SCOPE_AND_STAGE_EXT</a></div><div class="ttdeci">#define PROFILER_SCOPE_AND_STAGE_EXT(cond, p, s, cs, ch)</div><div class="ttdef"><b>Definition:</b> <a href="TimeProfiler_8h_source.html#l00382">TimeProfiler.h:382</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ad546194ff2abcc407c4ad8dbeb88f37b"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ad546194ff2abcc407c4ad8dbeb88f37b">vvenc::InterSearch::xPatternSearch</a></div><div class="ttdeci">void xPatternSearch(TZSearchStruct &amp;cStruct, Mv &amp;rcMv, Distortion &amp;ruiSAD)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02164">InterSearch.cpp:2164</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_a9c5b988d87c66e70baf1da88d231bb88"><div class="ttname"><a href="structvvenc_1_1SPS.html#a9c5b988d87c66e70baf1da88d231bb88">vvenc::SPS::wrapAroundEnabled</a></div><div class="ttdeci">bool wrapAroundEnabled</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00784">Slice.h:784</a></div></div>
<div class="ttc" id="aStatCounter_8h_html_a27264efd631c4f584ddcb2f5888ae6ed"><div class="ttname"><a href="StatCounter_8h.html#a27264efd631c4f584ddcb2f5888ae6ed">THROW</a></div><div class="ttdeci">#define THROW(x)</div><div class="ttdef"><b>Definition:</b> <a href="StatCounter_8h_source.html#l00056">StatCounter.h:56</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_ad9826a082e7a4783645ea9c84357754e"><div class="ttname"><a href="namespacevvenc_1_1CU.html#ad9826a082e7a4783645ea9c84357754e">vvenc::CU::isSbtMode</a></div><div class="ttdeci">bool isSbtMode(const uint8_t sbtInfo)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03401">UnitTools.cpp:3401</a></div></div>
<div class="ttc" id="aInterSearch_8h_html"><div class="ttname"><a href="InterSearch_8h.html">InterSearch.h</a></div><div class="ttdoc">inter search class (header)</div></div>
<div class="ttc" id="aclassvvenc_1_1CacheBlkInfoCtrl_html_ac67df041ac0893256edaedd0ded4ee04"><div class="ttname"><a href="classvvenc_1_1CacheBlkInfoCtrl.html#ac67df041ac0893256edaedd0ded4ee04">vvenc::CacheBlkInfoCtrl::getBlkInfo</a></div><div class="ttdeci">CodedCUInfo &amp; getBlkInfo(const UnitArea &amp;area)</div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8cpp_source.html#l00148">EncModeCtrl.cpp:148</a></div></div>
<div class="ttc" id="astructvvenc_1_1BlkUniMvInfoBuffer_html_abf2802c95763e945c9e6f472995471e6"><div class="ttname"><a href="structvvenc_1_1BlkUniMvInfoBuffer.html#abf2802c95763e945c9e6f472995471e6">vvenc::BlkUniMvInfoBuffer::m_uniMvListMaxSize</a></div><div class="ttdeci">static const int m_uniMvListMaxSize</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00200">InterSearch.h:200</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1SearchRange_html_a2f54f8b71f0d765e2b7dbd9a8b9774ff"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1SearchRange.html#a2f54f8b71f0d765e2b7dbd9a8b9774ff">vvenc::InterSearch::SearchRange::right</a></div><div class="ttdeci">int right</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00449">InterSearch.h:449</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a91007e4c7d30c0ad661ca2222874443b"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a91007e4c7d30c0ad661ca2222874443b">vvenc::InterSearch::storeAffineMotion</a></div><div class="ttdeci">void storeAffineMotion(Mv acAffineMv[2][3], int16_t affineRefIdx[2], EAffineModel affineType, int BcwIdx)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04724">InterSearch.cpp:4724</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a08bb4d946d60ab36df65da2f76b5055d"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a08bb4d946d60ab36df65da2f76b5055d">vvenc::RdCost::getDistPart</a></div><div class="ttdeci">Distortion getDistPart(const CPelBuf &amp;org, const CPelBuf &amp;cur, int bitDepth, const ComponentID compId, DFunc eDFunc, const CPelBuf *orgLuma=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8cpp_source.html#l00264">RdCost.cpp:264</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_adfe7d77511de8d2d474a5dbb86f717b0"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#adfe7d77511de8d2d474a5dbb86f717b0">vvenc::InterSearch::m_tmpPredStorage</a></div><div class="ttdeci">PelStorage m_tmpPredStorage[NUM_REF_PIC_LIST_01]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00348">InterSearch.h:348</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a4e591e79f5c8f5c0145e9088bb273703"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a4e591e79f5c8f5c0145e9088bb273703">vvenc::CodingStructure::tus</a></div><div class="ttdeci">std::vector&lt; TransformUnit * &gt; tus</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00187">CodingStructure.h:187</a></div></div>
<div class="ttc" id="astructvvenc_1_1Picture_html_a235d0e90175a94236f1f3ebac8ec0e35"><div class="ttname"><a href="structvvenc_1_1Picture.html#a235d0e90175a94236f1f3ebac8ec0e35">vvenc::Picture::useScME</a></div><div class="ttdeci">bool useScME</div><div class="ttdef"><b>Definition:</b> <a href="Picture_8h_source.html#l00248">Picture.h:248</a></div></div>
<div class="ttc" id="aclassvvenc_1_1PreCalcValues_html"><div class="ttname"><a href="classvvenc_1_1PreCalcValues.html">vvenc::PreCalcValues</a></div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01556">Slice.h:1556</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html"><div class="ttname"><a href="classvvenc_1_1Mv.html">vvenc::Mv</a></div><div class="ttdoc">basic motion vector class</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00075">Mv.h:75</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a7941a56c2fd607b45125922e737f91ea"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a7941a56c2fd607b45125922e737f91ea">vvenc::InterSearch::m_pcRdCost</a></div><div class="ttdeci">RdCost * m_pcRdCost</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00377">InterSearch.h:377</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_a915dd15479b8b2a6e8bff45b0420e37f"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#a915dd15479b8b2a6e8bff45b0420e37f">vvenc::AreaBuf::buf</a></div><div class="ttdeci">T * buf</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00124">Buffer.h:124</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_aeba81e3c9f0d1188a63486747ec662ee"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#aeba81e3c9f0d1188a63486747ec662ee">vvenc::UnitArea::lheight</a></div><div class="ttdeci">const SizeType lheight() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00246">Unit.h:246</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_a32fa8b93af52b377f7f9224ae04bec8b"><div class="ttname"><a href="structvvenc_1_1SPS.html#a32fa8b93af52b377f7f9224ae04bec8b">vvenc::SPS::jointCbCr</a></div><div class="ttdeci">bool jointCbCr</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00721">Slice.h:721</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_aae23d3ef7f18113b1f9cf7de56045476"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#aae23d3ef7f18113b1f9cf7de56045476">vvenc::CABACWriter::getCtx</a></div><div class="ttdeci">const Ctx &amp; getCtx() const</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8h_source.html#l00074">CABACWriter.h:74</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a2d3ec636d347d8ea142e64ca27ceaad4"><div class="ttname"><a href="classvvenc_1_1Slice.html#a2d3ec636d347d8ea142e64ca27ceaad4">vvenc::Slice::sps</a></div><div class="ttdeci">const SPS * sps</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01233">Slice.h:1233</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a12fee2631c8cd1ff94a6fa2784148857"><div class="ttname"><a href="namespacevvenc.html#a12fee2631c8cd1ff94a6fa2784148857">vvenc::CHROMA_REFINEMENT_CANDIDATES</a></div><div class="ttdeci">static const int CHROMA_REFINEMENT_CANDIDATES</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00500">CommonDef.h:500</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_aaadc98a27a55eb99f1e0ee28029f9b58"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#aaadc98a27a55eb99f1e0ee28029f9b58">vvenc::CABACWriter::cbf_comp</a></div><div class="ttdeci">void cbf_comp(const CodingUnit &amp;cu, bool cbf, const CompArea &amp;area, unsigned depth, const bool prevCbf=false, const bool useISP=false)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l01948">CABACWriter.cpp:1948</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ad7ce89a7490b5e8bf37e94e1487b84ae"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ad7ce89a7490b5e8bf37e94e1487b84ae">vvenc::CodingStructure::getOrgBuf</a></div><div class="ttdeci">PelBuf getOrgBuf(const CompArea &amp;blk)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00280">CodingStructure.h:280</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88a7a32b38087042ef6256e48d430a995a2"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88a7a32b38087042ef6256e48d430a995a2">vvenc::SBT_HOR_Q1</a></div><div class="ttdeci">@ SBT_HOR_Q1</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00302">TypeDef.h:302</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a4db803e8138cb0bba7f2b6d67fd56031"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a4db803e8138cb0bba7f2b6d67fd56031">vvenc::InterSearch::m_acBVs</a></div><div class="ttdeci">Mv m_acBVs[2 *IBC_NUM_CANDIDATES]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00353">InterSearch.h:353</a></div></div>
<div class="ttc" id="astructvvenc_1_1Size_html_ade69005a9b1da536b0ffaee9db5a6916"><div class="ttname"><a href="structvvenc_1_1Size.html#ade69005a9b1da536b0ffaee9db5a6916">vvenc::Size::area</a></div><div class="ttdeci">uint32_t area() const</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00090">Common.h:90</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_a084a131d5a6f75dc5132d3297c35be0a"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#a084a131d5a6f75dc5132d3297c35be0a">vvenc::InterPredInterpolation::m_filteredBlockTmp</a></div><div class="ttdeci">Pel * m_filteredBlockTmp[LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS_SIGNAL][MAX_NUM_COMP]</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8h_source.html#l00086">InterPrediction.h:86</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a19b4deebe4b22090dcf016202d2b4f2f"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a19b4deebe4b22090dcf016202d2b4f2f">vvenc::InterSearch::m_clipMvInSubPic</a></div><div class="ttdeci">bool m_clipMvInSubPic</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00402">InterSearch.h:402</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ad4c6299a6038ffe0d853c33e1dae9ef0"><div class="ttname"><a href="namespacevvenc.html#ad4c6299a6038ffe0d853c33e1dae9ef0">vvenc::MAX_CU_SIZE_IDX</a></div><div class="ttdeci">static const int MAX_CU_SIZE_IDX</div><div class="ttdoc">1+log2(CTUSize)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00366">CommonDef.h:366</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a5e9c1ca891ed69b925ad083b0e92c641"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a5e9c1ca891ed69b925ad083b0e92c641">vvenc::CodingStructure::pcv</a></div><div class="ttdeci">const PreCalcValues * pcv</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00112">CodingStructure.h:112</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_a757617e1ebf8cdcd3b69b08b778bb13f"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#a757617e1ebf8cdcd3b69b08b778bb13f">vvenc::UnitArea::lumaPos</a></div><div class="ttdeci">const Position &amp; lumaPos() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00236">Unit.h:236</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a73942a45402ce654d35f505f148b08fb"><div class="ttname"><a href="namespacevvenc.html#a73942a45402ce654d35f505f148b08fb">vvenc::roundAffineMv</a></div><div class="ttdeci">void roundAffineMv(int &amp;mvx, int &amp;mvy, int nShift)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8cpp_source.html#l00065">Mv.cpp:65</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ad31da9b5f4979160b0e600cd47e42b91a6e6e24d1d7c3c9c0e6ae48644aafbd36"><div class="ttname"><a href="namespacevvenc.html#ad31da9b5f4979160b0e600cd47e42b91a6e6e24d1d7c3c9c0e6ae48644aafbd36">vvenc::TREE_D</a></div><div class="ttdeci">@ TREE_D</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00308">TypeDef.h:308</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0"><div class="ttname"><a href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817af3e11392f7a24ee4a11bdb0885c2ecd0">vvenc::AFFINEMODEL_4PARAM</a></div><div class="ttdeci">@ AFFINEMODEL_4PARAM</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00169">CommonDef.h:169</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a3ea2538f1e59894e5c5069a1e2037a3a"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a3ea2538f1e59894e5c5069a1e2037a3a">vvenc::CodingStructure::getPredBuf</a></div><div class="ttdeci">PelBuf getPredBuf(const CompArea &amp;blk)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00265">CodingStructure.h:265</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineMVInfo_html_a0a2f84ed7838f07779ae24c5a9086d33"><div class="ttname"><a href="structvvenc_1_1AffineMVInfo.html#a0a2f84ed7838f07779ae24c5a9086d33">vvenc::AffineMVInfo::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00214">InterSearch.h:214</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ac19dbe1a542fc0c0bc8a94fcc55907c8ac99f51755fff111dd7d5448a23cdd996"><div class="ttname"><a href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8ac99f51755fff111dd7d5448a23cdd996">vvenc::DF_HAD</a></div><div class="ttdeci">@ DF_HAD</div><div class="ttdoc">general size Hadamard</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00385">TypeDef.h:385</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitBuf_html_a0d5f330a76f9f3b4b896a8589b8acb47"><div class="ttname"><a href="structvvenc_1_1UnitBuf.html#a0d5f330a76f9f3b4b896a8589b8acb47">vvenc::UnitBuf::Cr</a></div><div class="ttdeci">AreaBuf&lt; T &gt; &amp; Cr()</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00683">Buffer.h:683</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a341b90a8f05156fa3fd4012ee38510f9"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a341b90a8f05156fa3fd4012ee38510f9">vvenc::InterSearch::xGetAffineTemplateCost</a></div><div class="ttdeci">Distortion xGetAffineTemplateCost(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, PelUnitBuf &amp;predBuf, Mv acMvCand[3], int iMVPIdx, int iMVPNum, RefPicList refPicList, int iRefIdx)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05376">InterSearch.cpp:5376</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html">vvenc::CodingUnit</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00334">Unit.h:334</a></div></div>
<div class="ttc" id="astructvvenc_1_1CompArea_html"><div class="ttname"><a href="structvvenc_1_1CompArea.html">vvenc::CompArea</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00136">Unit.h:136</a></div></div>
<div class="ttc" id="aEncLib_8h_html"><div class="ttname"><a href="EncLib_8h.html">EncLib.h</a></div><div class="ttdoc">encoder class (header)</div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_aa16665a6565ef65a14f8cdd2a9936d81"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#aa16665a6565ef65a14f8cdd2a9936d81">vvenc::CodingUnit::rootCbf</a></div><div class="ttdeci">bool rootCbf</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00357">Unit.h:357</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af18de6ad34637ef1d5e26a867c9a3090a747352234727cd258515baff1a178831"><div class="ttname"><a href="namespacevvenc.html#af18de6ad34637ef1d5e26a867c9a3090a747352234727cd258515baff1a178831">vvenc::SBT_HOR_QUAD</a></div><div class="ttdeci">@ SBT_HOR_QUAD</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00281">TypeDef.h:281</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a3a80b6032f86a56bec74609034b3246f"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a3a80b6032f86a56bec74609034b3246f">vvenc::InterSearch::destroy</a></div><div class="ttdeci">void destroy()</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00274">InterSearch.cpp:274</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ac25bc8fcbfd5def1fec553cf38c1af4f"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ac25bc8fcbfd5def1fec553cf38c1af4f">vvenc::InterSearch::m_affineModeSelected</a></div><div class="ttdeci">bool m_affineModeSelected</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00396">InterSearch.h:396</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_aab9964fa91dda0ff5c13d2ac3c4d32a8"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#aab9964fa91dda0ff5c13d2ac3c4d32a8">vvenc::InterPredInterpolation::m_isBi</a></div><div class="ttdeci">bool m_isBi</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8h_source.html#l00083">InterPrediction.h:83</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a244513e2313d5c3fc0517cbcb1a030e0"><div class="ttname"><a href="classvvenc_1_1Mv.html#a244513e2313d5c3fc0517cbcb1a030e0">vvenc::Mv::set</a></div><div class="ttdeci">void set(int iHor, int iVer)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00100">Mv.h:100</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineProfList_html_a831eed65684e7d8b7a3cde1b07b64b0a"><div class="ttname"><a href="structvvenc_1_1AffineProfList.html#a831eed65684e7d8b7a3cde1b07b64b0a">vvenc::AffineProfList::m_affMVListIdx</a></div><div class="ttdeci">int m_affMVListIdx</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00328">InterSearch.h:328</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a93cea48eb9dcfd661168dee82e41b384a92f766c130fd9d4eee2981bb182d20cb"><div class="ttname"><a href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384a92f766c130fd9d4eee2981bb182d20cb">vvenc::NUM_REF_PIC_LIST_01</a></div><div class="ttdeci">@ NUM_REF_PIC_LIST_01</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00357">TypeDef.h:357</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_a979d8cb627dcb558d29ff7f0a14de0a1"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#a979d8cb627dcb558d29ff7f0a14de0a1">vvenc::Partitioner::currArea</a></div><div class="ttdeci">const UnitArea &amp; currArea() const</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00155">UnitPartitioner.h:155</a></div></div>
<div class="ttc" id="astructvvenc_1_1SPS_html_aef5e5824f1ca0fb9a6190ae4e24f28cd"><div class="ttname"><a href="structvvenc_1_1SPS.html#aef5e5824f1ca0fb9a6190ae4e24f28cd">vvenc::SPS::Affine</a></div><div class="ttdeci">bool Affine</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00799">Slice.h:799</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a2bbe3d87d2037bae43740148ba4b8f46"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a2bbe3d87d2037bae43740148ba4b8f46">vvenc::InterSearch::xIBCSearchMVChromaRefine</a></div><div class="ttdeci">int xIBCSearchMVChromaRefine(CodingUnit &amp;cu, int iRoiWidth, int iRoiHeight, int cuPelX, int cuPelY, Distortion *uiSadBestCand, Mv *cMVCand)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06048">InterSearch.cpp:6048</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a9088a71f37087d134a4cd8d9418a7395"><div class="ttname"><a href="classvvenc_1_1Slice.html#a9088a71f37087d134a4cd8d9418a7395">vvenc::Slice::disableSATDForRd</a></div><div class="ttdeci">bool disableSATDForRd</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01261">Slice.h:1261</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a9003964e78e9d46fb169c59874f7c4a8"><div class="ttname"><a href="namespacevvenc.html#a9003964e78e9d46fb169c59874f7c4a8">vvenc::getNumberValidComponents</a></div><div class="ttdeci">static uint32_t getNumberValidComponents(const ChromaFormat fmt)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00785">CommonDef.h:785</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a88cd6fcff13e86d529ac63c3d2eca6c0"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a88cd6fcff13e86d529ac63c3d2eca6c0">vvenc::CU::spanMotionInfo</a></div><div class="ttdeci">void spanMotionInfo(CodingUnit &amp;cu, const MergeCtx &amp;mrgCtx=MergeCtx())</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03016">UnitTools.cpp:3016</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_a9bce98bcbe52e5dc317ae807889d19fc"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#a9bce98bcbe52e5dc317ae807889d19fc">vvenc::AreaBuf::rspSignal</a></div><div class="ttdeci">void rspSignal(const Pel *pLUT)</div></div>
<div class="ttc" id="astructvvenc_1_1AffineProfList_html"><div class="ttname"><a href="structvvenc_1_1AffineProfList.html">vvenc::AffineProfList</a></div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00227">InterSearch.h:227</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908"><div class="ttname"><a href="namespacevvenc.html#ad33919387852da909ffb76eb0e777817ae6c396a3192e3b58b3068557d0288908">vvenc::AFFINEMODEL_6PARAM</a></div><div class="ttdeci">@ AFFINEMODEL_6PARAM</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00170">CommonDef.h:170</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_ad3276d58621d10268304a4a6e5ba682d"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#ad3276d58621d10268304a4a6e5ba682d">vvenc::CodingStructure::dist</a></div><div class="ttdeci">Distortion dist</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00164">CodingStructure.h:164</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a177bef416654af38fd196cb0cb96a1c8"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a177bef416654af38fd196cb0cb96a1c8">vvenc::BcwMotionParam::setReadModeAffine</a></div><div class="ttdeci">void setReadModeAffine(bool b, uint32_t uiRefList, uint32_t uiRefIdx, int bP4)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00287">MotionInfo.h:287</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitAreaRelative_html"><div class="ttname"><a href="structvvenc_1_1UnitAreaRelative.html">vvenc::UnitAreaRelative</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00266">Unit.h:266</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_adc4eacf3bc04920048d835c3370b3922"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#adc4eacf3bc04920048d835c3370b3922">vvenc::CodingStructure::addTU</a></div><div class="ttdeci">TransformUnit &amp; addTU(const UnitArea &amp;unit, const ChannelType _chType, CodingUnit *cu, TransformUnit *tuInit=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l00377">CodingStructure.cpp:377</a></div></div>
<div class="ttc" id="astructvvenc_1_1PPS_html_acbabe433162be7f154b9577ad7c5d369"><div class="ttname"><a href="structvvenc_1_1PPS.html#acbabe433162be7f154b9577ad7c5d369">vvenc::PPS::picWidthInLumaSamples</a></div><div class="ttdeci">uint32_t picWidthInLumaSamples</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l00928">Slice.h:928</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a34cc156a46fc92e2bcd1de46ee07cfcd"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a34cc156a46fc92e2bcd1de46ee07cfcd">vvenc::InterSearch::TZSearchStruct::pcPatternKey</a></div><div class="ttdeci">const CPelBuf * pcPatternKey</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00457">InterSearch.h:457</a></div></div>
<div class="ttc" id="aStatCounter_8h_html_a87a0b8601d301b04efad305d35b8ba20"><div class="ttname"><a href="StatCounter_8h.html#a87a0b8601d301b04efad305d35b8ba20">CHECK</a></div><div class="ttdeci">#define CHECK(c, x)</div><div class="ttdef"><b>Definition:</b> <a href="StatCounter_8h_source.html#l00059">StatCounter.h:59</a></div></div>
<div class="ttc" id="aclassvvenc_1_1ReshapeData_html_aecdf8187b53c659fb475fa33cf2b1c99"><div class="ttname"><a href="classvvenc_1_1ReshapeData.html#aecdf8187b53c659fb475fa33cf2b1c99">vvenc::ReshapeData::getCTUFlag</a></div><div class="ttdeci">bool getCTUFlag() const</div><div class="ttdef"><b>Definition:</b> <a href="Reshape_8h_source.html#l00101">Reshape.h:101</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html"><div class="ttname"><a href="classvvenc_1_1Partitioner.html">vvenc::Partitioner</a></div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00122">UnitPartitioner.h:122</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1SearchRange_html_a323a7064fba6e15e3e542e34fb19764e"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1SearchRange.html#a323a7064fba6e15e3e542e34fb19764e">vvenc::InterSearch::SearchRange::bottom</a></div><div class="ttdeci">int bottom</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00451">InterSearch.h:451</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1TU_html_afeb76a93cab1a555ddc0e30677536c35"><div class="ttname"><a href="namespacevvenc_1_1TU.html#afeb76a93cab1a555ddc0e30677536c35">vvenc::TU::setCbfAtDepth</a></div><div class="ttdeci">void setCbfAtDepth(TransformUnit &amp;tu, const ComponentID compID, const unsigned depth, const bool cbf)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03577">UnitTools.cpp:3577</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a44e957b819a43dba1f284e80d49809f4"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a44e957b819a43dba1f284e80d49809f4">vvenc::InterSearch::xAffineMotionEstimation</a></div><div class="ttdeci">void xAffineMotionEstimation(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, RefPicList refPicList, Mv acMvPred[3], int iRefIdxPred, Mv acMv[3], uint32_t &amp;ruiBits, Distortion &amp;ruiCost, int &amp;mvpIdx, const AffineAMVPInfo &amp;aamvpi, bool bBi=false)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05523">InterSearch.cpp:5523</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_a52a92a5775276804b401ed70c7309ea1"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#a52a92a5775276804b401ed70c7309ea1">vvenc::InterPredictionData::mvpIdx</a></div><div class="ttdeci">uint8_t mvpIdx[NUM_REF_PIC_LIST_01]</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00324">Unit.h:324</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_aeec8618a3416457a247ee2308d130f60"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#aeec8618a3416457a247ee2308d130f60">vvenc::InterPredictionData::mvd</a></div><div class="ttdeci">Mv mvd[NUM_REF_PIC_LIST_01][3]</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00326">Unit.h:326</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a923a81a518d0b94fca78be81c59716a6"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a923a81a518d0b94fca78be81c59716a6">vvenc::InterSearch::xSetSearchRange</a></div><div class="ttdeci">void xSetSearchRange(const CodingUnit &amp;cu, const Mv &amp;cMvPred, const int iSrchRng, SearchRange &amp;sr)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l02130">InterSearch.cpp:2130</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a468243d03af504bd2e985e3ab56691daaa4913c5d007af4f59d31efc38ee8fc1c"><div class="ttname"><a href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daaa4913c5d007af4f59d31efc38ee8fc1c">vvenc::CU_TRIH_SPLIT</a></div><div class="ttdeci">@ CU_TRIH_SPLIT</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00077">UnitPartitioner.h:77</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ac19dbe1a542fc0c0bc8a94fcc55907c8a4f3ad87be4ac3fc12e60590dda8bf974"><div class="ttname"><a href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8a4f3ad87be4ac3fc12e60590dda8bf974">vvenc::DF_SAD</a></div><div class="ttdeci">@ DF_SAD</div><div class="ttdoc">general size SAD</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00376">TypeDef.h:376</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_a5d1c1cc9d0693589b31afb4de87c6ffb"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#a5d1c1cc9d0693589b31afb4de87c6ffb">vvenc::CABACWriter::cu_pred_data</a></div><div class="ttdeci">void cu_pred_data(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l00827">CABACWriter.cpp:827</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aa90c4598c609d56310a72938f1d4aa94"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aa90c4598c609d56310a72938f1d4aa94">vvenc::InterSearch::resetSavedAffineMotion</a></div><div class="ttdeci">void resetSavedAffineMotion()</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04706">InterSearch.cpp:4706</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ad5e48395a803d72de5136bce7a37933d"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ad5e48395a803d72de5136bce7a37933d">vvenc::InterSearch::m_pSaveCS</a></div><div class="ttdeci">CodingStructure ** m_pSaveCS</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00350">InterSearch.h:350</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a00ea24186f746c566300adaf3b8668a7"><div class="ttname"><a href="namespacevvenc.html#a00ea24186f746c566300adaf3b8668a7">vvenc::MAX_CU_DEPTH</a></div><div class="ttdeci">static const int MAX_CU_DEPTH</div><div class="ttdoc">log2(CTUSize)</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00365">CommonDef.h:365</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_ad481c55303a4a522d6b2c02544a4fb4b"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#ad481c55303a4a522d6b2c02544a4fb4b">vvenc::InterPredInterpolation::m_filteredBlock</a></div><div class="ttdeci">Pel * m_filteredBlock[LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS_SIGNAL][LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS_SIGNAL][MAX_NUM_COMP]</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8h_source.html#l00085">InterPrediction.h:85</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_adb2189fa0855c297a7c6ac48658f28ff"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#adb2189fa0855c297a7c6ac48658f28ff">vvenc::InterSearch::setSearchRange</a></div><div class="ttdeci">void setSearchRange(const Slice *slice, const VVEncCfg &amp;encCfg)</div><div class="ttdoc">set adaptive search range based on poc difference</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05999">InterSearch.cpp:5999</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CABACWriter_html_ad0d270a4440e9686641a3d6131a6d26a"><div class="ttname"><a href="classvvenc_1_1CABACWriter.html#ad0d270a4440e9686641a3d6131a6d26a">vvenc::CABACWriter::rqt_root_cbf</a></div><div class="ttdeci">void rqt_root_cbf(const CodingUnit &amp;cu)</div><div class="ttdef"><b>Definition:</b> <a href="CABACWriter_8cpp_source.html#l01274">CABACWriter.cpp:1274</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a2691ed25bc1d2b21926bfe74a8dff013"><div class="ttname"><a href="classvvenc_1_1Slice.html#a2691ed25bc1d2b21926bfe74a8dff013">vvenc::Slice::biDirPred</a></div><div class="ttdeci">bool biDirPred</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01218">Slice.h:1218</a></div></div>
<div class="ttc" id="aCommonDef_8h_html_a024715c04558a9981e960134bdf7fc05"><div class="ttname"><a href="CommonDef_8h.html#a024715c04558a9981e960134bdf7fc05">GCC_WARNING_DISABLE_array_bounds</a></div><div class="ttdeci">#define GCC_WARNING_DISABLE_array_bounds</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00096">CommonDef.h:96</a></div></div>
<div class="ttc" id="astructvvenc_1_1Size_html_acec3c14453d8e16034230db557345f1e"><div class="ttname"><a href="structvvenc_1_1Size.html#acec3c14453d8e16034230db557345f1e">vvenc::Size::height</a></div><div class="ttdeci">SizeType height</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00083">Common.h:83</a></div></div>
<div class="ttc" id="astructvvenc_1_1MergeCtx_html_ac8a6d94af3d696e1bf24f6dcf84d5006"><div class="ttname"><a href="structvvenc_1_1MergeCtx.html#ac8a6d94af3d696e1bf24f6dcf84d5006">vvenc::MergeCtx::subPuMvpMiBuf</a></div><div class="ttdeci">MotionBuf subPuMvpMiBuf</div><div class="ttdef"><b>Definition:</b> <a href="ContextModelling_8h_source.html#l00467">ContextModelling.h:467</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88aae67f3784a4fc379f6de1e051d033877"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88aae67f3784a4fc379f6de1e051d033877">vvenc::SBT_VER_H1</a></div><div class="ttdeci">@ SBT_VER_H1</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00296">TypeDef.h:296</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_aa53b89271f07f77f17af4ad8b79f9a4f"><div class="ttname"><a href="classvvenc_1_1Slice.html#aa53b89271f07f77f17af4ad8b79f9a4f">vvenc::Slice::pic</a></div><div class="ttdeci">Picture * pic</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01235">Slice.h:1235</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_a5807aec71a4db132719a28dc3f094714"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#a5807aec71a4db132719a28dc3f094714">vvenc::Partitioner::treeType</a></div><div class="ttdeci">TreeType treeType</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00145">UnitPartitioner.h:145</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a7e66ac110ccf6db80e180f3d79b51788"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a7e66ac110ccf6db80e180f3d79b51788">vvenc::InterSearch::TZSearchStruct::uiBestSad</a></div><div class="ttdeci">Distortion uiBestSad</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00464">InterSearch.h:464</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a15ef77bcb3f5e2bdbb9e5130fb3fc9ea"><div class="ttname"><a href="namespacevvenc.html#a15ef77bcb3f5e2bdbb9e5130fb3fc9ea">vvenc::MAX_REF_PICS</a></div><div class="ttdeci">static const int MAX_REF_PICS</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00345">CommonDef.h:345</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_aef3335e97d85120b669725bab3b7b5f7"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#aef3335e97d85120b669725bab3b7b5f7">vvenc::CodingStructure::picture</a></div><div class="ttdeci">Picture * picture</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00093">CodingStructure.h:93</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_ab2f1d06341e47118fffe7a0b2a9e0464"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#ab2f1d06341e47118fffe7a0b2a9e0464">vvenc::InterPredictionData::mergeFlag</a></div><div class="ttdeci">bool mergeFlag</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00309">Unit.h:309</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a24afc1a31bf13037ec3b4a87cc51b97b"><div class="ttname"><a href="namespacevvenc.html#a24afc1a31bf13037ec3b4a87cc51b97b">vvenc::wrapClipMv</a></div><div class="ttdeci">bool wrapClipMv(Mv &amp;rcMv, const Position &amp;pos, const struct Size &amp;size, const CodingStructure &amp;cs)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8cpp_source.html#l00116">Mv.cpp:116</a></div></div>
<div class="ttc" id="anamespacevvenc_html_abe04d9b7f688253587f839144f4a5465"><div class="ttname"><a href="namespacevvenc.html#abe04d9b7f688253587f839144f4a5465">vvenc::IBC_NUM_CANDIDATES</a></div><div class="ttdeci">static const int IBC_NUM_CANDIDATES</div><div class="ttdoc">Maximum number of candidates to store/test.</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00499">CommonDef.h:499</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html">vvenc::TransformUnit</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00404">Unit.h:404</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af34252cbb46dcf09730e3ab02321ee15"><div class="ttname"><a href="namespacevvenc.html#af34252cbb46dcf09730e3ab02321ee15">vvenc::NTAPS_LUMA</a></div><div class="ttdeci">static const int NTAPS_LUMA</div><div class="ttdoc">Number of taps for luma.</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00461">CommonDef.h:461</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_a7a4c28f2fe75d240c7d78c25d9357a73"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#a7a4c28f2fe75d240c7d78c25d9357a73">vvenc::InterPredictionData::bv</a></div><div class="ttdeci">Mv bv</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00329">Unit.h:329</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a1c8d4c0817299ee000cd3a3679a6d52d"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a1c8d4c0817299ee000cd3a3679a6d52d">vvenc::InterSearch::xEstimateAffineAMVP</a></div><div class="ttdeci">void xEstimateAffineAMVP(CodingUnit &amp;cu, AffineAMVPInfo &amp;affineAMVPInfo, CPelUnitBuf &amp;origBuf, RefPicList refPicList, int iRefIdx, Mv acMvPred[3], Distortion &amp;distBiP)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05914">InterSearch.cpp:5914</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a93cea48eb9dcfd661168dee82e41b384a4750af3c3dcdffb256d98e4ad103e675"><div class="ttname"><a href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384a4750af3c3dcdffb256d98e4ad103e675">vvenc::REF_PIC_LIST_X</a></div><div class="ttdeci">@ REF_PIC_LIST_X</div><div class="ttdoc">special mark</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00358">TypeDef.h:358</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineProfList_html_afb452971293b331a7627fe79642904df"><div class="ttname"><a href="structvvenc_1_1AffineProfList.html#afb452971293b331a7627fe79642904df">vvenc::AffineProfList::m_affMVListMaxSize</a></div><div class="ttdeci">int m_affMVListMaxSize</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00330">InterSearch.h:330</a></div></div>
<div class="ttc" id="astructvvenc_1_1BlkUniMvInfoBuffer_html"><div class="ttname"><a href="structvvenc_1_1BlkUniMvInfoBuffer.html">vvenc::BlkUniMvInfoBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00103">InterSearch.h:103</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_aae3934300792aab8eab2a4a906952424"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#aae3934300792aab8eab2a4a906952424">vvenc::CodingStructure::getTU</a></div><div class="ttdeci">const TransformUnit * getTU(const Position &amp;pos, const ChannelType _chType, const int subTuIdx=-1) const</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l00250">CodingStructure.cpp:250</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab71c686caef0807c59fec6468d277dd8a7592137366a3f94e0b3844698e6c1483"><div class="ttname"><a href="namespacevvenc.html#ab71c686caef0807c59fec6468d277dd8a7592137366a3f94e0b3844698e6c1483">vvenc::MV_PRECISION_SIXTEENTH</a></div><div class="ttdeci">@ MV_PRECISION_SIXTEENTH</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00070">Mv.h:70</a></div></div>
<div class="ttc" id="astructvvenc_1_1Position_html"><div class="ttname"><a href="structvvenc_1_1Position.html">vvenc::Position</a></div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00061">Common.h:61</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a1ed6bffd8a78efbd91dab2d307c6d321"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a1ed6bffd8a78efbd91dab2d307c6d321">vvenc::CodingStructure::bestParent</a></div><div class="ttdeci">CodingStructure * bestParent</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00231">CodingStructure.h:231</a></div></div>
<div class="ttc" id="astructvvenc_1_1AffineProfList_html_a99bcba6d9e68123d5703e06d6d0243c3"><div class="ttname"><a href="structvvenc_1_1AffineProfList.html#a99bcba6d9e68123d5703e06d6d0243c3">vvenc::AffineProfList::insert</a></div><div class="ttdeci">void insert(const AffineMVInfo &amp;cMvTemp, const Area &amp;area)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00295">InterSearch.h:295</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a9a8c5491ffbfe29f4c8c3a59d0741d9d"><div class="ttname"><a href="namespacevvenc.html#a9a8c5491ffbfe29f4c8c3a59d0741d9d">vvenc::NOT_VALID</a></div><div class="ttdeci">static const int NOT_VALID</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00198">CommonDef.h:198</a></div></div>
<div class="ttc" id="astructvvenc_1_1ReuseUniMv_html_adf53437a57fb8cb9a43240ea0781797b"><div class="ttname"><a href="structvvenc_1_1ReuseUniMv.html#adf53437a57fb8cb9a43240ea0781797b">vvenc::ReuseUniMv::ReuseUniMv</a></div><div class="ttdeci">ReuseUniMv()</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00317">InterSearch.cpp:317</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a4ff177faa51dea313e7bd4049db215e6"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a4ff177faa51dea313e7bd4049db215e6">vvenc::InterSearch::xEstimateMvPredAMVP</a></div><div class="ttdeci">void xEstimateMvPredAMVP(CodingUnit &amp;cu, CPelUnitBuf &amp;origBuf, RefPicList refPicList, int iRefIdx, Mv &amp;rcMvPred, AMVPInfo &amp;amvpInfo, Distortion &amp;distBiP)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01795">InterSearch.cpp:1795</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a98e9c7b0b34cfffdc8617b827573abda"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a98e9c7b0b34cfffdc8617b827573abda">vvenc::CodingStructure::fracBits</a></div><div class="ttdeci">uint64_t fracBits</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00163">CodingStructure.h:163</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a38dff9c8fb08768ec4b32b79bfbfb9d1"><div class="ttname"><a href="namespacevvenc.html#a38dff9c8fb08768ec4b32b79bfbfb9d1">vvenc::clipMv</a></div><div class="ttdeci">void clipMv(Mv &amp;rcMv, const Position &amp;pos, const struct Size &amp;size, const PreCalcValues &amp;pcv)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8cpp_source.html#l00072">Mv.cpp:72</a></div></div>
<div class="ttc" id="astructvvenc_1_1Picture_html_adfeeb46910b1ca91b82e20aace08b92a"><div class="ttname"><a href="structvvenc_1_1Picture.html#adfeeb46910b1ca91b82e20aace08b92a">vvenc::Picture::getRecoWrapBuf</a></div><div class="ttdeci">const CPelBuf getRecoWrapBuf(const ComponentID compID) const</div><div class="ttdef"><b>Definition:</b> <a href="Picture_8h_source.html#l00175">Picture.h:175</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_af06878784876e3b0829bb6d446c0a5e1"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#af06878784876e3b0829bb6d446c0a5e1">vvenc::TransformUnit::getCoeffs</a></div><div class="ttdeci">CoeffSigBuf getCoeffs(ComponentID id)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00433">Unit.h:433</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a022764e04d9a5b3e4e90b20a70d05677"><div class="ttname"><a href="classvvenc_1_1Slice.html#a022764e04d9a5b3e4e90b20a70d05677">vvenc::Slice::isIntra</a></div><div class="ttdeci">bool isIntra() const</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01289">Slice.h:1289</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html"><div class="ttname"><a href="classvvenc_1_1Slice.html">vvenc::Slice</a></div><div class="ttdoc">slice header class</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01178">Slice.h:1178</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_aa593922e3fc3bf06037ad9107eac0d70"><div class="ttname"><a href="classvvenc_1_1Mv.html#aa593922e3fc3bf06037ad9107eac0d70">vvenc::Mv::changePrecision</a></div><div class="ttdeci">void changePrecision(const MvPrecision &amp;src, const MvPrecision &amp;dst)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00193">Mv.h:193</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_a36810f08eb1336527c11e152ea1642c8"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#a36810f08eb1336527c11e152ea1642c8">vvenc::InterPredInterpolation::m_skipPROF</a></div><div class="ttdeci">bool m_skipPROF</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8h_source.html#l00081">InterPrediction.h:81</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterpolationFilter_html_a6773e2e8d0e56f400d910b811de87125"><div class="ttname"><a href="classvvenc_1_1InterpolationFilter.html#a6773e2e8d0e56f400d910b811de87125">vvenc::InterpolationFilter::filterVer</a></div><div class="ttdeci">void filterVer(const ClpRng &amp;clpRng, Pel const *src, int srcStride, Pel *dst, int dstStride, int width, int height, bool isFirst, bool isLast, TFilterCoeff const *coeff, bool biMCForDMVR)</div><div class="ttdoc">Filter a block of samples (vertical)</div><div class="ttdef"><b>Definition:</b> <a href="InterpolationFilter_8cpp_source.html#l00542">InterpolationFilter.cpp:542</a></div></div>
<div class="ttc" id="astructvvenc_1_1CodingUnit_html_a88431178eb753a81346e0e4a5796a4e9"><div class="ttname"><a href="structvvenc_1_1CodingUnit.html#a88431178eb753a81346e0e4a5796a4e9">vvenc::CodingUnit::affineType</a></div><div class="ttdeci">uint8_t affineType</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00360">Unit.h:360</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Mv_html_a5e2a7bfb346728cabdb6cb45020f8ae1"><div class="ttname"><a href="classvvenc_1_1Mv.html#a5e2a7bfb346728cabdb6cb45020f8ae1">vvenc::Mv::changeTransPrecAmvr2Internal</a></div><div class="ttdeci">void changeTransPrecAmvr2Internal(const int amvr)</div><div class="ttdef"><b>Definition:</b> <a href="Mv_8h_source.html#l00221">Mv.h:221</a></div></div>
<div class="ttc" id="aclassvvenc_1_1PreCalcValues_html_a00540ef615848135e5a210605f902ecd"><div class="ttname"><a href="classvvenc_1_1PreCalcValues.html#a00540ef615848135e5a210605f902ecd">vvenc::PreCalcValues::wrapArround</a></div><div class="ttdeci">const bool wrapArround</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01601">Slice.h:1601</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a5c92713bb9d8d98f8a99d6a4b1ee56a1"><div class="ttname"><a href="namespacevvenc.html#a5c92713bb9d8d98f8a99d6a4b1ee56a1">vvenc::MRG_FAST_RATIOMYV</a></div><div class="ttdeci">static const double MRG_FAST_RATIOMYV[4]</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00450">CommonDef.h:450</a></div></div>
<div class="ttc" id="astructvvenc_1_1ClpRng_html_ab36d1100473c16852c1b64d1917454a4"><div class="ttname"><a href="structvvenc_1_1ClpRng.html#ab36d1100473c16852c1b64d1917454a4">vvenc::ClpRng::bd</a></div><div class="ttdeci">int bd</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00562">CommonDef.h:562</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ab8269469fbe280b4e8aa6fc83efeb351"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ab8269469fbe280b4e8aa6fc83efeb351">vvenc::InterSearch::m_lumaClpRng</a></div><div class="ttdeci">ClpRng m_lumaClpRng</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00352">InterSearch.h:352</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a96b5e1460105e65e10de81c48c2d7d1f"><div class="ttname"><a href="namespacevvenc.html#a96b5e1460105e65e10de81c48c2d7d1f">vvenc::s_skipQpelPosition</a></div><div class="ttdeci">static const bool s_skipQpelPosition[42][9]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00098">InterSearch.cpp:98</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_abce2e87aaf7e3dd8fb0a930b2f1fb82f"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#abce2e87aaf7e3dd8fb0a930b2f1fb82f">vvenc::CodingStructure::area</a></div><div class="ttdeci">UnitArea area</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00090">CodingStructure.h:90</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a468243d03af504bd2e985e3ab56691daaa486793146c0647069205824697ef8fe"><div class="ttname"><a href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daaa486793146c0647069205824697ef8fe">vvenc::CU_VERT_SPLIT</a></div><div class="ttdeci">@ CU_VERT_SPLIT</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00076">UnitPartitioner.h:76</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a9eee3d53a4576163e3c3bddabab0783f"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a9eee3d53a4576163e3c3bddabab0783f">vvenc::InterSearch::TZSearchStruct::imvShift</a></div><div class="ttdeci">unsigned imvShift</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00467">InterSearch.h:467</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a6cbe682149541a426b984c71fc83baa8"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a6cbe682149541a426b984c71fc83baa8">vvenc::CodingStructure::useSubStructure</a></div><div class="ttdeci">void useSubStructure(CodingStructure &amp;cs, const ChannelType chType, const TreeType treeType, const UnitArea &amp;subArea, const bool cpyReco)</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8cpp_source.html#l00826">CodingStructure.cpp:826</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ae6221582f4c06ae8910bf62fcc456069"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ae6221582f4c06ae8910bf62fcc456069">vvenc::InterSearch::xTZ4PointSquareSearch</a></div><div class="ttdeci">void xTZ4PointSquareSearch(TZSearchStruct &amp;rcStruct, const int iStartX, const int iStartY, const int iDist)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00524">InterSearch.cpp:524</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a2c737d35b7158e64d1aaeafb34537fc6"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a2c737d35b7158e64d1aaeafb34537fc6">vvenc::InterSearch::m_bipredSearchRange</a></div><div class="ttdeci">int m_bipredSearchRange</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00368">InterSearch.h:368</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a87f71d3bf463ad0130672557d0c65ab7"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a87f71d3bf463ad0130672557d0c65ab7">vvenc::InterSearch::xTZSearchHelp</a></div><div class="ttdeci">void xTZSearchHelp(TZSearchStruct &amp;rcStruct, const int iSearchX, const int iSearchY, const uint8_t ucPointNr, const uint32_t uiDistance)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00407">InterSearch.cpp:407</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a8b8fd77e4fe3b07a293937f3384b34f5"><div class="ttname"><a href="namespacevvenc.html#a8b8fd77e4fe3b07a293937f3384b34f5">vvenc::MAX_DISTORTION</a></div><div class="ttdeci">static const Distortion MAX_DISTORTION</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00188">CommonDef.h:188</a></div></div>
<div class="ttc" id="astructvvenc_1_1PicHeader_html_aa53c2d481cc7ff4f02ed006c9ef85c97"><div class="ttname"><a href="structvvenc_1_1PicHeader.html#aa53c2d481cc7ff4f02ed006c9ef85c97">vvenc::PicHeader::mvdL1Zero</a></div><div class="ttdeci">bool mvdL1Zero</div><div class="ttdoc">L1 MVD set to zero flag.</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01052">Slice.h:1052</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a2ef9dd728d58741e83d3a6b51b434ccf"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a2ef9dd728d58741e83d3a6b51b434ccf">vvenc::RdCost::setCostScale</a></div><div class="ttdeci">void setCostScale(int iCostScale)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00169">RdCost.h:169</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a530d6092c6fac441ddd03762efdf5c2f"><div class="ttname"><a href="classvvenc_1_1Slice.html#a530d6092c6fac441ddd03762efdf5c2f">vvenc::Slice::isInterP</a></div><div class="ttdeci">bool isInterP() const</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01291">Slice.h:1291</a></div></div>
<div class="ttc" id="aclassvvenc_1_1EncModeCtrl_html_a7a0af35d0a3150acc360a452afa853f7"><div class="ttname"><a href="classvvenc_1_1EncModeCtrl.html#a7a0af35d0a3150acc360a452afa853f7">vvenc::EncModeCtrl::comprCUCtx</a></div><div class="ttdeci">ComprCUCtx * comprCUCtx</div><div class="ttdef"><b>Definition:</b> <a href="EncModeCtrl_8h_source.html#l00352">EncModeCtrl.h:352</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitArea_html_a9f6af7b1d0e90f070ecbc7bdca1509f9"><div class="ttname"><a href="structvvenc_1_1UnitArea.html#a9f6af7b1d0e90f070ecbc7bdca1509f9">vvenc::UnitArea::repositionTo</a></div><div class="ttdeci">void repositionTo(const UnitArea &amp;unit)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l00205">Unit.cpp:205</a></div></div>
<div class="ttc" id="aclassvvenc_1_1TrQuant_html_a05f1ce6070ab15e4a6a6ee621891926c"><div class="ttname"><a href="classvvenc_1_1TrQuant.html#a05f1ce6070ab15e4a6a6ee621891926c">vvenc::TrQuant::invTransformICT</a></div><div class="ttdeci">void invTransformICT(const TransformUnit &amp;tu, PelBuf &amp;resCb, PelBuf &amp;resCr)</div><div class="ttdef"><b>Definition:</b> <a href="TrQuant_8cpp_source.html#l00303">TrQuant.cpp:303</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_ac5bedb7997fc561b55c47c2f1713bb59"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#ac5bedb7997fc561b55c47c2f1713bb59">vvenc::InterPredInterpolation::xPredInterBlk</a></div><div class="ttdeci">void xPredInterBlk(const ComponentID compID, const CodingUnit &amp;cu, const Picture *refPic, const Mv &amp;_mv, PelUnitBuf &amp;dstPic, const bool bi, const ClpRng &amp;clpRng, const bool bdofApplied, const bool isIBC, const RefPicList refPicList=REF_PIC_LIST_X, const SizeType dmvrWidth=0, const SizeType dmvrHeight=0, const bool bilinearMC=false, const Pel *srcPadBuf=NULL, const int32_t srcPadStride=0)</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8cpp_source.html#l00714">InterPrediction.cpp:714</a></div></div>
<div class="ttc" id="astructvvenc_1_1TransformUnit_html_abb1c789a9f68c865638e592d4ab2ac1e"><div class="ttname"><a href="structvvenc_1_1TransformUnit.html#abb1c789a9f68c865638e592d4ab2ac1e">vvenc::TransformUnit::copyComponentFrom</a></div><div class="ttdeci">void copyComponentFrom(const TransformUnit &amp;other, const ComponentID compID)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l00550">Unit.cpp:550</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_ae35ac6f33d3be71215830b9576669c97"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#ae35ac6f33d3be71215830b9576669c97">vvenc::InterPredInterpolation::m_if</a></div><div class="ttdeci">InterpolationFilter m_if</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8h_source.html#l00084">InterPrediction.h:84</a></div></div>
<div class="ttc" id="astructvvenc_1_1AreaBuf_html_a08f66a6870d87afcd5dc1b60d1019692"><div class="ttname"><a href="structvvenc_1_1AreaBuf.html#a08f66a6870d87afcd5dc1b60d1019692">vvenc::AreaBuf::stride</a></div><div class="ttdeci">int stride</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00125">Buffer.h:125</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69"><div class="ttname"><a href="namespacevvenc.html#a93cea48eb9dcfd661168dee82e41b384adf92ae005acf57da4540bf46ee976d69">vvenc::REF_PIC_LIST_0</a></div><div class="ttdeci">@ REF_PIC_LIST_0</div><div class="ttdoc">reference list 0</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00355">TypeDef.h:355</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_a4803d88dce4e2c5fef3b0fcb1705463a"><div class="ttname"><a href="namespacevvenc_1_1CU.html#a4803d88dce4e2c5fef3b0fcb1705463a">vvenc::CU::fillMvpCand</a></div><div class="ttdeci">void fillMvpCand(CodingUnit &amp;cu, const RefPicList refPicList, const int refIdx, AMVPInfo &amp;amvpInfo)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l01683">UnitTools.cpp:1683</a></div></div>
<div class="ttc" id="aclassvvenc_1_1PreCalcValues_html_accd995becc51735172dd859be536687a"><div class="ttname"><a href="classvvenc_1_1PreCalcValues.html#accd995becc51735172dd859be536687a">vvenc::PreCalcValues::chrFormat</a></div><div class="ttdeci">const ChromaFormat chrFormat</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01584">Slice.h:1584</a></div></div>
<div class="ttc" id="aclassvvenc_1_1RdCost_html_a904c3bb814a77ca8b36717aa757235f7"><div class="ttname"><a href="classvvenc_1_1RdCost.html#a904c3bb814a77ca8b36717aa757235f7">vvenc::RdCost::getMotionCostIBC</a></div><div class="ttdeci">void getMotionCostIBC(int add)</div><div class="ttdef"><b>Definition:</b> <a href="RdCost_8h_source.html#l00203">RdCost.h:203</a></div></div>
<div class="ttc" id="anamespacevvenc_html_aeba68786bfeeda596a9fc2ef5ebe7ce6"><div class="ttname"><a href="namespacevvenc.html#aeba68786bfeeda596a9fc2ef5ebe7ce6">vvenc::TCoeff</a></div><div class="ttdeci">int32_t TCoeff</div><div class="ttdoc">transform coefficient</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00192">TypeDef.h:192</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aa7a315accab25af49c40266933c681de"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aa7a315accab25af49c40266933c681de">vvenc::InterSearch::xCalcAffineMVBits</a></div><div class="ttdeci">uint32_t xCalcAffineMVBits(CodingUnit &amp;cu, Mv mvCand[3], Mv mvPred[3])</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l05977">InterSearch.cpp:5977</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af8c7f729a5e696502a7f5b7839d93d88ad607bcbef136c1907302c67b0250e404"><div class="ttname"><a href="namespacevvenc.html#af8c7f729a5e696502a7f5b7839d93d88ad607bcbef136c1907302c67b0250e404">vvenc::SBT_HOR_H1</a></div><div class="ttdeci">@ SBT_HOR_H1</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00298">TypeDef.h:298</a></div></div>
<div class="ttc" id="anamespacevvenc_html_af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05"><div class="ttname"><a href="namespacevvenc.html#af483359f17deab82472b16da461a9a0fab383c348cb4b541dab0fbc806b081f05">vvenc::COMP_Cb</a></div><div class="ttdeci">@ COMP_Cb</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00225">TypeDef.h:225</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a2e7b38201fa33601f4f205aaa96fce8f"><div class="ttname"><a href="namespacevvenc.html#a2e7b38201fa33601f4f205aaa96fce8f">vvenc::MAX_UINT</a></div><div class="ttdeci">static const uint32_t MAX_UINT</div><div class="ttdoc">max. value of unsigned 32-bit integer</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00182">CommonDef.h:182</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_af347e20a1b178bb2dc4dfc86a139a3fe"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#af347e20a1b178bb2dc4dfc86a139a3fe">vvenc::InterSearch::xTZ8PointDiamondSearch</a></div><div class="ttdeci">void xTZ8PointDiamondSearch(TZSearchStruct &amp;rcStruct, const int iStartX, const int iStartY, const int iDist, const bool bCheckCornersAtDist1)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00612">InterSearch.cpp:612</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a0b1bbd6fc4d26dbf1f9b4b748690afce"><div class="ttname"><a href="namespacevvenc.html#a0b1bbd6fc4d26dbf1f9b4b748690afce">vvenc::s_doInterpQ</a></div><div class="ttdeci">static const bool s_doInterpQ[42][14]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l00145">InterSearch.cpp:145</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a3ede79b23abc164cf6937e8183626a8a"><div class="ttname"><a href="classvvenc_1_1Slice.html#a3ede79b23abc164cf6937e8183626a8a">vvenc::Slice::clpRngs</a></div><div class="ttdeci">ClpRngs clpRngs</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01246">Slice.h:1246</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterPredictionData_html_a8cd694efc45d754fc87915a6c65ef560"><div class="ttname"><a href="structvvenc_1_1InterPredictionData.html#a8cd694efc45d754fc87915a6c65ef560">vvenc::InterPredictionData::refIdx</a></div><div class="ttdeci">int16_t refIdx[NUM_REF_PIC_LIST_01]</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00328">Unit.h:328</a></div></div>
<div class="ttc" id="aCommonDef_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="CommonDef_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="CommonDef_8h_source.html#l00164">CommonDef.h:164</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Slice_html_a2828614629c4cd261f778db8c85fcf58"><div class="ttname"><a href="classvvenc_1_1Slice.html#a2828614629c4cd261f778db8c85fcf58">vvenc::Slice::TLayer</a></div><div class="ttdeci">uint32_t TLayer</div><div class="ttdef"><b>Definition:</b> <a href="Slice_8h_source.html#l01240">Slice.h:1240</a></div></div>
<div class="ttc" id="aclassvvenc_1_1CodingStructure_html_a0dadb78ffff3ac601aa8042a12d06d90"><div class="ttname"><a href="classvvenc_1_1CodingStructure.html#a0dadb78ffff3ac601aa8042a12d06d90">vvenc::CodingStructure::slice</a></div><div class="ttdeci">Slice * slice</div><div class="ttdef"><b>Definition:</b> <a href="CodingStructure_8h_source.html#l00097">CodingStructure.h:97</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_aaf8e6df11c0154fc48152c8cb42ae5d0"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#aaf8e6df11c0154fc48152c8cb42ae5d0">vvenc::InterSearch::m_tmpAffiDeri</a></div><div class="ttdeci">int * m_tmpAffiDeri[2]</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00383">InterSearch.h:383</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1CU_html_ad76564dacc5c55751e4d2f6d96490052"><div class="ttname"><a href="namespacevvenc_1_1CU.html#ad76564dacc5c55751e4d2f6d96490052">vvenc::CU::getSbtMode</a></div><div class="ttdeci">uint8_t getSbtMode(const uint8_t sbtIdx, const uint8_t sbtPos)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8h_source.html#l00132">UnitTools.h:132</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558"><div class="ttname"><a href="namespacevvenc.html#ab468e59029337a4c548edaebf1254ae3a96a9ae9104f19feca264a5985be1c558">vvenc::IMV_HPEL</a></div><div class="ttdeci">@ IMV_HPEL</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00519">TypeDef.h:519</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterPredInterpolation_html_aed661f58d6fe05e1522dfab76c0d27ec"><div class="ttname"><a href="classvvenc_1_1InterPredInterpolation.html#aed661f58d6fe05e1522dfab76c0d27ec">vvenc::InterPredInterpolation::xPredAffineBlk</a></div><div class="ttdeci">void xPredAffineBlk(const ComponentID compID, const CodingUnit &amp;cu, const Picture *refPic, const Mv *_mv, PelUnitBuf &amp;dstPic, const bool bi, const ClpRng &amp;clpRng, const RefPicList refPicList=REF_PIC_LIST_X)</div><div class="ttdef"><b>Definition:</b> <a href="InterPrediction_8cpp_source.html#l01540">InterPrediction.cpp:1540</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a5f82995c567b1a06019ec3069d2f5166"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a5f82995c567b1a06019ec3069d2f5166">vvenc::InterSearch::xReadBufferedUniMv</a></div><div class="ttdeci">bool xReadBufferedUniMv(CodingUnit &amp;cu, RefPicList eRefPicList, int32_t iRefIdx, Mv &amp;pcMvPred, Mv &amp;rcMv, uint32_t &amp;ruiBits, Distortion &amp;ruiCost)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l04573">InterSearch.cpp:4573</a></div></div>
<div class="ttc" id="anamespacevvenc_html_ac19dbe1a542fc0c0bc8a94fcc55907c8"><div class="ttname"><a href="namespacevvenc.html#ac19dbe1a542fc0c0bc8a94fcc55907c8">vvenc::DFunc</a></div><div class="ttdeci">DFunc</div><div class="ttdoc">distortion function index</div><div class="ttdef"><b>Definition:</b> <a href="TypeDef_8h_source.html#l00365">TypeDef.h:365</a></div></div>
<div class="ttc" id="aTimeProfiler_8h_html"><div class="ttname"><a href="TimeProfiler_8h.html">TimeProfiler.h</a></div><div class="ttdoc">profiling of run-time behavior (header)</div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ae1a5f5f359b0f586440af2d441a37544"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ae1a5f5f359b0f586440af2d441a37544">vvenc::InterSearch::xGetMvpIdxBits</a></div><div class="ttdeci">uint32_t xGetMvpIdxBits(int iIdx, int iNum)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l01834">InterSearch.cpp:1834</a></div></div>
<div class="ttc" id="aclassvvenc_1_1Partitioner_html_acfc0e74841898a7fcb4981551881b552"><div class="ttname"><a href="classvvenc_1_1Partitioner.html#acfc0e74841898a7fcb4981551881b552">vvenc::Partitioner::nextPart</a></div><div class="ttdeci">bool nextPart(const CodingStructure &amp;cs, bool autoPop=false)</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8cpp_source.html#l00690">UnitPartitioner.cpp:690</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a205b1a87b71065c7ced869e726f01b20"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a205b1a87b71065c7ced869e726f01b20">vvenc::BcwMotionParam::isReadMode</a></div><div class="ttdeci">bool isReadMode(uint32_t uiRefList, uint32_t uiRefIdx)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00285">MotionInfo.h:285</a></div></div>
<div class="ttc" id="anamespacevvenc_1_1TU_html_aee00d6cb0167549b59828b4df8604a51"><div class="ttname"><a href="namespacevvenc_1_1TU.html#aee00d6cb0167549b59828b4df8604a51">vvenc::TU::isTSAllowed</a></div><div class="ttdeci">bool isTSAllowed(const TransformUnit &amp;tu, const ComponentID compID)</div><div class="ttdef"><b>Definition:</b> <a href="UnitTools_8cpp_source.html#l03585">UnitTools.cpp:3585</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a9560b1449322ce25b114d6f40933c8fc"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a9560b1449322ce25b114d6f40933c8fc">vvenc::InterSearch::m_tmpStorageLCU</a></div><div class="ttdeci">PelStorage m_tmpStorageLCU</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00349">InterSearch.h:349</a></div></div>
<div class="ttc" id="anamespacevvenc_html_a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d"><div class="ttname"><a href="namespacevvenc.html#a468243d03af504bd2e985e3ab56691daace67cf9457923a7d2f148eb60025de3d">vvenc::TU_MAX_TR_SPLIT</a></div><div class="ttdeci">@ TU_MAX_TR_SPLIT</div><div class="ttdef"><b>Definition:</b> <a href="UnitPartitioner_8h_source.html#l00079">UnitPartitioner.h:79</a></div></div>
<div class="ttc" id="aclassvvenc_1_1BcwMotionParam_html_a9444471ff32527e67a99de1c94f8d2e3"><div class="ttname"><a href="classvvenc_1_1BcwMotionParam.html#a9444471ff32527e67a99de1c94f8d2e3">vvenc::BcwMotionParam::copyFrom</a></div><div class="ttdeci">void copyFrom(Mv &amp;rcMv, Distortion uiDist, uint32_t uiRefList, uint32_t uiRefIdx)</div><div class="ttdef"><b>Definition:</b> <a href="MotionInfo_8h_source.html#l00292">MotionInfo.h:292</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_ad110b18cf976a78f734532554e21a187"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#ad110b18cf976a78f734532554e21a187">vvenc::InterSearch::xIBCEstimation</a></div><div class="ttdeci">void xIBCEstimation(CodingUnit &amp;cu, PelUnitBuf &amp;origBuf, Mv *pcMvPred, Mv &amp;rcMv, Distortion &amp;ruiCost)</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8cpp_source.html#l06475">InterSearch.cpp:6475</a></div></div>
<div class="ttc" id="astructvvenc_1_1InterSearch_1_1TZSearchStruct_html_a39ae32101d6a8abc92825f66da4bb39c"><div class="ttname"><a href="structvvenc_1_1InterSearch_1_1TZSearchStruct.html#a39ae32101d6a8abc92825f66da4bb39c">vvenc::InterSearch::TZSearchStruct::iRefStride</a></div><div class="ttdeci">int iRefStride</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00459">InterSearch.h:459</a></div></div>
<div class="ttc" id="aclassvvenc_1_1InterSearch_html_a181840c5939d6651c9613ebb61a10537"><div class="ttname"><a href="classvvenc_1_1InterSearch.html#a181840c5939d6651c9613ebb61a10537">vvenc::InterSearch::m_ReuseUniMv</a></div><div class="ttdeci">ReuseUniMv * m_ReuseUniMv</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00399">InterSearch.h:399</a></div></div>
<div class="ttc" id="aTimeProfiler_8h_html_a48e5ee72e953901b1aeca5200b1f751c"><div class="ttname"><a href="TimeProfiler_8h.html#a48e5ee72e953901b1aeca5200b1f751c">PROFILER_SCOPE_AND_STAGE</a></div><div class="ttdeci">#define PROFILER_SCOPE_AND_STAGE(cond, p, s)</div><div class="ttdef"><b>Definition:</b> <a href="TimeProfiler_8h_source.html#l00381">TimeProfiler.h:381</a></div></div>
<div class="ttc" id="astructvvenc_1_1UnitBuf_html_ae234f3d4d1911a5f0e1b61a5425c320f"><div class="ttname"><a href="structvvenc_1_1UnitBuf.html#ae234f3d4d1911a5f0e1b61a5425c320f">vvenc::UnitBuf::copyFrom</a></div><div class="ttdeci">void copyFrom(const UnitBuf&lt; const T &gt; &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="Buffer_8h_source.html#l00723">Buffer.h:723</a></div></div>
<div class="ttc" id="astructvvenc_1_1BlkUniMvInfoBuffer_html_af3247e7f9b36535efa5752aa104ecc34"><div class="ttname"><a href="structvvenc_1_1BlkUniMvInfoBuffer.html#af3247e7f9b36535efa5752aa104ecc34">vvenc::BlkUniMvInfoBuffer::m_uniMvListSize</a></div><div class="ttdeci">int m_uniMvListSize</div><div class="ttdef"><b>Definition:</b> <a href="InterSearch_8h_source.html#l00203">InterSearch.h:203</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4223c4eee3e7b8a74f7422eb38e0223b.html">vvenc-master</a></li><li class="navelem"><a class="el" href="dir_6750f24480d6fa6988579993faed03f3.html">source</a></li><li class="navelem"><a class="el" href="dir_ae070c9c060a0e4c2f318a822c00f9ca.html">Lib</a></li><li class="navelem"><a class="el" href="dir_923a0f095131df36efa8cc007e0eb205.html">EncoderLib</a></li><li class="navelem"><a class="el" href="InterSearch_8cpp.html">InterSearch.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
